(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92163,       2326]
NotebookOptionsPosition[     88858,       2281]
NotebookOutlinePosition[     89299,       2298]
CellTagsIndexPosition[     89256,       2295]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.858229176389264*^9, 3.858229446693867*^9, 3.8602953602247972`*^9, 
   3.860302009654538*^9, {3.860485791732256*^9, 3.860485794873648*^9}, {
   3.860485932054061*^9, 3.860485933925563*^9}, {3.875666590817411*^9, 
   3.8756665934403267`*^9}, {3.8756666396111803`*^9, 3.875666670228642*^9}, {
   3.87568396954793*^9, 3.875683973023356*^9}, {3.8813860258068233`*^9, 
   3.881386036758132*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"evaluate", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "qsp", ",", " ", "qsa", ",", " ", "qsb", ",", " ", "qsc", ",", " ", 
       "qS", ",", "qr", ",", " ", "qSA", ",", " ", "qSB", ",", " ", "qSC", 
       ",", " ", "qSW", ",", " ", "qR", ",", " ", "qjJ", ",", "qangleA", ",", 
       " ", "qangleB", ",", " ", "qangleC", ",", "qangleW", ",", "qTT", ",", 
       "qJJ"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "sp", ",", " ", "sa", ",", " ", "sb", ",", " ", "sc", ",", " ", "S", 
        ",", "r", ",", " ", "SA", ",", " ", "SB", ",", " ", "SC", ",", " ", 
        "SW", ",", " ", "R", ",", " ", "jJ", ",", "angleA", ",", " ", 
        "angleB", ",", " ", "angleC", ",", "angleW", ",", "\[Omega]", ",", 
        "e", ",", "\[Tau]", ",", "jJ", ",", "J", ",", "dD", ",", 
        "\[CapitalDelta]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"qsp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qsa", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "c", "-", "a"}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qsb", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "-", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"qsc", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "-", "c"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qS", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"qsp", " ", "qsa", " ", "qsb", " ", "qsc"}], "]"}]}]}], ";", 
      RowBox[{"qr", "=", 
       RowBox[{"S", "/", 
        RowBox[{"(", 
         RowBox[{"2", "qsp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qSA", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"], "-", 
          SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qSB", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "-", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"qSC", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "-", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qSW", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qR", " ", "=", " ", 
       RowBox[{"a", " ", "b", " ", 
        RowBox[{"c", "/", 
         RowBox[{"(", 
          RowBox[{"2", "qS"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qangleA", "=", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSA", 
         RowBox[{"b", " ", "c"}]], "]"}]}], ";", 
      RowBox[{"qangleB", " ", "=", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSB", 
         RowBox[{"a", " ", "c"}]], "]"}]}], ";", 
      RowBox[{"qangleC", " ", "=", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSC", 
         RowBox[{"a", " ", "b"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qangleW", " ", "=", 
       RowBox[{"ArcCot", "[", 
        RowBox[{
         RowBox[{"Cot", "[", "qangleA", "]"}], "+", 
         RowBox[{"Cot", "[", "qangleB", "]"}], "+", 
         RowBox[{"Cot", "[", "qangleC", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"e", " ", "=", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", "\[Omega]"}], "]"}]}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"qjJ", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"a", " ", "b", " ", "c"}]], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "6"], "+", 
          SuperscriptBox["b", "6"], "+", 
          SuperscriptBox["c", "6"], "-", 
          RowBox[{
           SuperscriptBox["a", "4"], 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox["b", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "4"], 
           SuperscriptBox["c", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox["c", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["c", "4"], 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["c", "2"], 
           SuperscriptBox["b", "4"]}], "+", 
          RowBox[{"3", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["b", "2"], 
           SuperscriptBox["c", "2"]}]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qTT", "=", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["a", "4"], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["b", "2"]}], "+", 
         SuperscriptBox["b", "4"], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["c", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"]}], "+", 
         SuperscriptBox["c", "4"]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qJJ", "=", 
       RowBox[{"\[Sqrt]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["a", "8"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "6"], " ", 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["b", "4"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "6"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "8"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "6"], " ", 
           SuperscriptBox["c", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["c", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["c", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "6"], " ", 
           SuperscriptBox["c", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "4"], " ", 
           SuperscriptBox["c", "4"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["c", "4"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["b", "4"], " ", 
           SuperscriptBox["c", "4"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["c", "6"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["c", "6"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["c", "8"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["c", "2"], " ", 
           SuperscriptBox["J", "2"], 
           SqrtBox[
            RowBox[{
             SuperscriptBox["a", "4"], "-", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox["b", "4"], "-", 
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              SuperscriptBox["c", "2"]}], "-", 
             RowBox[{
              SuperscriptBox["b", "2"], " ", 
              SuperscriptBox["c", "2"]}], "+", 
             SuperscriptBox["c", "4"]}]]}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qOH", " ", "=", " ", 
       SqrtBox[
        FractionBox[
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "6"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "4"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["b", "2"], "-", 
              SuperscriptBox["c", "2"]}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "4"], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["b", "2"], " ", 
              SuperscriptBox["c", "2"]}], "+", 
             SuperscriptBox["c", "4"]}], ")"}]}]}], 
         RowBox[{
          SuperscriptBox["a", "4"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "+", 
             SuperscriptBox["c", "2"]}], ")"}]}]}]]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"expr", "\[IndentingNewLine]", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sp", "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ",", " ", 
          RowBox[{"sa", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"b", "+", "c", "-", "a"}], ")"}], "/", "2"}]}], ",", " ", 
          RowBox[{"sb", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "-", "b", "+", "c"}], ")"}], "/", "2"}]}], ",", 
          RowBox[{"sc", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "-", "c"}], ")"}], "/", "2"}]}], ",", 
          RowBox[{"s", "->", "qsp"}], ",", "\[IndentingNewLine]", 
          RowBox[{"S", "->", "qS"}], ",", 
          RowBox[{"r", "->", 
           RowBox[{"qS", "/", 
            RowBox[{"(", 
             RowBox[{"2", "qsp"}], ")"}]}]}], ",", 
          RowBox[{"\[CapitalDelta]", "->", 
           RowBox[{"qS", "/", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"SA", " ", "->", " ", "qSA"}], ",", " ", 
          RowBox[{"SB", " ", "->", " ", "qSB"}], ",", 
          RowBox[{"SC", " ", "->", " ", "qSC"}], ",", " ", 
          RowBox[{"SW", "->", "qSW"}], ",", "\[IndentingNewLine]", 
          RowBox[{"R", " ", "->", " ", "qR"}], ",", "\[IndentingNewLine]", 
          RowBox[{"angleA", "->", " ", "qangleA"}], ",", 
          RowBox[{"angleB", " ", "->", " ", "qangleB"}], ",", 
          RowBox[{"angleC", " ", "->", " ", "qangleC"}], ",", 
          RowBox[{"angleW", " ", "->", "qangleW"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "->", " ", "qangleA"}], ",", 
          RowBox[{"B", " ", "->", " ", "qangleB"}], ",", 
          RowBox[{"C", " ", "->", " ", "qangleC"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", " ", "->", " ", "qangleW"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "->", 
           SqrtBox[
            FractionBox[
             RowBox[{" ", 
              RowBox[{
               SuperscriptBox["a", "4"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["b", "2"]}], "+", 
               SuperscriptBox["b", "4"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["c", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["c", "2"]}], "+", 
               SuperscriptBox["c", "4"]}]}], 
             RowBox[{" ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["b", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["c", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["c", "2"]}]}]}]]]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Tau]", "->", 
           SqrtBox[
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               SqrtBox["5"]}], ")"}]}]]}], ",", "\[IndentingNewLine]", 
          RowBox[{"dD", "->", 
           RowBox[{"4", "*", "qS", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"qR", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", "*", "qR"}], "+", "qr"}], ")"}]}], "]"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"OH", "->", "qOH"}], ",", "\[IndentingNewLine]", 
          RowBox[{"jJ", "->", "qjJ"}], ",", "\[IndentingNewLine]", 
          RowBox[{"J", "->", "qjJ"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"6e78eba6-01f6-40c6-b3e8-5afba25a3220"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"symmetrizeEq", "[", "eq_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"partB", ",", " ", "partC"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Cyclic", " ", "sum", " ", "for", " ", "bernard"}], "-", 
        RowBox[{"gibert", ".", "pagesperso"}], "-", 
        RowBox[{"orange", ".", "fr"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"partB", " ", "=", " ", 
        RowBox[{"eq", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", " ", 
           RowBox[{"b", "->", "c"}], ",", " ", 
           RowBox[{"c", "->", "a"}], ",", " ", 
           RowBox[{"x", "->", "y"}], ",", " ", 
           RowBox[{"y", "->", "z"}], ",", " ", 
           RowBox[{"z", "->", "x"}], ",", " ", 
           RowBox[{"pp", "->", "qq"}], ",", " ", 
           RowBox[{"qq", "->", "rr"}], ",", " ", 
           RowBox[{"rr", "->", "pp"}], ",", 
           RowBox[{"A", "->", "B"}], ",", 
           RowBox[{"B", "->", "C"}], ",", 
           RowBox[{"C", "->", "A"}], ",", 
           RowBox[{"SA", "->", "SB"}], ",", 
           RowBox[{"SB", "->", "SC"}], ",", 
           RowBox[{"SC", "->", "SA"}], ",", 
           RowBox[{"p", "->", "q"}], ",", 
           RowBox[{"q", "->", "r"}], ",", 
           RowBox[{"r", "->", "p"}], ",", 
           RowBox[{"u", "->", "v"}], ",", 
           RowBox[{"v", "->", "w"}], ",", 
           RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC", " ", "=", " ", 
        RowBox[{"partB", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", " ", 
           RowBox[{"b", "->", "c"}], ",", " ", 
           RowBox[{"c", "->", "a"}], ",", " ", 
           RowBox[{"x", "->", "y"}], ",", " ", 
           RowBox[{"y", "->", "z"}], ",", " ", 
           RowBox[{"z", "->", "x"}], ",", " ", 
           RowBox[{"pp", "->", "qq"}], ",", " ", 
           RowBox[{"qq", "->", "rr"}], ",", " ", 
           RowBox[{"rr", "->", "pp"}], ",", 
           RowBox[{"A", "->", "B"}], ",", 
           RowBox[{"B", "->", "C"}], ",", 
           RowBox[{"C", "->", "A"}], ",", 
           RowBox[{"SA", "->", "SB"}], ",", 
           RowBox[{"SB", "->", "SC"}], ",", 
           RowBox[{"SC", "->", "SA"}], ",", 
           RowBox[{"p", "->", "q"}], ",", 
           RowBox[{"q", "->", "r"}], ",", 
           RowBox[{"r", "->", "p"}], ",", 
           RowBox[{"u", "->", "v"}], ",", 
           RowBox[{"v", "->", "w"}], ",", 
           RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"eq", "+", "partB", "+", "partC"}], ")"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conwaySimplify", "[", "poly_", "]"}], ":=", 
    RowBox[{"PolynomialReduce", "[", 
     RowBox[{"poly", ",", 
      RowBox[{"evaluate", "[", 
       RowBox[{"{", 
        RowBox[{
        "SW", ",", "SA", ",", "SB", ",", "SC", ",", "sp", ",", "sa", ",", 
         "sb", ",", "sc"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intSimplifyFactors", "[", "expr_", "]"}], ":=", 
    RowBox[{"Times", "@@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]], "&"}], ",", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Simplify", "[", "#", "]"}], "&"}], ",", 
         RowBox[{"FactorList", "[", "expr", "]"}]}], "]"}]}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intSimplifyFactorsToTrad", "[", "expr_", "]"}], ":=", 
    RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpressionToTrad", "[", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ex", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Simplify", "[", "#", "]"}], "&"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"FactorList", "[", "expr", "]"}], ",", 
                 RowBox[{
                  RowBox[{"Not", "[", 
                   RowBox[{"SameQ", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
                   "]"}], "&"}]}], "]"}]}], "]"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "ex", "]"}], ">", "1"}], ",", 
           RowBox[{"NonCommutativeMultiply", "@@", "ex"}], ",", 
           RowBox[{"ex", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
        "]"}], "]"}], ",", 
      RowBox[{"\"\<**\>\"", "->", "\"\<*\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intFullSimplifyFactors", "[", "expr_", "]"}], ":=", 
  RowBox[{"Times", "@@", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
      "&"}], ")"}], "/@", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FullSimplify", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"S", ">", "0"}]}], "]"}], "&"}], ")"}], "/@", 
     RowBox[{"FactorList", "[", "expr", "]"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"simplifyRationalBarycentrics", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "out", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{
        RowBox[{"expr", "*", 
         RowBox[{"(", 
          RowBox[{"PolynomialLCM", "@@", 
           RowBox[{"Denominator", "[", "expr", "]"}]}], ")"}]}], "//", 
        "Factor"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"intSimplifyFactors", "/@", 
       RowBox[{"(", 
        RowBox[{"out", "/", 
         RowBox[{"(", 
          RowBox[{"PolynomialGCD", "@@", "out"}], ")"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"4c3e296e-741c-4616-a2af-bb5ca6c06ef1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ggBaryToCartesian", "[", "p_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"bToCartesian", "[", 
      RowBox[{"p", ",", 
       RowBox[{"{", 
        RowBox[{"ax", ",", "ay"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"bx", ",", "by"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"cx", ",", "cy"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ax", "->", "\"\<x(A)\>\""}], ",", 
      RowBox[{"bx", "->", "\"\<x(B)\>\""}], ",", 
      RowBox[{"cx", "->", "\"\<x(C)\>\""}], ",", 
      RowBox[{"ay", "->", "\"\<y(A)\>\""}], ",", 
      RowBox[{"by", "->", "\"\<y(B)\>\""}], ",", 
      RowBox[{"cy", "->", "\"\<y(C)\>\""}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8838114185529556`*^9, 3.8838115249713373`*^9}, {
  3.8838116005050583`*^9, 3.8838116029867535`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"2b5aa4ea-3c5f-4323-a08d-3c7ed8e84a6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ggCurve", "[", "expr_", "]"}], ":=", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<TriangleCurve(A,B,C,\>\"", "<>", 
     RowBox[{"ExpressionToTrad", "[", 
      RowBox[{"multiCollect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
            RowBox[{"{", 
             RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}]}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
           RowBox[{"{", 
            RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "B", ",", "C"}], "}"}]}], "]"}], "]"}], "<>", 
     "\"\<=0)\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883814346764166*^9, 3.8838143518964615`*^9}, {
  3.884231702944851*^9, 3.8842317075813136`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"39b90364-1581-4eab-b764-27b8c81cbdfb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"homogeneousPart", "[", 
    RowBox[{"poly_", ",", "vars_", ",", "deg_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "intt", "}"}], ",", 
     RowBox[{
      RowBox[{"SeriesCoefficient", "[", 
       RowBox[{
        RowBox[{"poly", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"vars", "->", 
           RowBox[{"intt", "*", "vars"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"intt", ",", "0", ",", "deg"}], "}"}]}], "]"}], "/.", 
      RowBox[{"intt", "->", "1"}]}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"a63c6561-dfc3-4921-b8cc-f4e6a4d72f42"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"polynomialDegree", "[", "poly_", "]"}], ":=", 
   RowBox[{"Max", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"CoefficientRules", "[", "poly", "]"}], ",", 
      RowBox[{
       RowBox[{"v_", "?", "VectorQ"}], ":>", 
       RowBox[{"Total", "[", "v", "]"}]}], ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"countSummands", "[", "expr_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", 
       RowBox[{"Expand", "@", "expr"}], "]"}], "===", "Plus"}], ",", 
     RowBox[{"Length", "[", 
      RowBox[{"Expand", "@", "expr"}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"expr", "===", "0"}], ",", "0", ",", "1"}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8886619613308744`*^9, 3.8886619931526127`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"e59a367d-3e5a-486a-820c-00c49b5a6261"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"heuristicsCheck", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"degree_", ":", "16"}], ",", 
     RowBox[{"ratio_", ":", "5"}], ",", " ", 
     RowBox[{"cfsum_", ":", "200"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"deg", ",", "smt", ",", "coefsum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"PolynomialQ", "[", 
           RowBox[{"expr", ",", "a"}], "]"}], "]"}], "||", 
         RowBox[{"Not", "[", 
          RowBox[{"PolynomialQ", "[", 
           RowBox[{"expr", ",", "b"}], "]"}], "]"}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"deg", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"Plus", "@@@", 
           RowBox[{
            RowBox[{"CoefficientRules", "[", "#", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
        "expr"}]}], ";", 
      RowBox[{"smt", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"countSummands", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
           RowBox[{"FactorList", "[", "expr", "]"}]}], ",", 
          RowBox[{
           RowBox[{"#", ">", "3"}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"coefsum", "=", 
         RowBox[{"Total", "[", 
          RowBox[{"Total", "/@", 
           RowBox[{"Total", "/@", 
            RowBox[{"Abs", "[", 
             RowBox[{"CoefficientList", "[", 
              RowBox[{"expr", ",", 
               RowBox[{"{", 
                RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}]}]}], 
          "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coefsum", "=", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CoefficientList", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c", ",", "S"}], "}"}]}], "]"}], 
            "&"}], "/@", 
           RowBox[{"FactorList", "[", "expr", "]"}]}], "]"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"deg", "<=", "4"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"deg", "<=", "degree"}], "&&", 
          RowBox[{
           RowBox[{"smt", "/", "deg"}], "<", "ratio"}], "&&", 
          RowBox[{"coefsum", "<", "cfsum"}]}], ")"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"dee31942-40a2-4b46-adba-cb5a15d8592c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"massHeuristics1", "[", 
    RowBox[{"expr_", ",", "nmin_", ",", "nmax_", ",", 
     RowBox[{"deg_", ":", "16"}], ",", " ", 
     RowBox[{"ratio_", ":", "4.5"}], ",", " ", 
     RowBox[{"cfsum_", ":", "200"}], ",", 
     RowBox[{"docurves_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "etc", ",", "testexpr", ",", "check", ",", "curves"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"docurves", ",", 
        RowBox[{"globalSilence", "=", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"{", "}"}]}], ";", 
          RowBox[{"etc", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"nprg", "=", "nx"}], ";", 
             RowBox[{"curves", "=", 
              RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "ETC", "]"}], ",", 
                  RowBox[{"\"\<X\>\"", "<>", 
                   RowBox[{"ToString", "[", "nx", "]"}]}]}], "]"}], "]"}], 
               ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             RowBox[{"(*", 
              RowBox[{"important", "!"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"RationalExpressionQ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCN", "[", "nx", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b", ",", "c", ",", "S"}], "}"}]}], 
                 "]"}], "]"}], ",", " ", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"testexpr", "=", 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"replacer", "[", 
                  RowBox[{"expr", ",", "nx"}], "]"}], "//", 
                 "simplifyRationalBarycentrics"}], ",", "10", ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"testexpr", "==", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"check", " ", "=", " ", 
              RowBox[{"checkPointinETC2", "[", "testexpr", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"docurves", "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "check", "]"}], "==", "0"}]}], ",", 
               RowBox[{"curves", " ", "=", " ", 
                RowBox[{
                 RowBox[{"checkCurves", "[", "testexpr", "]"}], "//", 
                 "Quiet"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"etc", ",", 
                 RowBox[{"{", 
                  RowBox[{"nx", ",", 
                   RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"heuristicsCheck", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"testexpr", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", 
                    "partialSAconvert"}], ",", "deg", ",", "ratio", ",", 
                   "cfsum"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "curves", "]"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"{", 
                    RowBox[{"nx", ",", "curves"}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "nx"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"nx", ",", "nmin", ",", "nmax"}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "nprg"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "out", "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"ToString", "[", "etc", "]"}], "//", "colorformat"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"globalSilence", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"out", ",", "etc"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"5d22aa77-5de8-432c-99cb-634540d70c80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setRemoveBrackets", "[", "set_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<)\>\"", "->", "\"\<\>\""}], ",", 
         RowBox[{"\"\<(\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}], "&"}], "/@",
     "set"}]}], ";"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"ecb25160-f5e9-42ba-b6fa-c1404462724f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"massHeuristicsSet", "[", 
   RowBox[{"expr_", ",", "set_", ",", 
    RowBox[{"deg_", ":", "16"}], ",", " ", 
    RowBox[{"ratio_", ":", "4.5"}], ",", " ", 
    RowBox[{"docurves_", ":", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "curves", ",", "out", ",", "etc", ",", "testexpr", ",", "check", ",", 
      "mset"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mset", "=", 
      RowBox[{"setRemoveBrackets", "[", "set", "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{"docurves", ",", 
       RowBox[{"globalSilence", "=", "True"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"etc", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nprg", "=", "nx"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"RationalExpressionQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KimberlingCenterCN", "[", "nx", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}], 
              ",", " ", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"testexpr", "=", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"replacer", "[", 
                 RowBox[{"expr", ",", "nx", ",", "nx"}], "]"}], "//", 
                "simplifyRationalBarycentrics"}], ",", "10", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"testexpr", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"check", " ", "=", " ", 
             RowBox[{"checkPointinETC2", "[", "testexpr", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"docurves", "&&", 
               RowBox[{
                RowBox[{"Length", "[", "check", "]"}], "==", "0"}]}], ",", 
              RowBox[{"curves", " ", "=", " ", 
               RowBox[{
                RowBox[{"checkCurves", "[", "testexpr", "]"}], "//", 
                "Quiet"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"etc", ",", 
                RowBox[{"{", 
                 RowBox[{"nx", ",", 
                  RowBox[{"check", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"heuristicsCheck", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"testexpr", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "evaluate"}], ",", 
                  "deg", ",", "ratio"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "curves", "]"}], ">", "0"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"{", 
                    RowBox[{"nx", ",", "curves"}], "}"}]}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "nx"}], "]"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"nx", ",", "mset"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", "nprg"}], "]"}], "//", 
      "Quiet"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "out", "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "etc", "]"}], "//", "colorformat"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"globalSilence", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"out", ",", "etc"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"df5cd66e-0b95-4219-94d2-420c97acb932"],

Cell[BoxData[
 RowBox[{
  RowBox[{"massHeuristicsFarey", "[", 
   RowBox[{"expr_", ",", "fset_", ",", 
    RowBox[{"deg_", ":", "16"}], ",", " ", 
    RowBox[{"ratio_", ":", "4.5"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out", ",", "etc", ",", "testexpr", ",", "check"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"etc", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nprg", "=", "tvar"}], ";", "\[IndentingNewLine]", 
            RowBox[{"testexpr", "=", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"expr", "/.", 
                 RowBox[{"t", "->", "tvar"}]}], "//", 
                "simplifyRationalBarycentrics"}], ",", "10", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"testexpr", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"check", " ", "=", " ", 
             RowBox[{"checkPointinETC2", "[", 
              RowBox[{"testexpr", "//", "evaluate"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"etc", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"tvar", "//", "ExpressionToTrad"}], ",", 
                  RowBox[{"check", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"heuristicsCheck", "[", 
                 RowBox[{
                  RowBox[{"testexpr", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "deg", ",", "ratio"}],
                  "]"}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"out", ",", "tvar"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"tvar", ",", "fset"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", "nprg"}], "]"}], "//", 
      "Quiet"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "out", "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "etc", "]"}], "//", "colorformat"}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"8a0ddb51-b175-4c27-a1c0-6b976db2304d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"massHeuristicsNoEval", "[", 
    RowBox[{"expr_", ",", "nmin_", ",", "nmax_", ",", 
     RowBox[{"deg_", ":", "16"}], ",", 
     RowBox[{"ratio_", ":", "4.5`"}], ",", 
     RowBox[{"docurves_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "etc", ",", "testexpr", ",", "check", ",", "curves"}], 
      "}"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{"docurves", ",", 
        RowBox[{"globalSilence", "=", "True"}]}], "]"}], ";", 
      RowBox[{"Quiet", "[", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"{", "}"}]}], ";", 
          RowBox[{"etc", "=", 
           RowBox[{"{", "}"}]}], ";", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"nprg", "=", "nx"}], ";", 
             RowBox[{"curves", "=", 
              RowBox[{"{", "}"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"Keys", "[", "ETC", "]"}], ",", 
                  RowBox[{"\"\<X\>\"", "<>", 
                   RowBox[{"ToString", "[", "nx", "]"}]}]}], "]"}]}], ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", 
                RowBox[{"RationalExpressionQ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCN", "[", "nx", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             RowBox[{"testexpr", "=", 
              RowBox[{"TimeConstrained", "[", 
               RowBox[{
                RowBox[{"simplifyRationalBarycentrics", "[", 
                 RowBox[{"expr", "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{"pP", "->", 
                    RowBox[{"KimberlingCenterC", "[", "nx", "]"}]}], "]"}]}], 
                 "]"}], ",", "10", ",", 
                RowBox[{"-", "1"}]}], "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"testexpr", "\[Equal]", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
             RowBox[{"check", "=", 
              RowBox[{"checkPointinETC2", "[", "testexpr", "]"}]}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"docurves", "&&", 
                RowBox[{
                 RowBox[{"Length", "[", "check", "]"}], "\[Equal]", "0"}]}], 
               ",", 
               RowBox[{"curves", "=", 
                RowBox[{"Quiet", "[", 
                 RowBox[{"checkCurves", "[", "testexpr", "]"}], "]"}]}]}], 
              "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"etc", ",", 
                 RowBox[{"{", 
                  RowBox[{"nx", ",", 
                   RowBox[{
                   "check", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"heuristicsCheck", "[", 
                  RowBox[{
                   RowBox[{
                   "testexpr", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "deg", ",", "ratio"}], 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "curves", "]"}], ">", "0"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"{", 
                    RowBox[{"nx", ",", "curves"}], "}"}]}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "nx"}], "]"}]}], "]"}], ";"}]}], 
                "]"}]}], "]"}], ";"}], ",", 
            RowBox[{"{", 
             RowBox[{"nx", ",", "nmin", ",", "nmax"}], "}"}]}], "]"}]}], ",", 
         "nprg"}], "]"}], "]"}], ";", 
      RowBox[{"Print", "[", "out", "]"}], ";", 
      RowBox[{"Print", "[", 
       RowBox[{"colorformat", "[", 
        RowBox[{"ToString", "[", "etc", "]"}], "]"}], "]"}], ";", 
      RowBox[{"globalSilence", "=", "False"}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"out", ",", "etc"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"ab046a1f-e653-432f-9712-01898be229c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"massHeuristicsFareyNoEval", "[", 
     RowBox[{"expr_", ",", "fset_", ",", 
      RowBox[{"deg_", ":", "16"}], ",", 
      RowBox[{"ratio_", ":", "4.5`"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", ",", "etc", ",", "testexpr", ",", "check"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Quiet", "[", 
        RowBox[{"Monitor", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"etc", "=", 
            RowBox[{"{", "}"}]}], ";", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"nprg", "=", "tvar"}], ";", 
              RowBox[{"testexpr", "=", 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"simplifyRationalBarycentrics", "[", 
                  RowBox[{"expr", "/.", "\[VeryThinSpace]", 
                   RowBox[{"t", "\[Rule]", "tvar"}]}], "]"}], ",", "10", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"testexpr", "\[Equal]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
              RowBox[{"check", "=", 
               RowBox[{"checkPointinETC2", "[", "testexpr", "]"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"etc", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ExpressionToTrad", "[", "tvar", "]"}], ",", 
                    RowBox[{
                    "check", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"heuristicsCheck", "[", 
                   RowBox[{
                    RowBox[{
                    "testexpr", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "deg", ",", "ratio"}], 
                   "]"}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"out", ",", "tvar"}], "]"}]}], "]"}]}], "]"}], 
              ";"}], ",", 
             RowBox[{"{", 
              RowBox[{"tvar", ",", "fset"}], "}"}]}], "]"}]}], ",", "nprg"}], 
         "]"}], "]"}], ";", 
       RowBox[{"Print", "[", "out", "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"colorformat", "[", 
         RowBox[{"ToString", "[", "etc", "]"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"massCheckPointsNoEval2Param", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"range_", ":", 
     RowBox[{"Range", "[", 
      RowBox[{"1", ",", "12"}], "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"out", ",", "assoc", ",", "namey", ",", "namex", ",", "check"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"out", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"assoc", "=", 
            RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"namex", "=", 
            RowBox[{"\"\<X\>\"", "<>", 
             RowBox[{"ToString", "[", "ix", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"namey", "=", 
               RowBox[{"\"\<X\>\"", "<>", 
                RowBox[{"ToString", "[", "iy", "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"AssociateTo", "[", 
               RowBox[{"assoc", ",", 
                RowBox[{"\"\<row\>\"", "->", "namex"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ix", ">", "iy"}], ",", 
                RowBox[{
                 RowBox[{"AssociateTo", "[", 
                  RowBox[{"assoc", ",", 
                   RowBox[{"namey", "->", "\"\<\>\""}]}], "]"}], ";", 
                 RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"check", "=", 
               RowBox[{"checkPointinETC2", "[", 
                RowBox[{"replacerNoeval", "[", 
                 RowBox[{"expr", ",", "ix", ",", "iy"}], "]"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"assoc", ",", 
                  RowBox[{"namey", "->", 
                   RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"assoc", ",", 
                  RowBox[{"namey", "->", "\"\<-\>\""}]}], "]"}]}], "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"iy", ",", "range"}], "}"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"out", ",", "assoc"}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ix", ",", "range"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", ",", "ix"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"15d3c264-0a69-42ef-b675-8f2ab17c1393"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"partialSReplace", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"exp", ",", "exp2", ",", "smpl"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ListQ", "[", "expr", "]"}], ",", 
        RowBox[{"exp2", "=", 
         RowBox[{"simplifyRationalBarycentrics", "[", "expr", "]"}]}], ",", 
        RowBox[{"exp2", "=", 
         RowBox[{"Simplify", "[", "expr", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"exp", "=", 
       RowBox[{"Expand", "[", 
        RowBox[{"exp2", "/.", 
         RowBox[{"\[CapitalDelta]", "->", 
          RowBox[{"S", "/", "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"exp", "/.", " ", 
                 RowBox[{
                  SuperscriptBox["S", "2"], "->", 
                  RowBox[{"evaluate", "[", 
                   SuperscriptBox["S", "2"], "]"}]}]}], "/.", 
                RowBox[{
                 SuperscriptBox["S", "4"], "->", 
                 RowBox[{"evaluate", "[", 
                  SuperscriptBox["S", "4"], "]"}]}]}], "/.", 
               RowBox[{
                SuperscriptBox["S", "3"], "->", 
                RowBox[{"S", " ", 
                 RowBox[{"evaluate", "[", 
                  SuperscriptBox["S", "2"], "]"}]}]}]}], "/.", 
              RowBox[{
               SuperscriptBox["S", "5"], "->", 
               RowBox[{"S", " ", 
                RowBox[{"evaluate", "[", 
                 SuperscriptBox["S", "4"], "]"}]}]}]}], "/.", 
             RowBox[{
              SuperscriptBox["S", "6"], "->", 
              RowBox[{"evaluate", "[", 
               SuperscriptBox["S", "6"], "]"}]}]}], "/.", 
            RowBox[{
             SuperscriptBox["S", "7"], "->", 
             RowBox[{"S", " ", 
              RowBox[{"evaluate", "[", 
               SuperscriptBox["S", "6"], "]"}]}]}]}], "/.", 
           RowBox[{
            SuperscriptBox["S", "8"], "->", 
            RowBox[{"evaluate", "[", 
             SuperscriptBox["S", "8"], "]"}]}]}], "/.", 
          RowBox[{
           SuperscriptBox["S", "9"], "->", 
           RowBox[{"S", " ", 
            RowBox[{"evaluate", "[", 
             SuperscriptBox["S", "8"], "]"}]}]}]}], "/.", 
         RowBox[{
          SuperscriptBox["S", "10"], "->", 
          RowBox[{"evaluate", "[", 
           SuperscriptBox["S", "10"], "]"}]}]}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"ListQ", "[", "expr", "]"}], "]"}], ",", 
        RowBox[{"Return", "[", "exp", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"smpl", "=", 
       RowBox[{"ssimplify", "[", "exp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "smpl", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[128]:=",ExpressionUUID->"436f73ea-b3cd-46c2-b523-36f78d7b1305"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"partialSAconvert", "[", "ex_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ex", "/.", 
           RowBox[{"SA", "->", 
            RowBox[{"evaluate", "[", "SA", "]"}]}]}], "/.", 
          RowBox[{"SB", "->", 
           RowBox[{"evaluate", "[", "SB", "]"}]}]}], "/.", 
         RowBox[{"SC", "->", 
          RowBox[{"evaluate", "[", "SC", "]"}]}]}], "/.", 
        RowBox[{"SW", "->", 
         RowBox[{"evaluate", "[", "SW", "]"}]}]}], "/.", 
       RowBox[{"sa", "->", 
        RowBox[{"evaluate", "[", "sa", "]"}]}]}], "/.", 
      RowBox[{"sb", "->", 
       RowBox[{"evaluate", "[", "sb", "]"}]}]}], "/.", 
     RowBox[{"sc", "->", 
      RowBox[{"evaluate", "[", "sc", "]"}]}]}], ")"}]}], ";"}]], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"670f0011-aa2a-4d56-a676-cae8e88fea4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"removeXYZ", "[", "set_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"out", ",", "el1", ",", "el2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"el1", ",", "el2"}], "}"}], "=", "ptn"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringStartsQ", "[", 
             RowBox[{
              RowBox[{"ptn", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Y\>\""}], "]"}], "||", 
            RowBox[{"StringStartsQ", "[", 
             RowBox[{
              RowBox[{"ptn", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Z\>\""}], "]"}]}], 
           ",", " ", 
           RowBox[{"el1", "=", 
            RowBox[{"NonETCNames", "[", 
             RowBox[{"ptn", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringStartsQ", "[", 
             RowBox[{
              RowBox[{"ptn", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Y\>\""}], "]"}], "||", 
            RowBox[{"StringStartsQ", "[", 
             RowBox[{
              RowBox[{"ptn", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Z\>\""}], "]"}]}], 
           ",", " ", 
           RowBox[{"el2", "=", 
            RowBox[{"NonETCNames", "[", 
             RowBox[{"ptn", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"el1", ",", "el2"}], "}"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"StringReplace", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<X\>\"", "->", "\"\<\>\""}], ",", 
                RowBox[{"\"\<IsotConjg\>\"", "->", "\"\<it\>\""}], ",", 
                RowBox[{"\"\<IsogConj\>\"", "->", "\"\<ig\>\""}]}], "}"}]}], 
             "]"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"el1", ",", "el2"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"out", ",", 
           RowBox[{"{", 
            RowBox[{"el1", ",", "el2"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ptn", ",", "set"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"144473d8-cf04-409b-a723-8038acc339f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"leastBaryFromIntersections", "[", "testset_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "results", ",", "tt", ",", "out", ",", " ", "mon", ",", "min", ",", " ",
        "deg"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"min", "=", "100"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"results", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"AbortProtect", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"mon", " ", "=", " ", 
                  RowBox[{"{", 
                   RowBox[{"nx1", ",", "nx2"}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", " ", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"nx1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">=", 
                    RowBox[{"nx2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                   RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"tt", "=", 
                  RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ssimplify", "[", 
                    RowBox[{"bLineIntersection", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"bLine", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterC", "[", 
                    RowBox[{"nx1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", 
                    "partialSAconvert"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterC", "[", 
                    RowBox[{"nx1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", 
                    "partialSAconvert"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"bLine", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterC", "[", 
                    RowBox[{"nx2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", 
                    "partialSAconvert"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterC", "[", 
                    RowBox[{"nx2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "//", 
                    "partialSAconvert"}]}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "//", "Simplify"}], "//", 
                    "Expand"}], "//", "partialSReplace"}], ",", "5", ",", 
                    RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"tt", "==", 
                    RowBox[{"-", "1"}]}], ",", 
                   RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"deg", " ", "=", " ", 
                  RowBox[{"polynomialDegree", "[", "tt", "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"deg", ">", "0"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"results", ",", 
                    RowBox[{"{", 
                    RowBox[{"nx1", ",", "nx2", ",", "tt", ",", "deg"}], 
                    "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"deg", "<", "min"}], ",", 
                    RowBox[{
                    RowBox[{"Print", "[", "\"\<New min:\>\"", "]"}], ";", 
                    RowBox[{"min", "=", "deg"}], ";", 
                    RowBox[{"Print", "[", 
                    RowBox[{"{", 
                    RowBox[{"nx1", ",", "nx2", ",", "deg"}], "}"}], "]"}]}]}],
                     "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
                "\[IndentingNewLine]", ",", 
                RowBox[{"Return", "[", 
                 RowBox[{
                  RowBox[{"SortBy", "[", 
                   RowBox[{"results", ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}], ",", 
                  "Module"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"nx1", ",", "testset"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"nx2", ",", "testset"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}]}], "\[IndentingNewLine]", ",", "mon"}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"results", ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"out", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"ExpressionToTrad", "[", 
        RowBox[{
         RowBox[{"out", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"71e813b5-7d5b-4e55-b6d4-337f87107574"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setHeuristics", "[", 
    RowBox[{"expr_", ",", "set_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"seti", ",", "etc", ",", "check", ",", "ptcoord", ",", "out"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"etc", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"seti", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<(\>\"", "->", "\"\<\>\""}], ",", 
             RowBox[{"\"\<)\>\"", "->", "\"\<\>\""}]}], "}"}]}], "]"}], "&"}],
         "/@", "set"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AbortProtect", "[", 
           RowBox[{"CheckAbort", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ptcoord", " ", "=", " ", 
               RowBox[{"TimeConstrained", "[", 
                RowBox[{
                 RowBox[{"simplifyRationalBarycentrics", "[", 
                  RowBox[{"expr", "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
                    RowBox[{"simplifyRationalBarycentrics", "[", 
                    RowBox[{"evaluate", "[", 
                    RowBox[{"KimberlingCenterC", "[", "ptn", "]"}], "]"}], 
                    "]"}]}], "]"}]}], "]"}], ",", "8", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"ptcoord", "==", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{"Print", "[", 
                  RowBox[{"ptn", "<>", "\"\< timeout\>\""}], "]"}], ";", 
                 RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"check", " ", "=", " ", 
               RowBox[{"checkPointinETC2", "[", "ptcoord", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"etc", ",", 
                  RowBox[{"{", 
                   RowBox[{"ptn", ",", 
                    RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"heuristicsCheck", "[", 
                    RowBox[{
                    RowBox[{"evaluate", "[", 
                    RowBox[{
                    "ptcoord", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", "16", ",", "5"}], 
                    "]"}], ",", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "ptn"}], "]"}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"etc", ",", "out"}], "}"}], ",", "Module"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], "]"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"ptn", ",", "seti"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], "\[IndentingNewLine]", ",", "ptn"}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"etc", ",", "out"}], "}"}], ",", "Module"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"5054fc6d-7d9e-4080-b8e2-74588e9a3c43"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fareySet", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"FareySequence", "[", "n", "]"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"FareySequence", "[", "n", "]"}]}]}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "=!=", "ComplexInfinity"}], "&&", 
          RowBox[{"#", ">", "0"}]}], "&"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"-", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"FareySequence", "[", "n", "]"}], ",", 
           RowBox[{"1", "/", 
            RowBox[{"FareySequence", "[", "n", "]"}]}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "=!=", "ComplexInfinity"}], "&&", 
           RowBox[{"#", ">", "0"}]}], "&"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";"}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"559c8961-4bd4-4f35-9ed3-f2fae7106326"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replacer", "[", 
    RowBox[{"expr_", ",", "nu_", ",", 
     RowBox[{"np_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"simplifyRationalBarycentrics", "[", 
    RowBox[{
     RowBox[{"expr", "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{
          RowBox[{"KimberlingCenterC", "[", "nu", "]"}], "//", "evaluate"}], 
         "]"}]}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", "q", ",", "r"}], "}"}], "->", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "np", "]"}], "//", "evaluate"}], 
        "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"14480d9f-512d-44d9-9065-a4a64bc31495"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replacerNoeval", "[", 
    RowBox[{"expr_", ",", "nu_", ",", 
     RowBox[{"np_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"simplifyRationalBarycentrics", "[", 
    RowBox[{
     RowBox[{"expr", "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"KimberlingCenterC", "[", "nu", "]"}], "]"}]}], "]"}]}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", "q", ",", "r"}], "}"}], "->", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"KimberlingCenterC", "[", "np", "]"}], "]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[135]:=",ExpressionUUID->"9b228d32-67a4-43ed-8c9f-524ed28950d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replacerExpr", "[", 
    RowBox[{"expr_", ",", "nu_", ",", 
     RowBox[{"np_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "nu", "]"}], "//", "evaluate"}], 
        "]"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "q", ",", "r"}], "}"}], "->", 
      RowBox[{"simplifyRationalBarycentrics", "[", 
       RowBox[{
        RowBox[{"KimberlingCenterC", "[", "np", "]"}], "//", "evaluate"}], 
       "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[136]:=",ExpressionUUID->"3c1336c7-df8d-4dda-adb4-8d7533975bda"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"replacerExprNoeval", "[", 
    RowBox[{"expr_", ",", "nu_", ",", 
     RowBox[{"np_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"KimberlingCenterC", "[", "nu", "]"}], "]"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", "q", ",", "r"}], "}"}], "->", 
      RowBox[{"simplifyRationalBarycentrics", "[", 
       RowBox[{"KimberlingCenterC", "[", "np", "]"}], "]"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[137]:=",ExpressionUUID->"e518688a-c7b4-4775-acc3-9b537d0f4f65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rplux", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"toUVW", "[", "expr_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l", ",", "m", ",", "n"}], "}"}], "->", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "w"}], "}"}]}], "]"}]}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q", ",", "r"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "w"}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->
  "In[138]:=",ExpressionUUID->"546192cb-54fe-4369-acb3-8affe5e94aba"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setToAssociation", "[", "set_", "]"}], ":=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\"\<X(\>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}], "&"}], 
       ",", "set"}], "]"}], ",", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"intaddbrackets", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}], ",", 
       RowBox[{"DeleteDuplicatesBy", "[", 
        RowBox[{"set", ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellLabel->
  "In[140]:=",ExpressionUUID->"31798e30-3c16-41a7-b5d5-5d1110e48799"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ssimplify", "[", "pt_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ss", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ss", "[", "ptn_", "]"}], ":=", 
       RowBox[{
        RowBox[{
         RowBox[{"Activate", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Collect", "[", 
             RowBox[{"#", ",", "S", ",", 
              RowBox[{"Inactive", "[", "Simplify", "]"}]}], "]"}], "/.", 
            RowBox[{"Simplify", "->", "intFullSimplifyFactors"}]}], ")"}]}], 
         "&"}], "/@", "ptn"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ss", "[", "pt", "]"}], "/.", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"a", "-", "b", "-", "c"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "-", "c"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"a", "-", "b", "+", "c"}], ")"}], 
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "+", "c"}], ")"}]}], "->", 
               RowBox[{
                RowBox[{"-", "4"}], 
                SuperscriptBox["S", "2"]}]}]}], "/.", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "+", "b", "-", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"a", "-", "b", "+", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "a"}], "+", "b", "+", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"a", "+", "b", "+", "c"}], ")"}]}], "->", 
              RowBox[{"4", 
               SuperscriptBox["S", "2"]}]}]}], "/.", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"-", "3"}], " ", 
               SuperscriptBox["a", "4"]}], "-", 
              RowBox[{"3", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["b", "2"], "-", 
                  SuperscriptBox["c", "2"]}], ")"}], "2"]}], "+", 
              RowBox[{"6", " ", 
               SuperscriptBox["a", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["b", "2"], "+", 
                 SuperscriptBox["c", "2"]}], ")"}]}]}], "->", 
             RowBox[{"12", 
              SuperscriptBox["S", "2"]}]}]}], "/.", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"a", "-", "b", "-", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"a", "+", "b", "-", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"a", "-", "b", "+", "c"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{"a", "+", "b", "+", "c"}], ")"}]}], ")"}]}], "->", 
            RowBox[{"4", 
             SuperscriptBox["S", "2"]}]}]}], "/.", 
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "4"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["b", "2"], "-", 
               SuperscriptBox["c", "2"]}], ")"}], "2"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["b", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}]}]}], "->", 
           RowBox[{
            RowBox[{"-", "4"}], 
            SuperscriptBox["S", "2"]}]}]}], "//", "ss"}], "]"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[141]:=",ExpressionUUID->"b4836c1a-aa8e-4178-b100-7d8c21d0f8b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ttsimplify", "[", "ptn_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Activate", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{"#", ",", "t", ",", 
          RowBox[{"Inactive", "[", "Simplify", "]"}]}], "]"}], "/.", 
        RowBox[{"Simplify", "->", "intFullSimplifyFactors"}]}], ")"}]}], 
     "&"}], "/@", "ptn"}]}], ";"}]], "Input",
 CellLabel->
  "In[142]:=",ExpressionUUID->"d0c85ba2-f87d-419a-a0d1-6ea9fed36d4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"smpl", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "y", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"RationalExpressionQ", "[", 
          RowBox[{
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c", ",", "A", ",", "B", ",", "C"}], 
            "}"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{"y", "=", 
          RowBox[{"simplifyRationalBarycentrics", "[", "x", "]"}]}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"y", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "//", "simplifyRationalBarycentrics"}], "//", 
             "partialSReplace"}], "//", "partialSAconvert"}], "//", 
           "simplifyRationalBarycentrics"}]}], ";"}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "y", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[143]:=",ExpressionUUID->"d1cc5477-1dbf-435d-88a7-36a13200f0fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"setSquareBary", "=", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "20", ",", "22", ",", 
     "23", ",", "24", ",", "25", ",", "26", ",", "32", ",", "39", ",", "49", 
     ",", "51", ",", "52", ",", "53", ",", "54", ",", "64", ",", "66", ",", 
     "67", ",", "68", ",", "69", ",", "70", ",", "74", ",", "76", ",", "83", 
     ",", "93", ",", "95", ",", "96", ",", "97", ",", "98", ",", "111", ",", 
     "113", ",", "114", ",", "126", ",", "131", ",", "132", ",", "133", ",", 
     "140", ",", "141", ",", "154", ",", "155", ",", "156", ",", "157", ",", 
     "159", ",", "160", ",", "161", ",", "182", ",", "183", ",", "184", ",", 
     "185", ",", "187", ",", "193", ",", "194", ",", "195", ",", "206", ",", 
     "211", ",", "216", ",", "217", ",", "230", ",", "231", ",", "232", ",", 
     "233", ",", "235", ",", "237", ",", "248", ",", "251", ",", "262", ",", 
     "263", ",", "264", ",", "275", ",", "276", ",", "287", ",", "290", ",", 
     "297", ",", "305", ",", "308", ",", "311", ",", "315", ",", "316", ",", 
     "317", ",", "324", ",", "325", ",", "327", ",", "343", ",", "351", ",", 
     "352", ",", "353", ",", "373", ",", "384", ",", "384", ",", "393", ",", 
     "394", ",", "439", ",", "468", ",", "570", ",", "574", ",", "576", ",", 
     "577", ",", "597", ",", "598", ",", "599", ",", "625", ",", "626", ",", 
     "669", ",", "670", ",", "671", ",", "684", ",", "689", ",", "691", ",", 
     "694", ",", "695", ",", "699", ",", "703", ",", "729", ",", "737", ",", 
     "755", ",", "783", ",", "805", ",", "809", ",", "827", ",", "850", ",", 
     "880", ",", "881", ",", "882", ",", "887", ",", "892", ",", "930", ",", 
     "1003", ",", "1031", ",", "1078", ",", "1084"}], "}"}]}], ";"}]], "Input",
 CellLabel->
  "In[144]:=",ExpressionUUID->"e3f13638-8785-48ab-84d0-cc36c803ca8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<TriangleExpressions.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<TriangleExpressions.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "polynomialDegree", ",", "countSummands", ",", "symmetrizeEq", ",", " ", 
      "conwaySimplify", ",", "evaluate", ",", "simplifyRationalBarycentrics", 
      ",", "ggCurve", ",", "ggBaryToCartesian", ",", "homogeneousPart", ",", 
      "intSimplifyFactors", ",", "heuristicsCheck", ",", "partialSReplace", 
      ",", "fareySet", ",", "partialSAconvert", ",", 
      "leastBaryFromIntersections", ",", "replacer", ",", 
      "intFullSimplifyFactors", ",", "massHeuristics1", ",", 
      "massHeuristicsFarey", ",", "rplux", ",", "setHeuristics", ",", 
      "removeXYZ", ",", "setToAssociation", ",", "replacerExpr", ",", 
      "replacerNoeval", ",", "replacerExprNoeval", ",", "toUVW", ",", 
      "massHeuristicsSet", ",", "setRemoveBrackets", ",", 
      "massHeuristicsNoEval", ",", "massHeuristicsFareyNoEval", ",", 
      "ssimplify", ",", "ttsimplify", ",", "intSimplifyFactorsToTrad", ",", 
      "setSquareBary", ",", "smpl", ",", "massCheckPointsNoEval2Param"}], 
     "}"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[145]:=",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
},
WindowSize->{1105.2, 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aca5b677-55b6-4267-a176-e3559e484e60"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 680, 13, 28, "Input",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],
Cell[1241, 35, 14001, 363, 823, "Input",ExpressionUUID->"6e78eba6-01f6-40c6-b3e8-5afba25a3220"],
Cell[15245, 400, 7162, 186, 482, "Input",ExpressionUUID->"4c3e296e-741c-4616-a2af-bb5ca6c06ef1"],
Cell[22410, 588, 979, 25, 48, "Input",ExpressionUUID->"2b5aa4ea-3c5f-4323-a08d-3c7ed8e84a6e"],
Cell[23392, 615, 1122, 29, 67, "Input",ExpressionUUID->"39b90364-1581-4eab-b764-27b8c81cbdfb"],
Cell[24517, 646, 687, 19, 28, "Input",ExpressionUUID->"a63c6561-dfc3-4921-b8cc-f4e6a4d72f42"],
Cell[25207, 667, 982, 28, 48, "Input",ExpressionUUID->"e59a367d-3e5a-486a-820c-00c49b5a6261"],
Cell[26192, 697, 3095, 86, 162, "Input",ExpressionUUID->"dee31942-40a2-4b46-adba-cb5a15d8592c"],
Cell[29290, 785, 5924, 137, 542, "Input",ExpressionUUID->"5d22aa77-5de8-432c-99cb-634540d70c80"],
Cell[35217, 924, 470, 14, 28, "Input",ExpressionUUID->"ecb25160-f5e9-42ba-b6fa-c1404462724f"],
Cell[35690, 940, 5179, 122, 523, "Input",ExpressionUUID->"df5cd66e-0b95-4219-94d2-420c97acb932"],
Cell[40872, 1064, 3096, 74, 314, "Input",ExpressionUUID->"8a0ddb51-b175-4c27-a1c0-6b976db2304d"],
Cell[43971, 1140, 5098, 124, 371, "Input",ExpressionUUID->"ab046a1f-e653-432f-9712-01898be229c7"],
Cell[49072, 1266, 6174, 148, 600, "Input",ExpressionUUID->"15d3c264-0a69-42ef-b675-8f2ab17c1393"],
Cell[55249, 1416, 3269, 86, 210, "Input",ExpressionUUID->"436f73ea-b3cd-46c2-b523-36f78d7b1305"],
Cell[58521, 1504, 943, 27, 67, "Input",ExpressionUUID->"670f0011-aa2a-4d56-a676-cae8e88fea4e"],
Cell[59467, 1533, 2991, 80, 219, "Input",ExpressionUUID->"144473d8-cf04-409b-a723-8038acc339f9"],
Cell[62461, 1615, 6311, 140, 638, "Input",ExpressionUUID->"71e813b5-7d5b-4e55-b6d4-337f87107574"],
Cell[68775, 1757, 4301, 101, 428, "Input",ExpressionUUID->"5054fc6d-7d9e-4080-b8e2-74588e9a3c43"],
Cell[73079, 1860, 1179, 33, 86, "Input",ExpressionUUID->"559c8961-4bd4-4f35-9ed3-f2fae7106326"],
Cell[74261, 1895, 954, 26, 67, "Input",ExpressionUUID->"14480d9f-512d-44d9-9065-a4a64bc31495"],
Cell[75218, 1923, 869, 23, 67, "Input",ExpressionUUID->"9b228d32-67a4-43ed-8c9f-524ed28950d4"],
Cell[76090, 1948, 884, 25, 48, "Input",ExpressionUUID->"3c1336c7-df8d-4dda-adb4-8d7533975bda"],
Cell[76977, 1975, 801, 22, 48, "Input",ExpressionUUID->"e518688a-c7b4-4775-acc3-9b537d0f4f65"],
Cell[77781, 1999, 1086, 34, 48, "Input",ExpressionUUID->"546192cb-54fe-4369-acb3-8affe5e94aba"],
Cell[78870, 2035, 902, 27, 48, "Input",ExpressionUUID->"31798e30-3c16-41a7-b5d5-5d1110e48799"],
Cell[79775, 2064, 4040, 107, 156, "Input",ExpressionUUID->"b4836c1a-aa8e-4178-b100-7d8c21d0f8b7"],
Cell[83818, 2173, 522, 15, 28, "Input",ExpressionUUID->"d0c85ba2-f87d-419a-a0d1-6ea9fed36d4b"],
Cell[84343, 2190, 1318, 34, 162, "Input",ExpressionUUID->"d1cc5477-1dbf-435d-88a7-36a13200f0fb"],
Cell[85664, 2226, 1885, 28, 105, "Input",ExpressionUUID->"e3f13638-8785-48ab-84d0-cc36c803ca8b"],
Cell[87552, 2256, 1302, 23, 173, "Input",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
}
]
*)

