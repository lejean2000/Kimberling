(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    268177,       6506]
NotebookOptionsPosition[    263979,       6450]
NotebookOutlinePosition[    264655,       6472]
CellTagsIndexPosition[    264612,       6469]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.858229176389264*^9, 3.858229446693867*^9, 3.8602953602247972`*^9, 
   3.860302009654538*^9, {3.860485791732256*^9, 3.860485794873648*^9}, {
   3.860485932054061*^9, 3.860485933925563*^9}, {3.875666590817411*^9, 
   3.8756665934403267`*^9}, {3.8756666396111803`*^9, 3.875666670228642*^9}, {
   3.87568396954793*^9, 3.875683973023356*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"globalOutputStream", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalNoCleanup", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalSeenPoints", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalProperties", " ", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalCheckAllPoles", " ", "=", " ", "False"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointCheckerMinProperties", "=", "3"}], ";", 
  RowBox[{"globalExcludedNum", "=", "0"}], ";"}]}], "Input",
 CellLabel->"In[29]:=",ExpressionUUID->"61f6f64d-63ef-4439-a691-6cde886d252c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xnum", "[", "str_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumericQ", "[", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringTake", "[", 
        RowBox[{"str", ",", "1"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"ToExpression", "[", "str", "]"}], ",", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xnumforsort", "[", "str_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", "1"}], "]"}], "==", "\"\<X\>\""}], ",", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"100000", "+", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringTake", "[", 
        RowBox[{"str", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numsortexpr", "[", "str_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"str", ",", "1"}], "]"}], "<>", 
    RowBox[{"StringPadLeft", "[", 
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "10", ",", "\"\<0\>\""}],
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intnameformat", "[", "pname_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"pname", ",", "1"}], "]"}], "==", "\"\<X\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StringTake", "[", 
      RowBox[{"pname", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", "1"}], "]"}], "<>", "\"\<(\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "pname"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intnameformat2", "[", "pname_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"pname", ",", "1"}], "]"}], "==", "\"\<X\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringTake", "[", 
       RowBox[{"pname", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", "1"}], "]"}], "<>", "\"\<(\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "pname"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intaddbrackets", "[", "pname_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"pname", ",", "1"}], "]"}], "<>", "\"\<(\>\"", "<>", 
    RowBox[{"StringTake", "[", 
     RowBox[{"pname", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intmark", "[", 
    RowBox[{"number_", ",", 
     RowBox[{"spec", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Characters", "@", 
         RowBox[{"ToString", "@", "number"}]}]}], "}"}], ",", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"MapAt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", "x", ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", "n", ",", 
        "spec"}], "]"}]}], "]"}], "//", "Row"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addxtoname", "[", "str_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NumericQ", "[", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringTake", "[", 
        RowBox[{
         RowBox[{"ToString", "[", "str", "]"}], ",", "1"}], "]"}], "]"}], 
      "]"}], ",", 
     RowBox[{"\"\<X\>\"", "<>", 
      RowBox[{"ToString", "[", "str", "]"}]}], ",", "str"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"colorformat", "[", 
     RowBox[{"string_", ",", 
      RowBox[{"cases_", ":", 
       RowBox[{
       "RegularExpression", "[", 
        "\"\<Y\\\\(\\\\d+\\\\)|Y\\\\d+|Z\\\\(\\\\d+\\\\)|Z\\\\d+\>\"", 
        "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "agg", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"TrueQ", "[", "colorPrintOn", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"TrueQ", "[", "globalNoCleanup", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"string", ",", " ", "Module"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Return", "[", 
              RowBox[{
               RowBox[{"cleanup", "[", "string", "]"}], ",", " ", "Module"}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"string", ",", "cases"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"agg", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1", ",", "Red", 
              ",", "2", ",", "Brown", ",", "_", ",", "Blue"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"GatherBy", "[", 
          RowBox[{
           RowBox[{"Tally", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Range", "@@@", "pos"}], "]"}]}], ",", "Last"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "agg", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"intmark", "[", 
           RowBox[{"string", ",", "agg"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "string", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"cleanup", "[", "string_", "]"}], ":=", 
    RowBox[{"StringReplace", "[", 
     RowBox[{"string", ",", 
      RowBox[{
       RowBox[{
       "RegularExpression", "[", 
        "\"\<[, ]*{+([Y|Z]*?[\\\\d, \\\\(\\\\)ABCX])*[Y|Z].*?}+\>\"", "]"}], 
       "->", "\"\<\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intnumericnorm", "[", "val_", "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"NormalizeBary", "[", "val", "]"}], ",", "35"}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coincide", "[", 
     RowBox[{"pt1_", ",", "pt2_", ",", 
      RowBox[{"prec_", ":", "20"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "t", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pt1", "==", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "||", 
          RowBox[{"pt2", "==", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ",", 
         RowBox[{"Return", "[", "False", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"Abs", "/@", 
            RowBox[{"Cross", "[", 
             RowBox[{"pt1", ",", "pt2"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "prec"}]]}], "&&", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "prec"}]]}], "&&", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "prec"}]]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coincideNorm", "[", 
     RowBox[{"pt1_", ",", "pt2_", ",", 
      RowBox[{"prec_", ":", "20"}]}], "]"}], ":=", 
    RowBox[{"Return", "[", 
     RowBox[{"coincide", "[", 
      RowBox[{
       RowBox[{"intnumericnorm", "[", "pt1", "]"}], ",", 
       RowBox[{"intnumericnorm", "[", "pt2", "]"}], ",", "prec"}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCheckList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", "5"}], ",", 
       RowBox[{"b", "->", "6"}], ",", 
       RowBox[{"c", "->", "8"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", "4"}], ",", 
       RowBox[{"b", "->", "11"}], ",", 
       RowBox[{"c", "->", "13"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[35]:=",ExpressionUUID->"b80a96f9-c842-4ef8-9bf5-1d19f4841581"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"print", "[", "string_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"StringContainsQ", "[", 
       RowBox[{"string", ",", "\"\<KeyAbsent\>\""}], "]"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"\"\<\>\"", ",", " ", "Module"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Names", "[", "\"\<Global`*\>\"", "]"}], ",", 
             "\"\<globalOutputStream\>\""}], "]"}], "]"}], "||", 
          RowBox[{"globalOutputStream", "===", "False"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "string", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"globalOutputStream", ",", 
           RowBox[{"string", "<>", "\"\<\\n\\n\>\""}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmpsessiontime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"printSessionTime", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "t", "}"}], ",", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"SessionTime", "[", "]"}], "-", "tmpsessiontime"}], "]"}], ";",
      " ", 
     RowBox[{"tmpsessiontime", "=", 
      RowBox[{"SessionTime", "[", "]"}]}], ";"}]}], "]"}]}]}], "Input",
 CellLabel->"In[49]:=",ExpressionUUID->"883898fa-539b-4557-b0b3-a234b6adc26c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pointProcessBary", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"rule_", ":", "rule69"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pointsBary", ",", "etcbary"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"etcbary", "=", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{"ETCBaryNorm", ",", "globalExcludedNum"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pointsBary", "=", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"expr", "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", "val"}], 
              "]"}]}], "/.", "rule"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"val", ",", "etcbary"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], "//", "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{
         RowBox[{"Keys", "[", "etcbary", "]"}], "->", "pointsBary"}], "]"}], 
       "]"}], ";"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pta", " ", "=", " ", 
          RowBox[{"ETCBaryNorm", "[", "k", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"Im", "[", "pta", "]"}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{"pta", ",", 
              RowBox[{
               RowBox[{"#", "===", "ComplexInfinity"}], "&"}]}], "]"}], "||", 
            RowBox[{"AnyTrue", "[", 
             RowBox[{"pta", ",", 
              RowBox[{
               RowBox[{"#", "===", "Infinity"}], "&"}]}], "]"}]}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Point", " ", "Process", " ", "Calculation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"pti", " ", "=", " ", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"evaluate", "[", 
             RowBox[{"ReleaseHold", "[", 
              RowBox[{"expr", "/.", 
               RowBox[{"#", "->", "pta"}]}], "]"}], "]"}], "/.", "rule"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pti", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=!=", "Indeterminate"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"pointsBary", ",", 
              RowBox[{"k", "->", "pti"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Keys", "[", "ETCBaryNorm", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pointsBary", "]"}], ";"}], "*)"}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"74111645-2b56-4fda-8b77-c132e8d1be4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intVerifyPointProcess", "[", 
    RowBox[{"pt_", ",", "xnum_", ",", "processexpr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptn", ",", "pta", ",", "pti"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ptn", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pta", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"KimberlingCenterCNy", "[", "xnum", "]"}], "/.", "rc"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pti", " ", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"evaluate", "[", "processexpr", "]"}], "/.", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", "pta"}]}], "/.",
             "rc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"coincide", "[", 
             RowBox[{"ptn", ",", " ", "pti"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{"False", ",", " ", "Module"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"rc", ",", "intCheckList"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"26d5a62e-503c-4018-a856-34e31e5b398f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intPointCheck", "[", 
    RowBox[{"pt_", ",", "process_", ",", 
     RowBox[{"rule_", ":", "rule69"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", "res", ",", "ptn", ",", "ptnum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptn", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"pointProcessBary", "[", 
        RowBox[{"process", ",", "rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{"#", ",", " ", "ptn"}], "]"}], "&"}], "/@", "tmp"}], ",", 
         "TrueQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"intVerifyPointProcess", "[", 
            RowBox[{"pt", ",", 
             RowBox[{
              RowBox[{"Keys", "[", "res", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "process"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "res", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"c39b8072-918d-4251-8a15-74a2adcadfbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pointCheckAllProcesses", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", " ", "prop"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"PrintTemporary", "[", "proc", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"intPointCheck", "[", 
           RowBox[{"pt", ",", 
            RowBox[{"singlePointProcesses", "[", "proc", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringQ", "[", "res", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prop", " ", "=", " ", 
             RowBox[{"\"\<= \>\"", "<>", " ", "proc", "<>", "\"\< of \>\"", "<>", 
              RowBox[{"intaddbrackets", "[", "res", "]"}]}]}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"prop", "//", "colorformat"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AssociateTo", "[", 
             RowBox[{
              RowBox[{"globalProperties", "[", "name", "]"}], ",", 
              RowBox[{"proc", "->", 
               RowBox[{"intaddbrackets", "[", "res", "]"}]}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"proc", ",", 
          RowBox[{"Keys", "[", "singlePointProcesses", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"138afecd-e9f2-4f46-90cb-79229dc0c3d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"singlePointProcesses", "=", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<isogonal conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "v", " ", "w"}], ",", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", "u", " ", "w"}], ",", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", "u", " ", "v"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<isotomic conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", " ", "w"}], ",", 
        RowBox[{"u", " ", "w"}], ",", 
        RowBox[{"u", " ", "v"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<complement\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"v", "+", "w"}], ",", 
        RowBox[{"u", "+", "w"}], ",", 
        RowBox[{"u", "+", "v"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "u"}], "+", "v", "+", "w"}], ",", 
        RowBox[{"u", "-", "v", "+", "w"}], ",", 
        RowBox[{"u", "+", "v", "-", "w"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement of isogonal conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", "v"}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "2"]}], " ", "u", " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}]}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement of isotomic conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "v"}], " ", "w"}], "+", 
         RowBox[{"u", " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"u", " ", 
          RowBox[{"(", 
           RowBox[{"v", "-", "w"}], ")"}]}], "+", 
         RowBox[{"v", " ", "w"}]}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "u"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "-", "w"}], ")"}]}], "+", 
         RowBox[{"v", " ", "w"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<complement of isogonal conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["c", "2"], " ", "v"}], "+", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["c", "2"], " ", "u"}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["b", "2"], " ", "u"}], "+", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<complement of isotomic conjugate\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}]}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", "w"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<zosma transform\>\"", "->", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", "v"}], "+", 
           RowBox[{"b", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"b", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c", " ", "u"}], "+", 
           RowBox[{"a", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"c", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"b", " ", "u"}], "+", 
           RowBox[{"a", " ", "v"}]}], ")"}]}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<eigentransform\>\"", "->", 
      RowBox[{"bEigentransform", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<cyclocevian conjugate\>\"", "->", 
      RowBox[{"bCyclocevianConjugate", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<circlecevian perspector\>\"", "->", 
      RowBox[{"bCirclecevianPerspector", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ortoassociate\>\"", "->", 
      RowBox[{"bOrthoassociate", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<antitomic conjugate\>\"", "->", 
      RowBox[{"bAntitomicConjugate", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<syngonal conjugate\>\"", "->", 
      RowBox[{"bSyngonal", "[", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"6b44296a-dc56-44c3-981b-023a39cb076c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intLinesProcessFullGroups", "[", 
     RowBox[{"pt_", ",", "prec_", ",", "etcset_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tplist", ",", " ", "tp", ",", " ", "prev", ",", " ", "outgroups", ",",
         " ", "group", ",", " ", "fullgroups", ",", " ", "dump", ",", "as"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fullgroups", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"outgroups", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tplist", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"name", ",", 
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{"NormalizeBary", "[", 
               RowBox[{
                RowBox[{"1", "/", 
                 RowBox[{"bLine", "[", 
                  RowBox[{"pt", ",", 
                   RowBox[{"etcset", "[", "name", "]"}]}], "]"}]}], "/.", " ",
                 "rule69"}], "]"}], ",", "prec"}], "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"name", ",", 
            RowBox[{"Keys", "[", "etcset", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tplist", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"tplist", ",", 
          RowBox[{
           RowBox[{"AllTrue", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             "Internal`RealValuedNumericQ"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tplist", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"tplist", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"as", "=", 
        RowBox[{"AssociationThread", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "tplist"}], "]"}], 
          ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "tplist"}], "]"}]}],
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fullgroups", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Values", "[", 
           RowBox[{"PositionIndex", "[", "as", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"outgroups", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{"SortBy", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}], ",", 
             "2"}], "]"}], "&"}], ",", "fullgroups"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"outgroups", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"outgroups", ",", 
          RowBox[{
           RowBox[{"numsortexpr", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"outgroups", ",", " ", "fullgroups"}], "}"}], "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intHarmonicProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Harmonic", " ", "conjugates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "200"}], ",", " ", 
           RowBox[{"fgr1", "=", 
            RowBox[{"Take", "[", 
             RowBox[{"fgr1", ",", "200"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"flatfg2", "=", 
          RowBox[{"Subsets", "[", 
           RowBox[{"fgr1", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"checks", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NormalizeBary", "[", 
              RowBox[{"bHarmonicConjugate", "[", 
               RowBox[{
                RowBox[{"ETCBaryNorm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ETCBaryNorm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "pt"}], "]"}], 
              "]"}], "&"}], ",", "flatfg2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ingroupnbary", "=", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"ETCBaryNorm", ",", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"fgr1", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"un", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"checks", ",", "ingroupnbary"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hgroup", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"\"\<X0\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "|>"}]}], ";", 
         RowBox[{"dump", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"coincide", "[", 
               RowBox[{
                RowBox[{"un", "[", "el", "]"}], ",", 
                RowBox[{"prev", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hgroup", ",", "el"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hgroup", "]"}], "==", "1"}], ",", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"hgroup", ",", 
                    RowBox[{
                    RowBox[{"Keys", "[", "prev", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
                  RowBox[{"dump", "=", "1"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"dump", "==", "1"}], " ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AnyTrue", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Length", ",", "hgroup"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "==", "0"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"hgroups", ",", "hgroup"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"hgroup", "=", 
                   RowBox[{"{", "}"}]}], ";", 
                  RowBox[{"dump", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"el", "->", 
               RowBox[{"un", "[", "el", "]"}]}], "|>"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"el", ",", 
             RowBox[{"Keys", "[", "un", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"51aa5bfe-e1a6-46b3-93f3-4a939e2f11f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intReflectionProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reflections", " ", "conjugates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"keep", " ", "only", " ", "200", " ", "elements"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "200"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fgr1", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"fgr1", ",", "200"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"checks", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NormalizeBary", "[", 
              RowBox[{"bMidpoint", "[", 
               RowBox[{
                RowBox[{"ETCBaryNorm", "[", "#", "]"}], ",", "pt"}], "]"}], 
              "]"}], "&"}], ",", "fgr1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"refl", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"fgr1", ",", " ", 
               RowBox[{
                RowBox[{"coincide", "[", 
                 RowBox[{
                  RowBox[{"ETCBaryNorm", "[", "#", "]"}], ",", 
                  RowBox[{"checks", "[", "el", "]"}]}], "]"}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "refl", "]"}], ">", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"hgroups", ",", 
                RowBox[{"{", 
                 RowBox[{"el", ",", 
                  RowBox[{"refl", "//", "First"}]}], "}"}]}], "]"}]}], 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"el", ",", 
             RowBox[{"Keys", "[", "checks", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"bca15176-ab78-40f6-ad1d-3f9d33e84dcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intMidpointProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Midpoints", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"keep", " ", "only", " ", "200", " ", "elements"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "200"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fgr1", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"fgr1", ",", "200"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"flatfg2", "=", 
          RowBox[{"Subsets", "[", 
           RowBox[{"fgr1", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ingroupnbary", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"NormalizeBary", "[", 
                RowBox[{"bMidpoint", "[", 
                 RowBox[{
                  RowBox[{"ETCBaryNorm", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"ETCBaryNorm", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
               "-", "pt"}], "]"}], "&"}], ",", "flatfg2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hgroup", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"ingroupnbary", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}]}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hgroup", "]"}], ">", "0"}], ",", 
           RowBox[{"hgroups", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"hgroups", ",", 
              RowBox[{"Keys", "[", "hgroup", "]"}]}], "]"}]}]}], "]"}], ";"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"83275f8c-a3be-4d54-8212-7b9bf0d4d228"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenterCNy", "[", "key_", "]"}], ":=", 
   RowBox[{"evaluate", "[", 
    RowBox[{"symmetrizeInternal", "[", 
     RowBox[{
      RowBox[{"ETCFull", "[", "key", "]"}], "/.", "\[VeryThinSpace]", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "\[Rule]", "angleA"}], ",", 
         RowBox[{"B", "\[Rule]", "angleB"}], ",", 
         RowBox[{"C", "\[Rule]", "angleC"}]}], "}"}], "]"}]}], "]"}], "]"}]}],
   ";"}]], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"8be899e7-53f5-49b1-a9d2-301ac7f326c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linesProcessAlg", "[", 
    RowBox[{
    "ptcoord_", ",", "printexpr_", ",", "prec_", ",", "debug_", ",", " ", 
     "abort_", ",", " ", "name_", ",", 
     RowBox[{"quick_", ":", "False"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", "gr", ",", "hg", ",", "out", ",", "head", ",", " ", "test", 
       ",", "test2", ",", "hgroups", ",", "ptc", ",", "unproven", ",", "rc", 
       ",", "rc2", ",", "eltest", ",", "sout", ",", "barys", ",", "outname", 
       ",", "harm", ",", "ff2", ",", "outforsort"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Lines", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"rc2", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "ptcoord", "]"}], "/.", "rule69"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"intLinesProcessFullGroups", "[", 
        RowBox[{"ptc", ",", "prec", ",", "ETCBaryNorm"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gr", "=", 
       RowBox[{"res", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"unproven", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"debug", ",", 
           RowBox[{"PrintTemporary", "[", "el", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test", " ", "=", 
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"bCollinearityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
              RowBox[{"ptcoord", "/.", "rc"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "10", ",", "\[IndentingNewLine]", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"test2", " ", "=", 
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"bCollinearityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
              RowBox[{"ptcoord", "/.", "rc2"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "10", ",", "\[IndentingNewLine]", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], "]"}]}], 
           ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"out", ",", "el"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"unproven", ",", "el"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"el", ",", "gr"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"outname", "=", "\"\<(name pending)\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">=", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Sort", " ", "to", " ", "get", " ", "a", " ", "proposed", " ", 
          "point", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"outforsort", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"out", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<X\>\""}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<X\>\""}]}], " ", "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sout", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{"outforsort", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"xnumforsort", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "*", 
              RowBox[{"xnumforsort", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "sout", "]"}], ">=", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"outname", "=", 
             RowBox[{
              RowBox[{"intaddbrackets", "[", 
               RowBox[{
                RowBox[{"sout", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
              RowBox[{"intaddbrackets", "[", 
               RowBox[{
                RowBox[{"sout", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<\:2229\>\"",
               "<>", 
              RowBox[{"intaddbrackets", "[", 
               RowBox[{
                RowBox[{"sout", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
              RowBox[{"intaddbrackets", "[", 
               RowBox[{
                RowBox[{"sout", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<name\>\"", "\[Rule]", "outname"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"outname", "//", "colorformat"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"printexpr", ",", "S"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"barys", "=", 
         RowBox[{"ExpressionToTrad", "[", 
          RowBox[{"Activate", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Collect", "[", 
              RowBox[{"printexpr", ",", "S", ",", 
               RowBox[{"Inactive", "[", "Simplify", "]"}]}], "]"}], "/.", 
             RowBox[{"Simplify", "->", "intFullSimplifyFactors"}]}], ")"}]}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"barys", "=", 
         RowBox[{"intSimplifyFactorsToTrad", "[", "printexpr", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<barycentrics\>\"", "\[Rule]", "barys"}], "}"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Barycentrics    \>\"", "<>", "barys"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "out"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<lines\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"colorformat", "[", 
          RowBox[{"\"\<Lies on these lines: \>\"", "<>", " ", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Unproven Lines\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ToString", "[", "unproven", "]"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "stop", " ", "if", " ", "too", " ", "few", " ", "lines", " ", 
        "found"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"abort", " ", "&&", " ", 
         RowBox[{
          RowBox[{"Length", "[", "out", "]"}], "<", 
          "pointCheckerMinProperties"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"out", ",", " ", "Block"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "quick", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"checkLinearCombinations", "[", 
          RowBox[{"ptcoord", ",", "out", ",", "name"}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"harm", " ", "=", 
          RowBox[{"intHarmonicProcess", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"harm", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"SortBy", "[", 
              RowBox[{"#", ",", "Length"}], "]"}], "&"}], ",", "harm"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ff2", "[", "in_", "]"}], ":=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"in", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "}"}], "&"}], ",", 
            RowBox[{"Take", "[", 
             RowBox[{"in", ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"harm", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{"ff2", ",", "harm"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Format", " ", "harmonic", " ", "groups", " ", "List"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"bogus", " ", "groups", " ", "due", " ", "to", " ", "6"}],
             "-", "9", "-", 
            RowBox[{"13", " ", "metric", " ", "relations"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "igroup", "]"}], "!=", "2"}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sort", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"igroup", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{"igroup", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}], "!=", 
               RowBox[{"{", 
                RowBox[{"0", ",", "2"}], "}"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"head", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"igroup", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "==", "0"}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"el", "==", 
                  RowBox[{"head", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"eltest", " ", "=", " ", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"{", 
                  RowBox[{"el", ",", 
                   RowBox[{"head", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"test", " ", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                   RowBox[{"bHarmonicConjugate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
                    "]"}], ",", 
                   RowBox[{"ptcoord", "/.", "rc"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"test2", " ", "=", 
                RowBox[{"Det", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                   RowBox[{"bHarmonicConjugate", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
                    "]"}], ",", 
                   RowBox[{"ptcoord", "/.", "rc2"}]}], "}"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TrueQ", "[", 
                   RowBox[{
                    RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], 
                   "]"}], "&&", 
                  RowBox[{"TrueQ", "[", 
                   RowBox[{
                    RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], 
                   "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"el", ",", "igroup"}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"igroup", ",", "harm"}], "}"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{"hg", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
            "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{
           RowBox[{"globalProperties", "[", "name", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<harmonic\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{
                "\"\<= {X(i),X(j)}-harmonic conjugate of X(k) for these \
(i,j,k): \>\"", "<>", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Format", " ", "midpoints", " ", "groups", " ", "List"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"eltest", " ", "=", " ", "igroup"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test", " ", "=", " ", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"bMidpoint", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", 
                   RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", 
                   RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
                "]"}], ",", 
               RowBox[{"ptcoord", "/.", "rc"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test2", " ", "=", " ", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"bMidpoint", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", 
                   RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", 
                   RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
                "]"}], ",", 
               RowBox[{"ptcoord", "/.", "rc2"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test", "]"}], "==", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "&&", 
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test2", "]"}], "==", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
              " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"igroup", ",", 
             RowBox[{"intMidpointProcess", "[", 
              RowBox[{
               RowBox[{"res", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
              "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{"hg", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
            "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{
           RowBox[{"globalProperties", "[", "name", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<midpoints\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{
                "\"\<= midpoint of X(i) and X(j) for these {i,j}: \>\"", "<>", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Format", " ", "reflection", " ", "groups", " ", "List"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"eltest", " ", "=", " ", "igroup"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test", " ", "=", " ", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                RowBox[{"bReflectionPP", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
                 "]"}], ",", 
                RowBox[{"ptcoord", "/.", "rc"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test2", " ", "=", " ", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                RowBox[{"bReflectionPP", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
                 "]"}], ",", 
                RowBox[{"ptcoord", "/.", "rc2"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], 
                "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"igroup", ",", 
             RowBox[{"intReflectionProcess", "[", 
              RowBox[{
               RowBox[{"res", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
              "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{"hg", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"intnameformat", "[", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
            "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{
           RowBox[{"globalProperties", "[", "name", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<reflections\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{
                "\"\<= reflection of X(i) in X(j) for these {i,j}: \>\"", "<>", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"88798590-dcbe-4e1a-a851-954fbc2ef3de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCircles", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}], ",", 
     RowBox[{"prec_", ":", "24"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rc", ",", "rc2", ",", "d1", ",", "d2", ",", "d3", ",", "d4", ",", "d5",
        ",", "d6", ",", "etcset", ",", "distlist", ",", " ", "ptn", ",", " ", 
       "hg", ",", " ", "outgroups", ",", "  ", "fullgroups", ",", "as", ",", 
       " ", "out"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fullgroups", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"outgroups", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"etcset", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"ETCBaryNorm", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "#", "]"}], "!=", "0"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ptn", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", " ", "rule69"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"distlist", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ptname", ",", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bDistance", "[", 
               RowBox[{"ptn", ",", 
                RowBox[{"etcset", "[", "ptname", "]"}]}], "]"}], "/.", " ", 
              "rule69"}], ",", "prec"}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"ptname", ",", 
           RowBox[{"Keys", "[", "etcset", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"distlist", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"distlist", ",", 
         RowBox[{
          RowBox[{"Internal`RealValuedNumericQ", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"distlist", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"distlist", ",", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"as", "=", 
       RowBox[{"AssociationThread", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "distlist"}], "]"}], 
         ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "distlist"}], 
          "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fullgroups", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Values", "[", 
          RowBox[{"PositionIndex", "[", "as", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"outgroups", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"fullgroups", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#", "]"}], ">", "2"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"outgroups", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}], ",", 
            "3"}], "]"}], "&"}], ",", "outgroups"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"outgroups", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"outgroups", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hg", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"rc", "=", 
          RowBox[{"intCheckList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", 
         RowBox[{"rc2", "=", 
          RowBox[{"intCheckList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ptn", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"evaluate", "[", "pt", "]"}], "/.", " ", "rc"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"d1", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], 
                "]"}]}], "]"}], "/.", "rc"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d2", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}], 
                "]"}]}], "]"}], "/.", "rc"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d3", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc"}], 
                "]"}]}], "]"}], "/.", "rc"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ptn", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"evaluate", "[", "pt", "]"}], "/.", " ", "rc2"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"d4", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], 
                "]"}]}], "]"}], "/.", "rc2"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d5", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}], "]"}]
                }], "]"}], "/.", "rc2"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d6", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"bDistance", "[", 
              RowBox[{"ptn", ",", 
               RowBox[{"intnumericnorm", "[", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", 
                  RowBox[{"circ", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc2"}], 
                "]"}]}], "]"}], "/.", "rc2"}], ",", "prec"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"d1", ",", "d2"}], "}"}], ",", 
              RowBox[{
               RowBox[{"#", "==", "d3"}], "&"}]}], "]"}], "&&", 
            RowBox[{"AllTrue", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"d4", ",", "d5"}], "}"}], ",", 
              RowBox[{
               RowBox[{"#", "==", "d6"}], "&"}]}], "]"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"hg", ",", "circ"}], "]"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"circ", ",", "outgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hg", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "hg"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= center of circles {{ X(i), X(j), X(k) }} for these {i, j, \
k}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<circles\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hg", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"2b2c947e-2b60-4f5b-9e5a-79c86d844afd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"keyIntersectionValues", "[", 
    RowBox[{"list1_", ",", "list2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reverse", ",", "res", ",", "ress"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"reverse", "[", "assoc_", "]"}], ":=", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"Values", "[", "assoc", "]"}], "\[Rule]", 
         RowBox[{"Keys", "[", "assoc", "]"}]}], "]"}]}], ";", 
      RowBox[{"res", "=", 
       RowBox[{"KeyIntersection", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"reverse", "[", "list1", "]"}], ",", 
          RowBox[{"PositionIndex", "[", "list2", "]"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"ress", "=", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"First", "/@", 
           RowBox[{"Values", "[", 
            RowBox[{
            "res", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}]}], ",", 
          RowBox[{"Values", "[", 
           RowBox[{
           "res", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], "}"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Select", "[", 
        RowBox[{"ress", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=", 
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "&"}]}], "]"}], "*)"}], "\[IndentingNewLine]", "ress"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"b89c36fa-e002-4abb-b4df-43d460f64f24"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCircumconics", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"excl_", ":", "0"}], ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ptc", ",", "list1", ",", " ", "list2", ",", " ", "list3", ",", " ", 
       "list4", ",", "p1", ",", "p2", ",", "out", ",", "check", ",", 
       "bary20"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", " ", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Calculate", " ", "lines", " ", "though", " ", "isog", " ", 
        "conjugate", " ", "of", " ", "pt"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"list1", "=", 
       RowBox[{
        RowBox[{"intLinesProcessFullGroups", "[", 
         RowBox[{
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"bIsogonalConjugate", "[", "ptc", "]"}], "/.", "rule69"}],
            "]"}], ",", "24", ",", "ETCBaryNormFull"}], "]"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "For", " ", "each", " ", "line", " ", "calculate", " ", "barys", " ", 
        "of", " ", "isog", " ", "conjugate", " ", "of", " ", "ETC", " ", 
        "points", " ", "in", " ", "this", " ", "line"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"list2", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AssociationMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"intnumericnorm", "[", 
             RowBox[{
              RowBox[{"bIsogonalConjugate", "[", 
               RowBox[{"KimberlingCenterCNy", "[", "#1", "]"}], "]"}], "/.", 
              "rule69"}], "]"}], "&"}], ",", 
           RowBox[{
           "list1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", " ", ",", 
           RowBox[{"Length", "[", "list1", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "if", " ", "points", " ", "are", " ", "in", " ", "ETC"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"bary20", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", "0.0000000000000000001"}], "]"}], "&"}], ",", 
         "ETCBaryNormFull"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"list2", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Round", "[", 
              RowBox[{"#", ",", "0.0000000000000000001"}], "]"}], "&"}], ",", 
            "#"}], "]"}], "&"}], ",", "list2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"list3", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"keyIntersectionValues", "[", 
             RowBox[{"bary20", ",", "#"}], "]"}], "&"}], ",", "list2"}], 
          "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "#1", "]"}], ">", "1"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"output", " ", "only", " ", "two", " ", "points"}], ",", " ", 
        RowBox[{"with", " ", "smallest", " ", "numbers"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"list4", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Take", "[", 
             RowBox[{"#", ",", "2"}], "]"}], "&"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SortBy", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"numsortexpr", "[", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
              "&"}], ",", "list3"}], "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"list4", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"list4", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"p1", "=", 
            RowBox[{"cnc", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"p2", "=", 
            RowBox[{"cnc", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"p1", "==", "excl"}], "||", 
              RowBox[{"p2", "==", "excl"}]}], ",", " ", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"check", " ", "=", " ", 
            RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{"bCircumconicEq", "[", 
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", "p1", "]"}], ",", 
                  RowBox[{"KimberlingCenterCNy", "[", "p2", "]"}]}], "]"}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], 
                 "]"}]}], "]"}], "\[IndentingNewLine]", ",", "10", ",", 
              RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"check", "==", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"out", ",", 
                RowBox[{"\"\<{{A, B, C, \>\"", "<>", 
                 RowBox[{"intaddbrackets", "[", "p1", "]"}], "<>", 
                 "\"\<, \>\"", "<>", 
                 RowBox[{"intaddbrackets", "[", "p2", "]"}], "<>", 
                 "\"\<}}\>\""}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"cnc", ",", "list4"}], "}"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{"cnc", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{"cnc", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"p1", "==", "excl"}], "||", 
            RowBox[{"p2", "==", "excl"}]}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"check", " ", "=", " ", 
          RowBox[{"checkPointOnCurveNum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"bCircumconicEq", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterCNy", "[", "p1", "]"}], ",", 
              RowBox[{"KimberlingCenterCNy", "[", "p2", "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "pt"}], "\[IndentingNewLine]", "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
          RowBox[{"check", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"out", ",", 
              RowBox[{"\"\<{{A, B, C, \>\"", "<>", 
               RowBox[{"intaddbrackets", "[", "p1", "]"}], "<>", "\"\<, \>\"",
                "<>", 
               RowBox[{"intaddbrackets", "[", "p2", "]"}], "<>", 
               "\"\<}}\>\""}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
          ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"cnc", ",", "list4"}], "}"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssociateTo", "[", 
        RowBox[{
         RowBox[{"globalProperties", "[", "name", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<circumconics\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], 
       "//", "Quiet"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= intersection, other than A, B, C, of circumconics: \>\"", 
              "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[23]:=",ExpressionUUID->"df610716-6807-4170-8fa1-ec3c9df5ddd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkInconics", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"excl_", ":", "0"}], ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptc", ",", "out", ",", "crv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", " ", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"crv", " ", "=", " ", 
       RowBox[{
        RowBox[{"bInconicEq", "[", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v", ",", "w"}], "}"}], "]"}], "//", 
        "curveSimplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"set1", " ", "=", " ", 
       RowBox[{"Keys", "[", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Association", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"k", "->", "crv"}], "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptc"}], 
                "]"}]}], "/.", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
                RowBox[{"ETCBaryNorm", "[", "k", "]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", 
               RowBox[{"Keys", "[", "ETCBaryNormFull", "]"}]}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "#", "]"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "20"}]]}], "&"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"check", " ", "=", " ", 
          RowBox[{"checkPointOnCurveNum", "[", 
           RowBox[{
            RowBox[{"bInconicEq", "[", 
             RowBox[{"KimberlingCenterCNy", "[", "ptk", "]"}], "]"}], ",", 
            "pt"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{"check", ",", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"out", ",", 
              RowBox[{"intaddbrackets", "[", "ptk", "]"}]}], "]"}], ";"}]}], 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"ptk", ",", "set1"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<inconics\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= lies on inconics with perspector: \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"c0615c1e-389e-4fa6-a520-faeca5bb1121"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkPoles", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "prop", ",", "plr", ",", "set", ",", "fltset", ",", "outci",
        ",", "outin", ",", "conics"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"outci", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"outin", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"conics", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
        "fltCentralCircles", ",", "fltDuals", ",", " ", "fltOrthoptic"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", "globalCheckAllPoles", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"mon", "=", "circ"}], ";", "\[IndentingNewLine]", 
            RowBox[{"plr", "=", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"bPolar", "[", 
                RowBox[{
                 RowBox[{"conics", "[", "circ", "]"}], ",", "pt"}], "]"}], 
               ",", "5", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"plr", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"set", " ", "=", " ", 
             RowBox[{"checkPointsOnCurve", "[", 
              RowBox[{
               RowBox[{"evaluate", "[", "plr", "]"}], ".", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "set", "]"}], ">=", "2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fltset", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"intnameformat2", "[", "#", "]"}], "&"}], ",", 
                  RowBox[{"Take", "[", 
                   RowBox[{"set", ",", "2"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"prop", " ", "=", " ", 
                RowBox[{"\"\<= pole of line \>\"", "<>", 
                 RowBox[{"ToString", "[", "fltset", "]"}], "<>", 
                 "\"\< with respect to the \>\"", "<>", "circ"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"out", ",", "prop"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AssociateTo", "[", 
                RowBox[{
                 RowBox[{"globalProperties", "[", "name", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<poles\>\"", "\[Rule]", "out"}], "}"}]}], "]"}],
                ";", " ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "because", " ", "this", " ", "runs", " ", "inside", " ", 
                 RowBox[{"TimeConstrained", "[", "]"}]}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Not", "[", 
                  RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
                 RowBox[{"Print", "[", 
                  RowBox[{"colorformat", "[", "prop", "]"}], "]"}]}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"circ", ",", 
             RowBox[{"Keys", "[", "conics", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"globalCheckAllPoles", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"plr", "=", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"bPolar", "[", 
                RowBox[{
                 RowBox[{"fltCircumCircles", "[", "circ", "]"}], ",", "pt"}], 
                "]"}], ",", "5", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"plr", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"set", " ", "=", " ", 
             RowBox[{"checkPointsOnCurve", "[", 
              RowBox[{"plr", ".", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "set", "]"}], ">=", "2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fltset", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"intnameformat2", "[", "#", "]"}], "&"}], ",", 
                  RowBox[{"Take", "[", 
                   RowBox[{"set", ",", "2"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"outci", ",", 
                 RowBox[{"Join", "[", 
                  RowBox[{"fltset", ",", 
                   RowBox[{"{", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"intnameformat2", "[", "circ", "]"}], "]"}], 
                    "}"}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"circ", ",", 
             RowBox[{"Keys", "[", "fltCircumCircles", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "outci", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{
                "\"\<= pole of line X(i)X(j) wrt the circumconic with \
perspector X(k) for these {i,j,k}: \>\"", "<>", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"outci", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"plr", "=", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"bPolar", "[", 
                RowBox[{
                 RowBox[{"fltInCircles", "[", "circ", "]"}], ",", "pt"}], 
                "]"}], ",", "5", ",", 
               RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"plr", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"set", " ", "=", " ", 
             RowBox[{"checkPointsOnCurve", "[", 
              RowBox[{"plr", ".", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "set", "]"}], ">=", "2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fltset", "=", 
                RowBox[{"Map", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"intnameformat2", "[", "#", "]"}], "&"}], ",", 
                  RowBox[{"Take", "[", 
                   RowBox[{"set", ",", "2"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"outin", ",", 
                 RowBox[{"Join", "[", 
                  RowBox[{"fltset", ",", 
                   RowBox[{"{", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"intnameformat2", "[", "circ", "]"}], "]"}], 
                    "}"}]}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"circ", ",", 
             RowBox[{"Keys", "[", "fltInCircles", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "outin", "]"}], ">", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{
                "\"\<= pole of line X(i)X(j) wrt the inconic with perspector \
X(k) for these {i,j,k}: \>\"", "<>", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"outin", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}],
               ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<poles\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<polesin\>\"", "\[Rule]", "outin"}], "}"}]}], "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<polesci\>\"", "\[Rule]", "outci"}], "}"}]}], "]"}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"out", ",", "outci", ",", "outin"}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",ExpressionUUID->"6d04d363-\
bd98-4fd2-b2b6-de38da3520db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkIsogonalConjugates", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", ",", "idx2", 
       ",", "ptc", ",", "rc", ",", "ffisoconjugate", ",", "etcbary"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ffisoconjugate", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"bPIsogonalConjugate", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt1", "/.", "rule69"}], "]"}], ",", 
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt2", "/.", "rule69"}], "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"etcbary", "=", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{"ETCBaryNorm", ",", "globalExcludedNum"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ffisoconjugate", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "etcbary"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "etcbary"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&"}]}], 
          "]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "15"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"bPIsogonalConjugate", "[", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], ",", 
                   RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}], "]"}],
                  "/.", "rc"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"LexicographicOrder", "[", 
                  RowBox[{
                   RowBox[{"numsortexpr", "[", "idx1", "]"}], ",", 
                   RowBox[{"numsortexpr", "[", "idx2", "]"}]}], "]"}], "==", 
                 "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{
                RowBox[{"Print", "[", "idx1", "]"}], ";", 
                RowBox[{"Print", "[", "idx2", "]"}], ";"}]}], "*)"}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<isoconjugate\>\"", "\[Rule]", "res"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= X(i)-isoconjugate-of-X(j) for these {i, j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"a1d0dbe4-0639-4429-aad8-7d21f511e586"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkConjugates", "[", 
    RowBox[{"pt_", ",", "func_", ",", "str_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "res", ",", " ", "idx1", ",", "idx2", ",", "i1", ",", 
       "i2", ",", "ptc", ",", "rc", ",", "ff", ",", "fncname", ",", "tuples", 
       ",", " ", "etcbary"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"func", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt1", "/.", "rule69"}], "]"}], ",", 
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt2", "/.", "rule69"}], "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"etcbary", "=", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{"ETCBaryNorm", ",", "globalExcludedNum"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ff", "[", 
           RowBox[{"#", ",", "ptc"}], "]"}], "&"}], ",", "etcbary"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "etcbary"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", "0.00000000000000000001"}], "]"}], "&"}], ",", 
         "cx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Values", "[", 
            RowBox[{"PositionIndex", "[", "cx", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
              "\"\<C\>\""}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "==", 
              "\"\<C\>\""}]}], "||", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
              "\"\<C\>\""}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
              "\"\<C\>\""}]}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"idx1", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
             "\"\<C\>\""}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"idx2", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "==", 
             "\"\<C\>\""}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
            "\"\<C\>\""}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i1", ",", "i2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"idx1", ",", "idx2"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i1", ",", "i2"}], "}"}], "=", 
            RowBox[{"{", 
             RowBox[{"idx2", ",", "idx1"}], "}"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coincideNorm", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", " ", 
             RowBox[{
              RowBox[{"func", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", "i1", "]"}], "/.", 
                 "rc"}], ",", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", "i2", "]"}], "/.", 
                 "rc"}]}], "]"}], "/.", "rc"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"res", ",", 
              RowBox[{"{", 
               RowBox[{"i1", ",", "i2"}], "}"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tuples"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"fncname", ",", "HoldFirst"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fncname", "[", "x_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SymbolName", "[", 
          RowBox[{"Unevaluated", "@", "x"}], "]"}], ",", "x"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", 
            RowBox[{"fncname", "[", "func", "]"}], "]"}], "]"}], "\[Rule]", 
          "res"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"str", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"248d1785-f33b-47e2-912e-b1b776a4041a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkVertexConjugates", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", ",", "idx2", 
       ",", "ptc", ",", "rc", ",", "ffvertexconjugate", ",", "tuples"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ffvertexconjugate", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"bVertexConjugate", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", "pt1", "]"}], ",", 
              RowBox[{"intnumericnorm", "[", "pt2", "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ffvertexconjugate", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", "0.0000000000000000001"}], "]"}], "&"}], ",", 
         "cx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&&", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "==", "0"}], "&&", 
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], "==", "0"}]}], "&"}]}],
           "]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "15"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"bVertexConjugate", "[", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], ",", 
                   RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}], "]"}],
                  "/.", "rc"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"LexicographicOrder", "[", 
                  RowBox[{
                   RowBox[{"numsortexpr", "[", "idx1", "]"}], ",", 
                   RowBox[{"numsortexpr", "[", "idx2", "]"}]}], "]"}], "==", 
                 "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{
                RowBox[{"Print", "[", "idx1", "]"}], ";", 
                RowBox[{"Print", "[", "idx2", "]"}], ";"}]}], "*)"}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<vertex conjugate\>\"", "\[Rule]", "res"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= X(i)-vertex conjugate of X(j) for these {i, j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"a1358929-d20d-4668-b495-1e4bb285828e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkBarycentric", "[", 
    RowBox[{"pt_", ",", "type_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "ff", ",", "rc", ",", "cx", ",", " ", "res", ",", " ", "idx1", ",", 
       "idx2", ",", "ptc", ",", "val", ",", "sgn", ",", "tuples", ",", 
       "etcbary"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"type", "==", "\"\<quotient\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
         RowBox[{"intnumericnorm", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pt1", "/.", "rule69"}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"pt2", "/.", "rule69"}], ")"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ff", "[", 
          RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
         RowBox[{"intnumericnorm", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pt1", "/.", "rule69"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"pt2", "/.", "rule69"}], ")"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"etcbary", "=", 
       RowBox[{"KeyDrop", "[", 
        RowBox[{"ETCBaryNorm", ",", "globalExcludedNum"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ff", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "etcbary"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "etcbary"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"#", ",", "0.0000000000000000001"}], "]"}], "&"}], ",", 
         "cx"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tuples", "=", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Values", "[", 
            RowBox[{"PositionIndex", "[", "cx", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
              "\"\<C\>\""}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "==", 
              "\"\<C\>\""}]}], "||", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
              "\"\<C\>\""}], "&&", 
             RowBox[{
              RowBox[{"StringTake", "[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
              "\"\<C\>\""}]}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"idx1", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
             "\"\<C\>\""}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"idx2", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "==", 
             "\"\<C\>\""}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"i", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"i", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"type", "==", "\"\<quotient\>\""}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], "/.", 
                   "rc"}], ")"}], "/", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}], "/.", 
                   "rc"}], ")"}]}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"coincideNorm", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", 
                   " ", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}], "/.", 
                    "rc"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], "/.", 
                    "rc"}], ")"}]}]}], "]"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"res", ",", 
                   RowBox[{"{", 
                    RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"type", "==", "\"\<product\>\""}], " ", "&&", " ", 
            RowBox[{"coincideNorm", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}], "*", 
                 RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}]}], ")"}], "/.",
                "rc"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"LexicographicOrder", "[", 
                RowBox[{"idx1", ",", "idx2"}], "]"}], "==", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "tuples"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "==", "\"\<quotient\>\""}], ",", 
        RowBox[{"sgn", "=", "\"\</\>\""}], ",", 
        RowBox[{"sgn", "=", "\"\<*\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<barycentric \>\"", "<>", "type"}], "\[Rule]", "res"}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{
              "\"\<= barycentric \>\"", "<>", "type", "<>", "\"\< X(i)\>\"", "<>",
                "sgn", "<>", "\"\<X(j) for these (i, j): \>\"", "<>", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"4fafc852-071d-4fdc-8baa-8b0c276eb033"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkTrilinearPolar", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", "ptc", ",", "p1", ",", "p2", ",", "dset", ",", "test"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptc", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Normalize", "[", " ", 
          RowBox[{"pt", "/.", "rule69"}], "]"}], ",", "35"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{
        RowBox[{"bTripolarEq", "[", "ptc", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dset", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "cx", "]"}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], "]"}]}], 
         "&"}], "/@", "ETCBaryNorm"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"dset", ",", 
         RowBox[{
          RowBox[{"#", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "10"}]]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", " ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "test", "]"}], ">", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"p1", "=", 
          RowBox[{
           RowBox[{"Keys", "[", "test", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p2", "=", 
          RowBox[{
           RowBox[{"Keys", "[", "test", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "pt", ",", 
                RowBox[{"bTripole", "[", 
                 RowBox[{
                  RowBox[{"KimberlingCenterCNy", "[", "p1", "]"}], ",", 
                  RowBox[{"KimberlingCenterCNy", "[", "p2", "]"}]}], "]"}]}], 
               "}"}], "]"}], "\[IndentingNewLine]", "]"}], "==", "0"}], 
           "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AssociateTo", "[", 
             RowBox[{
              RowBox[{"globalProperties", "[", "name", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\"\<trilinear polar\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"p1", ",", "p2"}], "}"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{"\"\<= trilinear pole of line {\>\"", "<>", 
                 RowBox[{"intnameformat", "[", "p1", "]"}], "<>", 
                 "\"\<, \>\"", "<>", 
                 RowBox[{"intnameformat", "[", "p2", "]"}], "<>", 
                 "\"\<}\>\""}], " ", "]"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"c797be6b-9fe6-482b-8854-e3c92769d57d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCurves", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "ptest", ",", "ptest2", ",", "d", ",", "secondcheck", ",", 
       "crv", ",", "normcoef", ",", "curves", ",", "circset"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptest", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"curves", "=", "TriangleCurves"}], ";", "\[IndentingNewLine]", 
      RowBox[{"circset", "=", 
       RowBox[{"KeySelect", "[", 
        RowBox[{"CentralCircles", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<A-\>\""}], "]"}], "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<B-\>\""}], "]"}], "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<C-\>\""}], "]"}], "]"}], "&&", 
           "\[IndentingNewLine]", 
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<-A\>\""}], "]"}], "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<-B\>\""}], "]"}], "]"}], "&&", 
           RowBox[{"Not", "[", 
            RowBox[{"StringContainsQ", "[", 
             RowBox[{"#", ",", "\"\<-C\>\""}], "]"}], "]"}]}], 
          "\[IndentingNewLine]", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       
      RowBox[{"AppendTo", "[", 
       RowBox[{"curves", ",", "circset"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"curves", ",", "fltDuals"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"curves", ",", "fltOrthoptic"}], "]"}], ";", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"monitorvar", "=", "name"}], ";", "\[IndentingNewLine]", 
         RowBox[{"crv", "=", 
          RowBox[{
           RowBox[{"evaluate", "[", 
            RowBox[{"curves", "[", "name", "]"}], "]"}], "/.", "rule69"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"normcoef", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"CoefficientList", "[", 
              RowBox[{"crv", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "//", 
             "Abs"}], "//", "Flatten"}], "//", "Max"}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"normalize", " ", "big", " ", "numbers"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{
           FractionBox["crv", "normcoef"], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptest"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", "d", "]"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "12"}]]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"secondcheck", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ptest2", "=", 
                RowBox[{"N", "[", 
                 RowBox[{
                  RowBox[{"NormalizeBary", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pt", "//", "evaluate"}], ")"}], "/.", "rc"}], 
                   "]"}], ",", "35"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"d", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"curves", "[", "name", "]"}], "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
                    "ptest2"}], "]"}]}], "/.", "rc"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", "d", "]"}], ">", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "12"}]]}], ",", 
                 RowBox[{"secondcheck", " ", "=", "False"}]}], "]"}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"rc", ",", "intCheckList"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"secondcheck", ",", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"out", ",", "name"}], "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"name", ",", 
          RowBox[{"Keys", "[", "curves", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AssociateTo", "[", 
        RowBox[{
         RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<curves\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], "//", 
       "Quiet"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<= lies on curves: \>\"", "<>", " ", 
             RowBox[{"StringRiffle", "[", 
              RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",ExpressionUUID->"bc8e548f-5977-4ae6-ba39-\
bcb6fc3313a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkPerspector", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "ptcheck", ",", "crv", ",", "set1", ",", " ", "rc", ",", 
       "ptnamenew", ",", " ", "ptest"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crv", "=", 
       RowBox[{"bCircumconicPEq", "[", "pt", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"set1", " ", "=", " ", 
       RowBox[{"checkPointsOnCurve", "[", "crv", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"set1", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">=", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"out", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= perspector of circumconic {{A, B, C, \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}], "<>", 
              "\"\<}}\>\""}], "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<perspector\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"bed5d2ed-8f13-49c8-8176-4d241a211a68"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkConicCenter", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "ptest", ",", "ptcheck", ",", "crv", ",", "set1", ",", " ", 
       "rc", ",", "ptnamenew"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crv", "=", 
       RowBox[{"bCircumconicPEq", "[", 
        RowBox[{"pt", "*", 
         RowBox[{"bAntiComplement", "[", 
          RowBox[{
           RowBox[{"X", "[", "2", "]"}], ",", "pt"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"set1", " ", "=", " ", 
       RowBox[{"checkPointsOnCurve", "[", "crv", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"set1", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">=", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"out", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"\"\<= center of circumconic {{A, B, C, \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}], "<>", 
              "\"\<}}\>\""}], "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<conic center\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"ac874933-0226-46ca-af4d-7dd1ac8d9de6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkLinearCombinations", "[", 
    RowBox[{"pt_", ",", "ptpairset_", ",", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "pt1", ",", "pt2", ",", "summ", ",", "sol", ",", "coef", 
       ",", "numerator", ",", "denominator", ",", "p1", ",", "p2"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pt1", "=", 
          RowBox[{
           RowBox[{"KimberlingCenterC", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}],
               ",", 
              RowBox[{"pair", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"\"\<X\>\"", "<>", 
               RowBox[{"pair", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], "]"}], "//", 
           "evaluate"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"RationalExpressionQ", "[", 
             RowBox[{
              RowBox[{"pt1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pt1", "=", 
          RowBox[{"simplifyRationalBarycentrics", "[", "pt1", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"Total", "[", "pt1", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pt2", "=", 
          RowBox[{
           RowBox[{"KimberlingCenterC", "[", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}],
               ",", 
              RowBox[{"pair", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"\"\<X\>\"", "<>", 
               RowBox[{"pair", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "]"}], "//", 
           "evaluate"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"RationalExpressionQ", "[", 
             RowBox[{
              RowBox[{"pt2", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pt2", "=", 
          RowBox[{"simplifyRationalBarycentrics", "[", "pt2", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"Total", "[", "pt2", "]"}], "]"}], "==", "0"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"summ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox["pt1", 
              RowBox[{"Total", "[", "pt1", "]"}]], "t"}], "+", 
            FractionBox["pt2", 
             RowBox[{"Total", "[", "pt2", "]"}]]}], "//", 
           "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"TimeConstrained", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"summ", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "==", 
                 RowBox[{"k", " ", 
                  RowBox[{"pt", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "&&", 
                RowBox[{
                 RowBox[{"summ", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "==", 
                 RowBox[{"k", " ", 
                  RowBox[{"pt", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "t"}], "}"}]}], "]"}], "//", "Simplify"}], 
            ",", "5", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "sol", "]"}], ">", "0"}], " ", "&&", " ", 
            RowBox[{"NumberQ", "[", 
             RowBox[{"t", "/.", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"coef", "=", 
             RowBox[{"t", "/.", 
              RowBox[{"sol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pair", " ", "=", " ", 
             RowBox[{"ToString", "/@", "pair"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"p1", "=", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "<>", 
                "\"\<[\>\"", "<>", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", 
                "\"\<]\>\""}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"p1", "=", 
                RowBox[{"\"\<X[\>\"", "<>", 
                 RowBox[{"pair", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<]\>\""}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], ",", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}]}], "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"p2", "=", 
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "]"}], "<>", 
                "\"\<[\>\"", "<>", 
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{"pair", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", 
                "\"\<]\>\""}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"p2", "=", 
                RowBox[{"\"\<X[\>\"", "<>", 
                 RowBox[{"pair", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<]\>\""}]}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"numerator", " ", "=", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Numerator", "[", "coef", "]"}], "!=", "1"}], ",", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Numerator", "[", "coef", "]"}], "]"}], "<>", 
                "\"\<*\>\""}], ",", "\"\<\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"denominator", " ", "=", " ", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Denominator", "[", "coef", "]"}], "!=", "1"}], ",", 
               RowBox[{
                RowBox[{"ToString", "[", 
                 RowBox[{"Denominator", "[", "coef", "]"}], "]"}], "<>", 
                "\"\<*\>\""}], ",", "\"\<\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"out", ",", 
              RowBox[{
              "numerator", "<>", "p1", "<>", "\"\<+\>\"", "<>", "denominator",
                "<>", "p2"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "out", "]"}], ">=", "20"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], 
        RowBox[{"(*", " ", 
         RowBox[{"we", " ", 
          RowBox[{"don", "'"}], "t", " ", "need", " ", "all", " ", 
          "combinations", " ", "if", " ", "they", " ", "are", " ", "too", " ",
           "many"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"pair", ",", "ptpairset"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<linear combinations\>\"", "\[Rule]", "out"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"\"\<linear combinations: \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}]}], 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"0bc4dd98-f69e-41b3-afd8-148fcb1bbc9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkInverse", "[", 
    RowBox[{"pt_", ",", " ", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "out", ",", "ptest", ",", "circset", ",", "ptc", ",", "check", ",", 
       "secondcheck", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{
           RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}], "!=",
          "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"circset", "=", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"CentralCircles", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<A-\>\""}], "]"}], "]"}], "&&", 
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<B-\>\""}], "]"}], "]"}], "&&", 
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<C-\>\""}], "]"}], "]"}], "&&", 
              "\[IndentingNewLine]", 
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<-A\>\""}], "]"}], "]"}], "&&", 
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<-B\>\""}], "]"}], "]"}], "&&", 
              RowBox[{"Not", "[", 
               RowBox[{"StringContainsQ", "[", 
                RowBox[{"#", ",", "\"\<-C\>\""}], "]"}], "]"}]}], 
             "\[IndentingNewLine]", "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ptc", "=", 
             RowBox[{"bInverseInConic", "[", 
              RowBox[{"pt", ",", 
               RowBox[{"circset", "[", "cnc", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"check", "=", 
             RowBox[{"checkPointinETC2", "[", "ptc", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "check", "]"}], ">", "0"}], "&&", 
               RowBox[{
                RowBox[{"check", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "!=", 
                "globalExcludedNum"}]}], ",", "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"out", ",", 
                 RowBox[{"\"\<inverse of \>\"", "<>", 
                  RowBox[{"intaddbrackets", "[", 
                   RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
                  "\"\< in \>\"", "<>", "cnc"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"cnc", ",", 
             RowBox[{"Keys", "[", "circset", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<inverses\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"colorformat", "[", 
            RowBox[{"\"\<= \>\"", "<>", " ", "#"}], "]"}], "]"}], "&"}], "/@",
          "out"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[77]:=",ExpressionUUID->"fb05c096-2801-4b8e-91b5-a7cdfde1be05"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCentralExpression", "[", "ptc_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptn", ",", "symcheck", ",", "symcheck2", ",", "symcheck3"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptn", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "ptc", "]"}], "/.", " ", "rule69"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"symcheck", "=", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"ptn", ",", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"symmetrizeInternal2", "[", 
             RowBox[{"evaluate", "[", 
              RowBox[{"ptc", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "/.", " ", 
            "rule69"}], "]"}]}], "]"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"symcheck2", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"evaluate", "[", 
            RowBox[{"ptc", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], " ", "-", " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"evaluate", "[", 
              RowBox[{"ptc", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"b", " ", "->", " ", "c"}], ",", " ", 
                RowBox[{"c", " ", "->", " ", "b"}]}], "}"}], " ", "]"}]}], 
            ")"}], "]"}]}], "/.", " ", "rule69"}], "//", "Simplify"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"symcheck3", " ", "=", " ", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"ptn", ",", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"evaluate", "[", "ptc", "]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"a", "->", 
                 RowBox[{"2", "a"}]}], ",", 
                RowBox[{"b", "->", 
                 RowBox[{"2", "b"}]}], ",", 
                RowBox[{"c", "->", 
                 RowBox[{"2", "c"}]}]}], "}"}], "]"}]}], "/.", "rule69"}], 
           "]"}]}], "]"}], "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"symcheck", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "#", "]"}], ">", 
             SuperscriptBox["10", 
              RowBox[{"-", "20"}]]}], "&"}]}], "]"}], "||", 
         RowBox[{
          RowBox[{"Abs", "[", "symcheck2", "]"}], " ", ">", 
          SuperscriptBox["10", 
           RowBox[{"-", "20"}]]}], "||", 
         RowBox[{"AnyTrue", "[", 
          RowBox[{"symcheck3", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "#", "]"}], ">", 
             SuperscriptBox["10", 
              RowBox[{"-", "20"}]]}], "&"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "ptc", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "\"\<expression is not symmetric\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"52fcd3d2-0d79-43da-b241-368e2393301f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pointChecker", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"num_", ":", "0"}], ",", 
     RowBox[{"full_", ":", "False"}], ",", " ", 
     RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "abstime", ",", "ptcoord", ",", "pt", ",", "chk", ",", "lines", ",", 
       "barys", ",", "symcheck", ",", "name", ",", "numcon"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tmpsessiontime", "=", 
       RowBox[{"SessionTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"inname", "!=", "\"\<X\>\""}], "&&", 
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{"globalProperties", ",", "inname"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Key \>\"", "<>", "inname", "<>", 
           "\"\< exists in global properties !\>\""}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", " ", "Block"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"globalExcludedNum", "=", 
       RowBox[{"addxtoname", "[", "num", "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "this", " ", "point", " ", "will", " ", "dismissed", " ", "from", " ", 
        "calcs"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ptcoord", "=", 
       RowBox[{"expr", "//", "evaluate"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "symmetry"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"checkCentralExpression", "[", "ptcoord", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", " ", "Block"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pt", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", "ptcoord", "]"}], "/.", " ", "rule69"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Check", " ", "if", " ", "we", " ", "have", " ", "seen", " ", "the", 
        " ", "point", " ", "in", " ", "this", " ", 
        RowBox[{"session", ".", " ", "This"}], " ", "is", " ", "useful", " ", 
        "when", " ", "we", " ", "have", " ", "large", " ", "point", " ", 
        RowBox[{"checks", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"globalSeenPoints", "!=", "False"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "globalSeenPoints", "]"}], ">", "0"}], "&&", 
           RowBox[{
            RowBox[{"First", "@", 
             RowBox[{
              RowBox[{"MinimalBy", "[", "Value", "]"}], "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Abs", "[", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "pt"}], "]"}], "]"}],
                  "&"}], "/@", "globalSeenPoints"}], ")"}]}]}], "<=", 
            SuperscriptBox["10", 
             RowBox[{"-", "20"}]]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", "inname", "]"}], ";", 
           RowBox[{"Print", "[", "\"\<Point seen\>\"", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"False", ",", " ", "Block"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"globalSeenPoints", ",", 
             RowBox[{"{", 
              RowBox[{"ptcoord", ",", "pt"}], "}"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "ETC"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"num", "!=", "0"}], ",", 
        RowBox[{"chk", "=", "0"}], ",", 
        RowBox[{"chk", "=", 
         RowBox[{"checkPointinETC2", "[", "ptcoord", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "chk", "]"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"colorformat", "[", 
           RowBox[{"\"\<ETC: \>\"", "<>", "chk"}], "]"}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", " ", "Block"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"barys", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"FactorTermsList", "[", 
             RowBox[{"expr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "//", "Factor"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "inname", "]"}], "==", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"name", "=", 
            RowBox[{"ToString", "[", 
             RowBox[{"ExpressionToTrad", "[", 
              RowBox[{"expr", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"name", " ", "=", " ", "inname"}]}], "\[IndentingNewLine]",
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{"globalProperties", ",", 
           RowBox[{"name", "->", 
            RowBox[{"Association", "[", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"Print", "[", "\"\<Starting...\>\"", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"lines", "=", 
          RowBox[{
           RowBox[{"linesProcessAlg", "[", 
            RowBox[{
            "ptcoord", ",", "barys", ",", "20", ",", "False", ",", "True", 
             ",", "name"}], "]"}], "//", "Quiet"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"printSessionTime", "[", "]"}], ";", 
            RowBox[{"Print", "[", "\"\<Starting circumconics\>\"", "]"}], 
            ";"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"full", " ", "||", " ", 
            RowBox[{
             RowBox[{"Length", "[", "lines", "]"}], ">=", 
             "pointCheckerMinProperties"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"numcon", " ", "=", " ", 
             RowBox[{
              RowBox[{"checkCircumconics", "[", 
               RowBox[{"ptcoord", ",", "num", ",", "name"}], "]"}], "//", 
              "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting curves\>\"", "]"}], 
               ";"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkCurves", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting inverse\>\"", "]"}], 
               ";"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkInverse", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting trilinear\>\"", "]"}], 
               ";"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkTrilinearPolar", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting conjugates\>\"", "]"}], 
               ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkIsogonalConjugates", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConjugates", "[", 
              RowBox[{
              "ptcoord", ",", "bDaoConjugate", ",", 
               "\"\<= X(i)-Dao conjugate of X(j) for these {i, j}: \>\"", ",",
                "name"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConjugates", "[", 
              RowBox[{
              "ptcoord", ",", "bCevianQuotient", ",", 
               "\"\<= X(i)-Ceva conjugate of X(j) for these {i, j}: \>\"", 
               ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConjugates", "[", 
              RowBox[{
              "ptcoord", ",", "bAnticomplementaryConjugate", ",", 
               "\"\<= X(i)-anticomplementary conjugate of X(j) for these {i, \
j}: \>\"", ",", "name"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConjugates", "[", 
              RowBox[{
              "ptcoord", ",", "bComplementaryConjugate", ",", 
               "\"\<= X(i)-complementary conjugate of X(j) for these {i, j}: \
\>\"", ",", "name"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConjugates", "[", 
              RowBox[{
              "ptcoord", ",", "bCrossConjugate", ",", 
               "\"\<= X(i)-cross conjugate of X(j) for these {i, j}: \>\"", 
               ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkVertexConjugates", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting circles\>\"", "]"}], 
               ";"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkCircles", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkInconics", "[", 
              RowBox[{"ptcoord", ",", "num", ",", "name"}], "]"}], "//", 
             "Quiet"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting poles\>\"", "]"}], ";"}]}],
              " ", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"TimeConstrained", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"checkPoles", "[", 
                RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ",",
               "180"}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting conic centers\>\"", "]"}], 
               ";"}]}], " ", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkPerspector", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkConicCenter", "[", 
              RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting baricentrics\>\"", "]"}], 
               ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkBarycentric", "[", 
              RowBox[{"ptcoord", ",", "\"\<product\>\"", ",", " ", "name"}], 
              "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"checkBarycentric", "[", 
              RowBox[{"ptcoord", ",", "\"\<quotient\>\"", ",", " ", "name"}], 
              "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{"printSessionTime", "[", "]"}], ";", 
               RowBox[{"Print", "[", "\"\<Starting processes\>\"", "]"}], 
               ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"TimeConstrained", "[", 
             RowBox[{
              RowBox[{"Quiet", "[", 
               RowBox[{"pointCheckAllProcesses", "[", 
                RowBox[{"ptcoord", ",", "name"}], "]"}], "]"}], ",", "90"}], 
             "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{"Print", "[", "\"\<===========\>\"", "]"}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",ExpressionUUID->"b0c868e7-77ab-45f4-9f01-\
be0e5db4fd5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"quickChecker", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"num_", ":", "0"}], ",", 
     RowBox[{"curvescheck_", ":", "True"}], ",", " ", 
     RowBox[{"dosymcheck_", ":", "True"}], ",", 
     RowBox[{"minprop_", ":", "1000"}], ",", 
     RowBox[{"countcutoff_", ":", 
      SuperscriptBox["10", "8"]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ptcoord", ",", "pt", ",", "chk", ",", "lines", ",", "barys", ",", 
       "symcheck", ",", "name", ",", "numcon"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptcoord", "=", 
       RowBox[{"expr", "//", "evaluate"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"lines", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"numcon", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "symmetry"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"dosymcheck", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"checkCentralExpression", "[", "expr", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{"False", ",", " ", "Block"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "ETC"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"num", "!=", "0"}], ",", 
        RowBox[{"chk", "=", "0"}], ",", 
        RowBox[{"chk", "=", 
         RowBox[{"checkPointinETC2", "[", "ptcoord", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "chk", "]"}], ">", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"colorformat", "[", 
          RowBox[{"\"\<ETC: \>\"", "<>", "chk"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pt", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{"ptcoord", "/.", " ", "rule69"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Check", " ", "if", " ", "we", " ", "have", " ", "seen", " ", "the",
            " ", "point", " ", "in", " ", "this", " ", 
           RowBox[{"session", ".", " ", "This"}], " ", "is", " ", "useful", 
           " ", "when", " ", "we", " ", "have", " ", "large", " ", "point", 
           " ", 
           RowBox[{"checks", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"globalSeenPoints", "!=", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "globalSeenPoints", "]"}], ">", "0"}], "&&", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{
                 RowBox[{"MinimalBy", "[", "Value", "]"}], "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "pt"}], "]"}], "]"}],
                     "&"}], "/@", "globalSeenPoints"}], ")"}]}]}], "<=", 
               SuperscriptBox["10", 
                RowBox[{"-", "20"}]]}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", "\"\<Point seen !\>\"", "]"}], ";", 
              RowBox[{"Return", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", " ", "Block"}], "]"}]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"globalSeenPoints", ",", 
                RowBox[{"{", 
                 RowBox[{"ptcoord", ",", "pt"}], "}"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}], "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"barys", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"FactorTermsList", "[", 
             RowBox[{"expr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "//", "Factor"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lineset", "=", 
          RowBox[{
           RowBox[{"linesProcessAlg", "[", 
            RowBox[{
            "ptcoord", ",", "barys", ",", "20", ",", "False", ",", "True", 
             ",", "\"\<X\>\"", ",", "True"}], "]"}], "//", "Quiet"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Count", " ", "only", " ", "lines", " ", "up", " ", "to", " ", "a", 
           " ", "certian", " ", "point"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lines", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"lineset", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{"ToExpression", "[", "#", "]"}], "]"}], "<", 
               "countcutoff"}], "&"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"curvescheck", "&&", 
            RowBox[{"lines", "<", "minprop"}]}], ",", 
           RowBox[{"numcon", " ", "=", " ", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"checkCircumconics", "[", 
               RowBox[{"ptcoord", ",", "num", ",", "name"}], "]"}], "//", 
              "Quiet"}], "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"lines", ",", "numcon", ",", 
         RowBox[{"Length", "[", "lineset", "]"}]}], "}"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"a7b08756-0b30-4d61-9399-d90bc975de49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointCheckerTransform", "[", 
     RowBox[{"expr_", ",", "inname_", ",", 
      RowBox[{"num_", ":", "0"}], ",", " ", 
      RowBox[{"full_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pointProcesses", ",", "texpr", ",", "procname"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "main", " ", "point"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "]"}], ";", 
          RowBox[{"Print", "[", "inname", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pointChecker", "[", 
        RowBox[{"expr", ",", "num", ",", "full", ",", "inname"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], ",", 
         RowBox[{"printGlobalProperties", "[", 
          RowBox[{"globalProperties", ",", "inname"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "transformations", " ", "of", " ", "main", " ", 
         "point"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pointProcesses", "=", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<isotomic conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsotomicConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<isogonal conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsogonalConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<complement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<anticomplement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bAntiComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<cyclocevian conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCyclocevianConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<circumcircle inverse\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCircumcircleInverse", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<zosma transform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bZosmaTransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<polar conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bPIsogonalConjugate", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterCN", "[", "48", "]"}], ",", "#"}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<eigentransform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bEigentransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPsi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPsi", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPhi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPhi", "[", "#", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"texpr", "=", 
           RowBox[{"simplifyRationalBarycentrics", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ReleaseHold", "[", 
                RowBox[{
                 RowBox[{"pointProcesses", "[", "name", "]"}], "/.", 
                 RowBox[{"#", "->", "expr"}]}], "]"}], "//", "evaluate"}], "//",
               "Together"}], "//", "Factor"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"heuristicsCheck", "[", 
             RowBox[{"texpr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"procname", " ", "=", " ", 
              RowBox[{"name", "<>", "\"\< of \>\"", "<>", "inname"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
               RowBox[{"Print", "[", "procname", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pointChecker", "[", 
              RowBox[{"texpr", ",", "0", ",", "full", ",", "procname"}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], ",", 
               RowBox[{"printGlobalProperties", "[", 
                RowBox[{"globalProperties", ",", "procname"}], "]"}]}], "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "pointProcesses", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"34e0d12b-8113-4dd3-9ab5-6c2b35676c93"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"quickCheckerTransform", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"inname_", ":", "\"\<PTX\>\""}], ",", 
      RowBox[{"num_", ":", "0"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pointProcesses", ",", "texpr", ",", "procname"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "main", " ", "point"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
         RowBox[{"Print", "[", "inname", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"quickChecker", "[", 
        RowBox[{"expr", ",", "num", ",", "True"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "transformations", " ", "of", " ", "main", " ", 
         "point"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pointProcesses", "=", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<isotomic conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsotomicConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<isogonal conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsogonalConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<complement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<anticomplement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bAntiComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<cyclocevian conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCyclocevianConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<circumcircle inverse\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCircumcircleInverse", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<zosma transform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bZosmaTransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<polar conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bPIsogonalConjugate", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterCN", "[", "48", "]"}], ",", "#"}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<eigentransform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bEigentransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPsi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPsi", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPhi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPhi", "[", "#", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"texpr", "=", 
           RowBox[{"simplifyRationalBarycentrics", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ReleaseHold", "[", 
                RowBox[{
                 RowBox[{"pointProcesses", "[", "name", "]"}], "/.", 
                 RowBox[{"#", "->", "expr"}]}], "]"}], "//", "evaluate"}], "//",
               "Together"}], "//", "Factor"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"procname", " ", "=", " ", 
           RowBox[{"name", "<>", "\"\< of \>\"", "<>", "inname"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
            RowBox[{"Print", "[", "procname", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"quickChecker", "[", 
           RowBox[{"texpr", ",", "0", ",", "True"}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "pointProcesses", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"67c4165d-9e85-4194-b1ff-2033719e92db"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"printGlobalProperties", "[", 
    RowBox[{"glob_", ",", 
     RowBox[{"name_", ":", "\"\<\>\""}], ",", 
     RowBox[{"printname_", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hg", ",", "cycle", ",", "localprops", ",", "colorprint"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "name", "]"}], ">", "0"}], ",", 
        RowBox[{"cycle", "=", 
         RowBox[{"{", "name", "}"}]}], ",", 
        RowBox[{"cycle", "=", 
         RowBox[{"Keys", "[", "glob", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colorprint", " ", "=", " ", "colorPrintOn"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"colorPrintOn", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"print", "[", 
          RowBox[{"printname", "<>", "\"\< = \>\"", "<>", 
           RowBox[{
            RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<name\>\"", "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"print", "[", 
          RowBox[{"\"\<Barycentrics    \>\"", "<>", 
           RowBox[{
            RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<barycentrics\>\"", 
            "]"}]}], "]"}], ";", " ", 
         RowBox[{"print", "[", "]"}], ";", 
         RowBox[{"print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", "\"\<descr\>\""}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"print", "[", "\[IndentingNewLine]", 
             RowBox[{"\"\<DESCR: \>\"", "<>", 
              RowBox[{"StringReplace", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<descr\>\"", 
                 "]"}], ",", 
                RowBox[{"\"\<This point\>\"", "->", "printname"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"print", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"Keys", "[", 
                RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
               "\"\<linear combinations\>\""}], "]"}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{
             RowBox[{"glob", "[", "pt", "]"}], "[", 
             "\"\<linear combinations\>\"", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{
              "printname", "<>", "\"\< linear combinations: \>\"", "<>", " ", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";", 
            RowBox[{"print", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"print", "[", 
          RowBox[{"colorformat", "[", 
           RowBox[{
           "printname", "<>", "\"\< lies on these lines: \>\"", "<>", " ", 
            RowBox[{"StringRiffle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<lines\>\"", "]"}], 
              ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";", 
         RowBox[{"print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
             "\"\<midpoints\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<midpoints\>\"", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "printname", "<>", 
                  "\"\< = midpoint of X(i) and X(j) for these {i,j}: \>\"", "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
             "\"\<reflections\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<reflections\>\"", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "printname", "<>", 
                  "\"\< = reflection of X(i) in X(j) for these {i,j}: \>\"", "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", " ", "this", " ", "is", " ", "not", " ", "present"}],
            ",", " ", 
           RowBox[{
           "this", " ", "point", " ", "is", " ", "not", " ", "calculated", 
            " ", "due", " ", "to", " ", "too", " ", "few", " ", 
            RowBox[{"lines", ".", "\[IndentingNewLine]", "Print"}], " ", 
            "harmonic", " ", "conjugates"}], ",", " ", 
           RowBox[{
           "which", " ", "must", " ", "be", " ", "last", " ", "and", " ", 
            "exit", " ", 
            RowBox[{"loop", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Keys", "[", 
               RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
              "\"\<circumconics\>\""}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Keys", "[", 
                 RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
                "\"\<harmonic\>\""}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"hg", " ", "=", " ", 
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<harmonic\>\"", 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"print", "[", 
                   RowBox[{"colorformat", "[", 
                    RowBox[{
                    "printname", "<>", 
                    "\"\< = {X(i),X(j)}-harmonic conjugate of X(k) for these \
(i,j,k): \>\"", "<>", 
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{"hg", ",", 
                    RowBox[{
                    RowBox[{"numsortexpr", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
                    ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<curves\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"printname", "<>", "\"\< lies on these curves: \>\"", "<>", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<inverses\>\"", "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"print", "[", 
               RowBox[{"colorformat", "[", 
                RowBox[{"printname", "<>", "\"\< = \>\"", "<>", " ", "#"}], 
                "]"}], "]"}], "&"}], "/@", "hg"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{"glob", "[", "pt", "]"}], ",", "proc"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "printname", "<>", "\"\< = \>\"", "<>", " ", "proc", "<>", 
                  "\"\< of \>\"", "<>", 
                  RowBox[{
                   RowBox[{"glob", "[", "pt", "]"}], "[", "proc", "]"}]}], 
                 "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"proc", ",", 
             RowBox[{"Keys", "[", "singlePointProcesses", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{
             RowBox[{"glob", "[", "pt", "]"}], ",", 
             "\"\<trilinear polar\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", 
              "\"\<trilinear polar\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
               RowBox[{
                RowBox[{"Length", "[", "hg", "]"}], ">", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "printname", "<>", "\"\< = trilinear pole of line {\>\"", "<>", 
                  RowBox[{"intnameformat", "[", 
                   RowBox[{"hg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<, \>\"",
                   "<>", 
                  RowBox[{"intnameformat", "[", 
                   RowBox[{"hg", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
                  "\"\<}\>\""}], " ", "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<perspector\>\"", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "hg", "]"}], ">=", "2"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"printname", ",", 
                RowBox[{
                "\"\< = perspector of circumconic {{A, B, C, \>\"", "<>", " ", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"hg", ",", "\"\<, \>\""}], "]"}], "<>", 
                 "\"\<}}\>\""}]}], "]"}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<conic center\>\"", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
            RowBox[{
             RowBox[{"Length", "[", "hg", "]"}], ">=", "2"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"printname", ",", 
                RowBox[{
                "\"\< = center of circumconic {{A, B, C, \>\"", "<>", " ", 
                 RowBox[{"StringRiffle", "[", 
                  RowBox[{"hg", ",", "\"\<, \>\""}], "]"}], "<>", 
                 "\"\<}}\>\""}]}], "]"}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"localprops", "=", 
          RowBox[{"Association", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "\"\<isoconjugate\>\"", "->", 
             "\"\<= X(i)-isoconjugate-of-X(j) for these {i, j}: \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<vertex conjugate\>\"", "->", 
             "\"\<= X(i)-vertex conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bDaoConjugate\>\"", "->", 
             "\"\<= X(i)-Dao conjugate of X(j) for these {i, j}: \>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bCevianQuotient\>\"", "->", 
             "\"\<= X(i)-Ceva conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bComplementaryConjugate\>\"", "->", 
             "\"\<= X(i)-complementary conjugate of X(j) for these {i, j}: \>\
\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bAnticomplementaryConjugate\>\"", "->", 
             "\"\<= X(i)-anticomplementary conjugate of X(j) for these {i, \
j}: \>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bCrossConjugate\>\"", "->", 
             "\"\<= X(i)-cross conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<poles\>\"", "->", "\"\< = \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<others\>\"", "->", "\"\< = \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<circles\>\"", "->", "\"\< = \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<inconics\>\"", "->", 
             "\"\<= lies on inconics with perspector: \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<circumconics\>\"", "->", 
             "\"\<= intersection, other than A, B, C, of circumconics \>\""}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<barycentric product\>\"", "->", 
             "\"\<= barycentric product X(i)*X(j) for these (i, j): \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<barycentric quotient\>\"", "->", 
             "\"\<= barycentric quotient X(i)/X(j) for these (i, j): \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<harmonic\>\"", "->", 
             "\"\<= {X(i),X(j)}-harmonic conjugate of X(k) for these (i,j,k): \
\>\""}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "name2", "]"}]}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
               RowBox[{
                RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], " ", "&&", 
               " ", 
               RowBox[{"name2", "!=", "\"\<others\>\""}], "&&", " ", 
               RowBox[{"name2", "!=", "\"\<poles\>\""}], "&&", " ", 
               RowBox[{"name2", "!=", "\"\<circles\>\""}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{"printname", "<>", "\"\< \>\"", "<>", 
                  RowBox[{"localprops", "[", "name2", "]"}], "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"name2", "==", "\"\<poles\>\""}], " ", ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
                  RowBox[{
                   RowBox[{"Length", "[", "hg", "]"}], ">", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Do", "[", 
                   RowBox[{
                    RowBox[{"print", "[", 
                    RowBox[{"colorformat", "[", 
                    RowBox[{"printname", "<>", "\"\< \>\"", "<>", "prop"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"prop", ",", " ", "hg"}], "}"}]}], "]"}], ";"}]}],
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"hg", " ", "=", " ", 
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<polesci\>\"", 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
                  RowBox[{
                   RowBox[{"Length", "[", "hg", "]"}], ">", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"print", "[", 
                   RowBox[{"colorformat", "[", 
                    RowBox[{
                    "printname", "<>", 
                    "\"\< = pole of line X(i)X(j) wrt the circumconic with \
perspector X(k) for these {i,j,k}: \>\"", "<>", 
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"hg", " ", "=", " ", 
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<polesin\>\"", 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
                  RowBox[{
                   RowBox[{"Length", "[", "hg", "]"}], ">", "0"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"print", "[", 
                   RowBox[{"colorformat", "[", 
                    RowBox[{
                    "printname", "<>", 
                    
                    "\"\< = pole of line X(i)X(j) wrt the inconic with \
perspector X(k) for these {i,j,k}: \>\"", "<>", 
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
               RowBox[{
                RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], " ", "&&", 
               " ", 
               RowBox[{"name2", "==", "\"\<circles\>\""}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "printname", "<>", 
                  "\"\< = center of circles {{ X(i), X(j), X(k) }} for these \
{i, j, k}: \>\"", "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ListQ", "[", "hg", "]"}], "&&", 
               RowBox[{
                RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], " ", "&&", 
               " ", 
               RowBox[{"name2", "==", "\"\<others\>\""}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", 
               RowBox[{
                RowBox[{"print", "[", 
                 RowBox[{"colorformat", "[", 
                  RowBox[{"printname", "<>", 
                   RowBox[{"localprops", "[", "name2", "]"}], "<>", "prop"}], 
                  "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"prop", ",", " ", "hg"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"name2", ",", 
             RowBox[{"Keys", "[", "localprops", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"pt", ",", " ", "cycle"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"colorPrintOn", " ", "=", " ", "colorprint"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"d3bc0e6f-728d-432e-9704-a9cc59a0a8a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addExtraPoint", "[", 
    RowBox[{"bary_", ",", "letter_", ",", "name_", ",", 
     RowBox[{"writeout_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"expr", ",", "pt", ",", "idxmax", ",", "dbname"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           StyleBox[
            RowBox[{"{", 
             RowBox[{"\"\<Y\>\"", ",", "\"\<Z\>\""}], "}"}], 
            "OperatorCharacter"], 
           StyleBox[",", "OperatorCharacter"], "letter"}], 
          StyleBox["]", "OperatorCharacter"]}], 
         StyleBox["]", "OperatorCharacter"]}], 
        StyleBox[",", "OperatorCharacter"], 
        RowBox[{
         StyleBox[
          RowBox[{"Print", "[", "\"\<Invalid letter\>\"", "]"}], 
          "OperatorCharacter"], 
         StyleBox[";", "OperatorCharacter"], 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", "Module"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"name", "!=", "\"\<unnamed\>\""}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"Values", "[", "NonETCNames", "]"}], ",", "name"}], 
          "]"}]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Name exists !\>\"", "]"}], 
         StyleBox[";", "OperatorCharacter"], 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", "Module"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"VectorQ", "[", "bary", "]"}], ",", 
        RowBox[{"expr", "=", 
         RowBox[{"bary", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
        RowBox[{"expr", "=", "bary"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"idxmax", "=", 
       RowBox[{
        RowBox[{"1", "+", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{
              RowBox[{"Keys", "[", 
               RowBox[{"KeySelect", "[", 
                RowBox[{"ETCExtra", ",", 
                 RowBox[{
                  RowBox[{"StringStartsQ", "[", 
                   RowBox[{"#", ",", "letter"}], "]"}], "&"}]}], "]"}], "]"}],
               ",", 
              RowBox[{
               RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "//", "Max"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"dbname", " ", "=", " ", 
       RowBox[{"letter", "<>", 
        RowBox[{"ToString", "[", "idxmax", "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pt", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{
         RowBox[{"evaluate", "[", 
          RowBox[{"symmetrizeInternal2", "[", "expr", "]"}], "]"}], "/.", " ",
          "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETCBaryNorm", ",", 
        RowBox[{"dbname", "->", "pt"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETCExtraBary", ",", 
        RowBox[{"dbname", "->", "pt"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETCBaryNormFull", ",", 
        RowBox[{"dbname", "->", "pt"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETC", ",", 
        RowBox[{"dbname", "->", "expr"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETCFull", ",", 
        RowBox[{"dbname", "->", "expr"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"ETCExtra", ",", 
        RowBox[{"dbname", "->", "expr"}]}], "]"}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"NonETCNames", ",", 
        RowBox[{"dbname", "->", "name"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"writeout", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"DumpSave", "[", 
          RowBox[{"\"\<ETCExtra.mx\>\"", ",", "ETCExtra"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"DumpSave", "[", 
          RowBox[{"\"\<ETCExtraBary.mx\>\"", ",", "ETCExtraBary"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"DumpSave", "[", 
          RowBox[{"\"\<NonETCNames.mx\>\"", ",", "NonETCNames"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "dbname", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"e0d7722e-3b09-42ca-bc49-659bf901b269"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<DBTools.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<DBTools.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "pointProcessBary", ",", "singlePointProcesses", ",", 
      "intHarmonicProcess", ",", " ", "intPointCheck", ",", " ", 
      "pointCheckAllProcesses", ",", "checkCircumconics", ",", 
      "checkInconics", ",", "linesProcessAlg", ",", "checkIsogonalConjugates",
       ",", "checkBarycentric", ",", " ", "xnum", ",", " ", "xnumforsort", 
      ",", " ", "coincide", ",", " ", "intReflectionProcess", ",", " ", 
      "intMidpointProcess", ",", "checkTrilinearPolar", ",", 
      "checkVertexConjugates", ",", "pointChecker", ",", 
      "pointCheckerTransform", ",", "globalSeenPoints", ",", 
      "globalProperties", ",", "globalCheckAllPoles", ",", "checkCurves", ",",
       "printGlobalProperties", ",", "checkPerspector", ",", "intCheckList", 
      ",", "intVerifyPointProcess", ",", "coincideNorm", ",", " ", 
      "checkConjugates", ",", "KimberlingCenterCNy", ",", "intaddbrackets", 
      ",", "intnameformat", ",", "intnumericnorm", ",", "colorformat", ",", 
      "intmark", ",", "keyIntersectionValues", ",", "addExtraPoint", ",", 
      "cleanup", ",", "globalOutputStream", ",", "globalNoCleanup", ",", 
      "checkConicCenter", ",", " ", "quickChecker", ",", 
      "checkLinearCombinations", ",", "addxtoname", ",", "intnameformat2", 
      ",", "checkPoles", ",", "checkCentralExpression", ",", 
      "printSessionTime", ",", "tmpsessiontime", ",", 
      "quickCheckerTransform"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[85]:=",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
},
WindowSize->{1141.2, 568.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
DockedCells->{},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
   StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"63c0da91-286a-436c-a7b8-b49fac5d8617"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 624, 11, 28, "Input",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],
Cell[1185, 33, 730, 17, 143, "Input",ExpressionUUID->"61f6f64d-63ef-4439-a691-6cde886d252c"],
Cell[1918, 52, 11619, 333, 917, "Input",ExpressionUUID->"b80a96f9-c842-4ef8-9bf5-1d19f4841581"],
Cell[13540, 387, 1722, 43, 219, "Input",ExpressionUUID->"883898fa-539b-4557-b0b3-a234b6adc26c"],
Cell[15265, 432, 3843, 95, 485, "Input",ExpressionUUID->"74111645-2b56-4fda-8b77-c132e8d1be4b"],
Cell[19111, 529, 1943, 48, 238, "Input",ExpressionUUID->"26d5a62e-503c-4018-a856-34e31e5b398f"],
Cell[21057, 579, 1866, 48, 219, "Input",ExpressionUUID->"c39b8072-918d-4251-8a15-74a2adcadfbe"],
Cell[22926, 629, 2179, 51, 238, "Input",ExpressionUUID->"138afecd-e9f2-4f46-90cb-79229dc0c3d6"],
Cell[25108, 682, 7264, 200, 349, "Input",ExpressionUUID->"6b44296a-dc56-44c3-981b-023a39cb076c"],
Cell[32375, 884, 10005, 249, 999, "Input",ExpressionUUID->"51aa5bfe-e1a6-46b3-93f3-4a939e2f11f3"],
Cell[42383, 1135, 3447, 83, 447, "Input",ExpressionUUID->"bca15176-ab78-40f6-ad1d-3f9d33e84dcf"],
Cell[45833, 1220, 3933, 95, 403, "Input",ExpressionUUID->"83275f8c-a3be-4d54-8212-7b9bf0d4d228"],
Cell[49769, 1317, 597, 15, 28, "Input",ExpressionUUID->"8be899e7-53f5-49b1-a9d2-301ac7f326c4"],
Cell[50369, 1334, 30793, 717, 2540, "Input",ExpressionUUID->"88798590-dcbe-4e1a-a851-954fbc2ef3de"],
Cell[81165, 2053, 10912, 279, 828, "Input",ExpressionUUID->"2b2c947e-2b60-4f5b-9e5a-79c86d844afd"],
Cell[92080, 2334, 1761, 47, 143, "Input",ExpressionUUID->"b89c36fa-e002-4abb-b4df-43d460f64f24"],
Cell[93844, 2383, 10630, 255, 1113, "Input",ExpressionUUID->"df610716-6807-4170-8fa1-ec3c9df5ddd3"],
Cell[104477, 2640, 4001, 101, 400, "Input",ExpressionUUID->"c0615c1e-389e-4fa6-a520-faeca5bb1121"],
Cell[108481, 2743, 11369, 266, 1113, "Input",ExpressionUUID->"6d04d363-bd98-4fd2-b2b6-de38da3520db"],
Cell[119853, 3011, 10640, 264, 828, "Input",ExpressionUUID->"a1d0dbe4-0639-4429-aad8-7d21f511e586"],
Cell[130496, 3277, 9879, 257, 676, "Input",ExpressionUUID->"248d1785-f33b-47e2-912e-b1b776a4041a"],
Cell[140378, 3536, 10869, 271, 771, "Input",ExpressionUUID->"a1358929-d20d-4668-b495-1e4bb285828e"],
Cell[151250, 3809, 12072, 301, 1018, "Input",ExpressionUUID->"4fafc852-071d-4fdc-8baa-8b0c276eb033"],
Cell[163325, 4112, 3805, 94, 360, "Input",ExpressionUUID->"c797be6b-9fe6-482b-8854-e3c92769d57d"],
Cell[167133, 4208, 6668, 157, 720, "Input",ExpressionUUID->"bc8e548f-5977-4ae6-ba39-bcb6fc3313a2"],
Cell[173804, 4367, 2218, 54, 295, "Input",ExpressionUUID->"bed5d2ed-8f13-49c8-8176-4d241a211a68"],
Cell[176025, 4423, 2345, 57, 295, "Input",ExpressionUUID->"ac874933-0226-46ca-af4d-7dd1ac8d9de6"],
Cell[178373, 4482, 11621, 278, 789, "Input",ExpressionUUID->"0bc4dd98-f69e-41b3-afd8-148fcb1bbc9e"],
Cell[189997, 4762, 4215, 100, 371, "Input",ExpressionUUID->"fb05c096-2801-4b8e-91b5-a7cdfde1be05"],
Cell[194215, 4864, 3757, 96, 248, "Input",ExpressionUUID->"52fcd3d2-0d79-43da-b241-368e2393301f"],
Cell[197975, 4962, 16363, 358, 1773, "Input",ExpressionUUID->"b0c868e7-77ab-45f4-9f01-be0e5db4fd5a"],
Cell[214341, 5322, 6550, 153, 716, "Input",ExpressionUUID->"a7b08756-0b30-4d61-9399-d90bc975de49"],
Cell[220894, 5477, 6097, 136, 638, "Input",ExpressionUUID->"34e0d12b-8113-4dd3-9ab5-6c2b35676c93"],
Cell[226994, 5615, 5105, 115, 561, "Input",ExpressionUUID->"67c4165d-9e85-4194-b1ff-2033719e92db"],
Cell[232102, 5732, 25071, 560, 2883, "Input",ExpressionUUID->"d3bc0e6f-728d-432e-9704-a9cc59a0a8a1"],
Cell[257176, 6294, 5097, 124, 504, "Input",ExpressionUUID->"e0d7722e-3b09-42ca-bc49-659bf901b269"],
Cell[262276, 6420, 1699, 28, 181, "Input",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
}
]
*)

