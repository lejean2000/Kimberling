(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      9582,        226]
NotebookOptionsPosition[      8983,        208]
NotebookOutlinePosition[      9414,        225]
CellTagsIndexPosition[      9371,        222]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8399130150855227`*^9, 3.8399130150855227`*^9}, 
   3.839919710866042*^9, 3.8399199407660537`*^9, {3.8399201289222293`*^9, 
   3.839920152741045*^9}, {3.8399205883358803`*^9, 3.839920595085084*^9}, {
   3.83992070302919*^9, 3.8399207092031746`*^9}, {3.8416249776934814`*^9, 
   3.8416249791378546`*^9}, 3.841627116456952*^9, {3.8418034050176563`*^9, 
   3.841803420274452*^9}},
 CellLabel->
  "In[270]:=",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"defined", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<ValueQ[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Head", "@", 
       RowBox[{"ToExpression", "[", "s", "]"}]}], "=!=", "Symbol"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<Attributes[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<DownValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<SubValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenterB", "[", "k_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "wA", ",", " ", "wB", ",", " ", "wC", ",", " ", "w", ",", " ", 
        "AlgoKimberlingWeights"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], ";", " ", 
       RowBox[{
       "AlgoKimberlingWeights", " ", "=", " ", "KimberlingTrilinears1000"}], 
       ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "<=", "1000"}], ",", " ", 
         RowBox[{"AlgoKimberlingWeights", "=", "KimberlingTrilinears1000"}]}],
         "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"KeyExistsQ", "[", 
           RowBox[{"AlgoKimberlingWeights", ",", 
            RowBox[{"\"\<X\>\"", "<>", 
             RowBox[{"ToString", "[", "k", "]"}]}]}], "]"}]}], ",", " ", 
         RowBox[{"Return", " ", "[", 
          RowBox[{"{", 
           RowBox[{
           "Indeterminate", ",", " ", "Indeterminate", ",", " ", 
            "Indeterminate"}], "}"}], "]"}]}], "]"}], ";", "\n", 
       RowBox[{"wA", " ", "=", " ", 
        RowBox[{
         RowBox[{"KimberlingTrilinears1000", "[", 
          RowBox[{"\"\<X\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", 
       RowBox[{"wB", " ", "=", " ", 
        RowBox[{"wA", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", " ", 
           RowBox[{"b", "->", "c"}], ",", " ", 
           RowBox[{"c", "->", "a"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"wC", " ", "=", " ", 
        RowBox[{"wB", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", " ", 
           RowBox[{"b", "->", "c"}], ",", " ", 
           RowBox[{"c", "->", "a"}]}], "}"}]}]}], ";", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "*", "wA"}], ",", 
         RowBox[{"b", "*", "wB"}], ",", 
         RowBox[{"c", "*", "wC"}]}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenter", "[", 
     RowBox[{"k_", ",", " ", "XPA_", ",", " ", "XPB_", ",", " ", "XPC_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "bary", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"bary", " ", "=", " ", 
        RowBox[{"KimberlingCenterB", "[", "k", "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          FractionBox["bary", 
           RowBox[{"Total", "[", "bary", "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"XPA", ",", "XPB", ",", "XPC"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPB", ",", "XPC"}], "]"}]}], ",", " ", 
          RowBox[{"b", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPC"}], "]"}]}], ",", " ", 
          RowBox[{"c", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPB"}], "]"}]}]}], "}"}]}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getTriangleCurve", "[", "name_", "]"}], ":=", 
   RowBox[{"symmetrizeEq", "[", 
    RowBox[{"TriangleCurves", "[", "name", "]"}], "]"}]}], ";"}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.839921381837328*^9, 3.839921481875537*^9}, {
   3.8399215850421853`*^9, 3.839921590734864*^9}, {3.839921719960106*^9, 
   3.8399217214916306`*^9}, {3.83992191721216*^9, 3.8399220814506025`*^9}, {
   3.8399225495361547`*^9, 3.8399236131286974`*^9}, {3.8399313518391676`*^9, 
   3.8399320930987396`*^9}, {3.8399322281826715`*^9, 3.83993232878893*^9}, {
   3.839932362789558*^9, 3.839932403499345*^9}, {3.839932435552127*^9, 
   3.8399324381821175`*^9}, {3.8401085011885195`*^9, 3.840108591519105*^9}, {
   3.8401088901836047`*^9, 3.8401088935311007`*^9}, {3.8401099743018265`*^9, 
   3.8401099753208046`*^9}, {3.840110015653043*^9, 3.840110030704921*^9}, {
   3.8402743491023254`*^9, 3.8402743576969357`*^9}, {3.840274590956602*^9, 
   3.840274593815978*^9}, {3.8416248645983953`*^9, 3.841624877209876*^9}, {
   3.8416250204057693`*^9, 3.841625026321971*^9}, {3.8416252909087768`*^9, 
   3.841625318098734*^9}, {3.841625804123118*^9, 3.841625852595465*^9}, {
   3.8416259105573363`*^9, 3.841625973156365*^9}, {3.841626043792039*^9, 
   3.841626068452715*^9}, {3.841626118942046*^9, 3.8416261630786123`*^9}, {
   3.8416262178047247`*^9, 3.841626296646329*^9}, {3.8416264867247458`*^9, 
   3.8416265437124543`*^9}, {3.8416266403455687`*^9, 
   3.8416266670188184`*^9}, {3.841626718363269*^9, 3.841626728780032*^9}, {
   3.841626773744088*^9, 3.841626780900092*^9}, {3.8416268807394805`*^9, 
   3.8416269755536337`*^9}, {3.841802685169484*^9, 3.84180270405256*^9}, {
   3.8418027633445373`*^9, 3.8418027635967274`*^9}, {3.841803277905569*^9, 
   3.841803322102894*^9}, {3.8418033572025185`*^9, 3.8418033611523724`*^9}, 
   3.841803868649991*^9, {3.841803900193548*^9, 3.8418039006722918`*^9}, {
   3.84180418733173*^9, 3.8418041894432497`*^9}, {3.84180429342428*^9, 
   3.8418042948700695`*^9}, 3.8418043364872885`*^9, {3.841804371113654*^9, 
   3.8418043804889455`*^9}, {3.841804965232213*^9, 3.841804965514862*^9}, {
   3.8418051442639694`*^9, 3.841805204142878*^9}, {3.84180528262469*^9, 
   3.8418052885217733`*^9}, {3.8418053480788345`*^9, 
   3.8418053503163934`*^9}, {3.8418054145260477`*^9, 
   3.8418054218961053`*^9}, {3.8418946130265336`*^9, 3.841894613585767*^9}, {
   3.841898996439632*^9, 3.84189899785963*^9}, 3.84192253832601*^9, {
   3.842056282509132*^9, 3.842056297124096*^9}, {3.8420563368455396`*^9, 
   3.842056360905652*^9}},ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-\
55ec1009fe52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<KimberlingPoints.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<KimberlingPoints.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "KimberlingCenter", ",", " ", "KimberlingCenterB", ",", 
      "getTriangleCurve"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.839920731475067*^9, 3.8399207380489435`*^9}, {
  3.8399209095637517`*^9, 3.839920929892164*^9}, {3.8400856157681627`*^9, 
  3.8400856175744915`*^9}, {3.8400857472955127`*^9, 3.8400857795241475`*^9}, {
  3.841625062759861*^9, 3.8416250659755015`*^9}, {3.841626128111167*^9, 
  3.841626128863483*^9}, {3.841803439373165*^9, 3.8418034395152197`*^9}, {
  3.8420563689039583`*^9, 3.842056369057808*^9}, {3.8420567902777777`*^9, 
  3.8420567987655287`*^9}},ExpressionUUID->"58364175-8417-42fc-be84-\
aa24791f6f0c"]
},
WindowSize->{1093.8, 604.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d28a54b2-181c-47cf-a4e8-d4f2c6cc05a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 665, 12, 26, "Input",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],
Cell[1226, 34, 6903, 154, 402, "Code",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52",
 InitializationCell->False],
Cell[8132, 190, 847, 16, 26, "Input",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
}
]
*)

