(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15582,        403]
NotebookOptionsPosition[     14597,        381]
NotebookOutlinePosition[     15031,        398]
CellTagsIndexPosition[     14988,        395]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8399130150855227`*^9, 3.8399130150855227`*^9}, 
   3.839919710866042*^9, 3.8399199407660537`*^9, {3.8399201289222293`*^9, 
   3.839920152741045*^9}, {3.8399205883358803`*^9, 3.839920595085084*^9}, {
   3.83992070302919*^9, 3.8399207092031746`*^9}, {3.8416249776934814`*^9, 
   3.8416249791378546`*^9}, 3.841627116456952*^9, {3.8418034050176563`*^9, 
   3.841803420274452*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"defined", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<ValueQ[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Head", "@", 
       RowBox[{"ToExpression", "[", "s", "]"}]}], "=!=", "Symbol"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<Attributes[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<DownValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<SubValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getvalue", "[", 
     RowBox[{"ass_", ",", "key_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"ass", ",", "key"}], "]"}], ",", 
      RowBox[{"ass", "[", "key", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "Indeterminate", ",", " ", "Indeterminate", ",", " ", 
        "Indeterminate"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenterB", "[", "k_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "wA", ",", " ", "wB", ",", " ", "wC", ",", " ", "w", ",", "name"}], 
       "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], ";", "\n", 
       RowBox[{"name", "=", 
        RowBox[{"\"\<X\>\"", "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}]}], ";", " ", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"k", "<=", "1000"}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears1000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "1000"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "3000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears3000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "3000"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "5000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears5000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "5000"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "7000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears7000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "40001"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "42000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears42000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "42000"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "44000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears44000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"k", ">", "44000"}], " ", "&&", " ", 
          RowBox[{"k", "<=", "46000"}]}], ",", " ", 
         RowBox[{"wA", " ", "=", 
          RowBox[{"getvalue", "[", 
           RowBox[{"KimberlingTrilinears46000", ",", "name"}], "]"}]}]}], 
        "]"}], ";", "\n", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"wA", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "===", "Indeterminate"}], ",", " ", 
         RowBox[{"Return", " ", "[", 
          RowBox[{"{", 
           RowBox[{
           "Indeterminate", ",", " ", "Indeterminate", ",", " ", 
            "Indeterminate"}], "}"}], "]"}]}], "]"}], ";", "\n", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"wA", ",", "wB", ",", "wC"}], "}"}], " ", "=", " ", 
        RowBox[{"symmetrizeInternal", "[", 
         RowBox[{"wA", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "*", "wA"}], ",", 
         RowBox[{"b", "*", "wB"}], ",", 
         RowBox[{"c", "*", "wC"}]}], "}"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenter", "[", 
     RowBox[{"k_", ",", " ", "XPA_", ",", " ", "XPB_", ",", " ", "XPC_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "bary", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"bary", " ", "=", " ", 
        RowBox[{"KimberlingCenterB", "[", "k", "]"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"Dot", "[", 
         RowBox[{
          FractionBox["bary", 
           RowBox[{"Total", "[", "bary", "]"}]], ",", 
          RowBox[{"{", 
           RowBox[{"XPA", ",", "XPB", ",", "XPC"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPB", ",", "XPC"}], "]"}]}], ",", " ", 
          RowBox[{"b", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPC"}], "]"}]}], ",", " ", 
          RowBox[{"c", "->", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPB"}], "]"}]}]}], "}"}]}]}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getTriangleCurve", "[", "name_", "]"}], ":=", 
   RowBox[{"TriangleCurves", "[", "name", "]"}]}], ";"}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.854357504781231*^9, 3.8543575362929363`*^9}, {
   3.854357635899296*^9, 3.854357636234169*^9}, {3.8543577067642393`*^9, 
   3.8543580411107225`*^9}, 3.8543580813509665`*^9, {3.854358124557372*^9, 
   3.8543581902543573`*^9}, 3.854358273245316*^9, {3.855978280215998*^9, 
   3.855978280778244*^9}, {3.860296169452752*^9, 3.860296200350801*^9}, 
   3.860386921213872*^9, {3.8604121583280196`*^9, 3.860412164843548*^9}, {
   3.8659274328788424`*^9, 3.8659274352855854`*^9}, {3.8696349525916443`*^9, 
   3.869634969135768*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ruleAbsSquare", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", "x___", ")"}], "^", "2"}], "]"}], ":>", 
      SuperscriptBox["x", "2"]}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Can", " ", "also", " ", "be", " ", "just", " ", "Abs"}], "->", 
    "RealAbs"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{
  3.8658221987301817`*^9, {3.869199242102379*^9, 3.869199256804843*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rule69", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9", ",", "13"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8659359365025496`*^9, 3.8659359467166414`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkLines", "[", 
    RowBox[{"lineslist_", ",", "pt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"lineslist", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"3", ",", "76"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"5", ",", "575"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"114", ",", "3628"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"115", ",", "546"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"147", ",", "3090"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"148", ",", "3529"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"382", ",", "671"}], "}"}]}], "}"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", "lines", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"checkcol", "=", 
         RowBox[{
          RowBox[{"bCollinearityMatrix", "[", 
           RowBox[{
            RowBox[{"KimberlingCenterB", "[", 
             RowBox[{"lines", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"KimberlingCenterB", "[", 
             RowBox[{"lines", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "pt3"}], "]"}], "//",
           "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"TrueQ", "[", 
          RowBox[{"checkcol", "==", "0"}], "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"TrueQ", "[", 
            RowBox[{"checkcol", "==", "0"}], "]"}], "]"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{"TrueQ", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"checkcol", "/.", "rule69"}], "//", "N"}], ")"}], "==",
              "0"}], "]"}], "]"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"lines", ",", "lineslist"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.869198992528965*^9, 3.869199028585677*^9}, 
   3.8691997973185325`*^9, 3.870073870279851*^9},
 TextJustification->1.,
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"ffd2f8a5-e614-4c31-bae1-9d03f67826b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCurves", "[", "pt_", "]"}], ":=", " ", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ptest", "=", 
       RowBox[{"pt", "/.", "rule69"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptest", " ", "=", " ", 
       RowBox[{"ptest", "/", 
        RowBox[{"Total", "[", "ptest", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"TriangleCurves", "[", "name", "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptest"}], 
          "]"}]}], "/.", "rule69"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "d", "]"}], "<", 
         SuperscriptBox["10", 
          RowBox[{"-", "10"}]]}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "name", "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"d", "//", "N"}], "]"}]}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"name", ",", 
       RowBox[{"Keys", "[", "TriangleCurves", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8700738645706224`*^9, 3.8700739058519464`*^9}, 
   3.8746355801352577`*^9, 3.874650629594097*^9, {3.874650761338436*^9, 
   3.874650791169675*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<KimberlingPoints.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<KimberlingPoints.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "KimberlingCenter", ",", " ", "KimberlingCenterB", ",", 
      "getTriangleCurve", ",", "getvalue", ",", "ruleAbsSquare", ",", " ", 
      "rule69", ",", " ", "checkLines", ",", "checkCurves"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.839920731475067*^9, 3.8399207380489435`*^9}, {
   3.8399209095637517`*^9, 3.839920929892164*^9}, {3.8400856157681627`*^9, 
   3.8400856175744915`*^9}, {3.8400857472955127`*^9, 
   3.8400857795241475`*^9}, {3.841625062759861*^9, 3.8416250659755015`*^9}, {
   3.841626128111167*^9, 3.841626128863483*^9}, {3.841803439373165*^9, 
   3.8418034395152197`*^9}, {3.8420563689039583`*^9, 3.842056369057808*^9}, {
   3.8420567902777777`*^9, 3.8420567987655287`*^9}, {3.8543581574134016`*^9, 
   3.8543581575743275`*^9}, 3.854358193007846*^9, {3.865822204783577*^9, 
   3.865822205439887*^9}, {3.8659359513067503`*^9, 3.865935951645666*^9}, {
   3.869199052334855*^9, 3.8691990536248193`*^9}, {3.870075019973604*^9, 
   3.8700750227765875`*^9}},ExpressionUUID->"58364175-8417-42fc-be84-\
aa24791f6f0c"]
},
WindowSize->{1105.2, 604.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d28a54b2-181c-47cf-a4e8-d4f2c6cc05a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 661, 11, 26, "Input",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],
Cell[1222, 33, 6990, 182, 546, "Code",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52",
 InitializationCell->False],
Cell[8215, 217, 581, 16, 29, "Input",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],
Cell[8799, 235, 408, 10, 25, "Input",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],
Cell[9210, 247, 2576, 66, 195, "Input",ExpressionUUID->"ffd2f8a5-e614-4c31-bae1-9d03f67826b9"],
Cell[11789, 315, 1556, 40, 151, "Input",ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],
Cell[13348, 357, 1245, 22, 43, "Input",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
}
]
*)

