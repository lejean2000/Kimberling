(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    515973,      13990]
NotebookOptionsPosition[    512674,      13946]
NotebookOutlinePosition[    513108,      13963]
CellTagsIndexPosition[    513065,      13960]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellLabel->
  "In[527]:=",ExpressionUUID->"e6b836b5-3811-402b-b866-4f010ca099ea"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bDistance", "[", 
     RowBox[{"p_", ",", " ", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sp", ",", "sq"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sp", "=", " ", 
        RowBox[{"p", "/", 
         RowBox[{"Total", "[", "p", "]"}]}]}], ";", " ", 
       RowBox[{"sq", "=", 
        RowBox[{"q", "/", 
         RowBox[{"Total", "[", "q", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Minus]", 
           SuperscriptBox["a", "2"]}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "\[Minus]", 
         RowBox[{
          SuperscriptBox["c", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sp", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"sq", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bDistanceMod", "[", 
     RowBox[{"p_", ",", " ", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sp", ",", "sq"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sp", "=", " ", 
        RowBox[{"p", "/", 
         RowBox[{"Total", "[", "p", "]"}]}]}], ";", " ", 
       RowBox[{"sq", "=", 
        RowBox[{"q", "/", 
         RowBox[{"Total", "[", "q", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Minus]", 
            SuperscriptBox["a", "2"]}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "\[Minus]", 
          RowBox[{
           SuperscriptBox["c", "2"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"sp", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"sq", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bDistanceF", "[", 
     RowBox[{"p_", ",", " ", "q_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"sp", ",", "sq"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "This", " ", "function", " ", "is", " ", "needed", " ", "as", " ", 
        "special", " ", "care", " ", "has", " ", "to", " ", "be", " ", 
        "taken", " ", "with", " ", "permuations", " ", "of", " ", 
        "verticies"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sp", "=", " ", 
        RowBox[{"p", "/", 
         RowBox[{"Total", "[", "p", "]"}]}]}], ";", " ", 
       RowBox[{"sq", "=", 
        RowBox[{"q", "/", 
         RowBox[{"Total", "[", "q", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Minus]", 
              SuperscriptBox["a", "2"]}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["b", "2"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "\[Minus]", 
            RowBox[{
             SuperscriptBox["c", "2"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"sq", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], "]"}], "/.", 
          "setupParamTriangle"}], ",", 
         RowBox[{
          RowBox[{"a", ">", "0"}], "&&", 
          RowBox[{"b", ">", "0"}], "&&", 
          RowBox[{"c", ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"a", "+", "b"}], ">", "c"}], "&&", 
          RowBox[{
           RowBox[{"a", "+", "c"}], ">", "b"}], "&&", 
          RowBox[{
           RowBox[{"b", "+", "c"}], ">", "a"}]}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bDistancePointLine", "[", 
    RowBox[{"p_", ",", "l_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "p1", ",", "p2", ",", "p3", ",", "l1", ",", "l2", ",", "l3", ",", 
       "tp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], "=", 
       RowBox[{"p", "/", 
        RowBox[{"Total", "[", "p", "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", "l2", ",", "l3"}], "}"}], "=", "l"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", " ", 
       SqrtBox[
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}], ".", "l"}], ")"}], 
          "2"], 
         RowBox[{
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"l1", "-", "l2"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"l1", "-", "l3"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l1"}], "+", "l2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"l2", "-", "l3"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"l1", "-", "l3"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"l2", "-", "l3"}], ")"}]}]}]]]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeBary", "[", "v_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Normalize", "[", "v", "]"}], "*", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", "1", ",", 
      RowBox[{"Sign", "[", 
       RowBox[{"v", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[528]:=",ExpressionUUID->"efcfc13b-a8c9-4f94-87b7-425bc402d1da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCoordChange", "[", 
     RowBox[{"p_", ",", " ", "d_", ",", " ", "e_", ",", " ", "f_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "/", 
         RowBox[{"Total", "[", "d", "]"}]}], ",", 
        RowBox[{"e", "/", 
         RowBox[{"Total", "[", "e", "]"}]}], ",", 
        RowBox[{"f", "/", 
         RowBox[{"Total", "[", "f", "]"}]}]}], "}"}], "]"}], ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"p", "/", 
       RowBox[{"Total", "[", "p", "]"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "returns", " ", "the", " ", "triangle", " ",
      "center", " ", "number", " ", "k", " ", "for", " ", "DEF"}], ",", " ", 
    RowBox[{"where", " ", "D"}], ",", " ", "E", ",", " ", 
    RowBox[{"and", " ", "F", " ", "are", " ", "in", " ", "barycentrics"}]}], 
   " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCoordChangeK", "[", 
     RowBox[{"k_", ",", " ", "d_", ",", " ", "e_", ",", " ", "f_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pp", "=", 
        RowBox[{
         RowBox[{"X", "[", "k", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", 
            RowBox[{"bDistanceF", "[", 
             RowBox[{"e", ",", "f"}], "]"}]}], ",", 
           RowBox[{"b", "->", 
            RowBox[{"bDistanceF", "[", 
             RowBox[{"d", ",", "f"}], "]"}]}], ",", 
           RowBox[{"c", "->", 
            RowBox[{"bDistanceF", "[", 
             RowBox[{"d", ",", "e"}], "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"d", "/", 
            RowBox[{"Total", "[", "d", "]"}]}], ",", 
           RowBox[{"e", "/", 
            RowBox[{"Total", "[", "e", "]"}]}], ",", 
           RowBox[{"f", "/", 
            RowBox[{"Total", "[", "f", "]"}]}]}], "}"}], "]"}], ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"pp", "/", 
          RowBox[{"Total", "[", "pp", "]"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCoordChangeK", "[", 
     RowBox[{"k_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"d_", ",", " ", "e_", ",", " ", "f_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bCoordChangeK", "[", 
     RowBox[{"k", ",", " ", "d", ",", " ", "e", ",", " ", "f"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bCoordChangeParam", "[", 
    RowBox[{"p_", ",", " ", "d_", ",", " ", "e_", ",", " ", "f_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pp", "=", 
       RowBox[{"p", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", 
           RowBox[{"bDistanceF", "[", 
            RowBox[{"e", ",", "f"}], "]"}]}], ",", 
          RowBox[{"b", "->", 
           RowBox[{"bDistanceF", "[", 
            RowBox[{"d", ",", "f"}], "]"}]}], ",", 
          RowBox[{"c", "->", 
           RowBox[{"bDistanceF", "[", 
            RowBox[{"d", ",", "e"}], "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", "/", 
           RowBox[{"Total", "[", "d", "]"}]}], ",", 
          RowBox[{"e", "/", 
           RowBox[{"Total", "[", "e", "]"}]}], ",", 
          RowBox[{"f", "/", 
           RowBox[{"Total", "[", "f", "]"}]}]}], "}"}], "]"}], ".", 
       RowBox[{"Transpose", "[", 
        RowBox[{"pp", "/", 
         RowBox[{"Total", "[", "pp", "]"}]}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bReverseCoordChange", "[", 
    RowBox[{"p_", ",", " ", "d_", ",", " ", "e_", ",", " ", "f_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["d", 
         RowBox[{"Total", "[", "d", "]"}]], ",", 
        FractionBox["e", 
         RowBox[{"Total", "[", "e", "]"}]], ",", 
        FractionBox["f", 
         RowBox[{"Total", "[", "f", "]"}]]}], "}"}], "]"}], "]"}], ".", 
    RowBox[{"(", 
     FractionBox["p", 
      RowBox[{"Total", "[", "p", "]"}]], ")"}]}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[533]:=",ExpressionUUID->"41f7ea9b-4f97-4b3e-8acc-653e780288c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLine", "[", 
     RowBox[{"u_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "xx", ",", "yy", ",", "zz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}]},
            {
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "3", "]"}], "]"}]},
            {"xx", "yy", "zz"}
           }], ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "xx"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "yy"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "zz"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLineL", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "xx", ",", "yy", ",", "zz"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"m", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"u", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"u", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"u", "[", 
              RowBox[{"[", "3", "]"}], "]"}]},
            {
             RowBox[{"v", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"v", "[", 
              RowBox[{"[", "3", "]"}], "]"}]},
            {"xx", "yy", "zz"}
           }], ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "xx"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "yy"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "zz"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLineIntersection", "[", 
     RowBox[{"l1_", ",", "l2_"}], "]"}], ":=", 
    RowBox[{"{", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"l1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"l2", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"l2", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"l1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"l1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"l2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"l2", "[", 
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"l1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"l1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"l2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"l2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"l1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}], "\t\t", "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIntersection", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", " ", "l2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{"bLine", "[", 
         RowBox[{"a", ",", "b"}], "]"}]}], ";", " ", 
       RowBox[{"l2", "=", 
        RowBox[{"bLine", "[", 
         RowBox[{"c", ",", "d"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"l1", ",", "l2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLineIntersectionETC", "[", 
     RowBox[{"n1_", ",", "n2_", ",", "n3_", ",", "n4_"}], "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", 
     RowBox[{
      RowBox[{"bLine", "[", 
       RowBox[{
        RowBox[{"KimberlingCenterC", "[", "n1", "]"}], ",", 
        RowBox[{"KimberlingCenterC", "[", "n2", "]"}]}], "]"}], ",", 
      RowBox[{"bLine", "[", 
       RowBox[{
        RowBox[{"KimberlingCenterC", "[", "n3", "]"}], ",", 
        RowBox[{"KimberlingCenterC", "[", "n4", "]"}]}], "]"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Returns", " ", "the", " ", "euclidean", " ", "equation", " ", "of", " ", 
     "a", " ", "line", " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"px", "+", "qy"}], "=", "1"}], " ", ")"}]}], ",", " ", 
    RowBox[{"given", " ", "barycentrics"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cLineFromBary", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xa_", ",", "ya_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xb_", ",", "yb_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xc_", ",", "yc_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{"ya", "-", "yb"}], ")"}]}], "+", 
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{"yb", "-", "yc"}], ")"}]}], "+", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "ya"}], "+", "yc"}], ")"}]}]}], 
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xb", " ", "ya"}], "-", 
          RowBox[{"xa", " ", "yb"}]}], ")"}]}], "+", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "xc"}], " ", "ya"}], "+", 
          RowBox[{"xa", " ", "yc"}]}], ")"}]}], "+", 
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"xc", " ", "yb"}], "-", 
          RowBox[{"xb", " ", "yc"}]}], ")"}]}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "xa"}], "+", "xb"}], ")"}]}], "+", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{"xa", "-", "xc"}], ")"}]}], "+", 
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "xb"}], "+", "xc"}], ")"}]}]}], 
      RowBox[{
       RowBox[{"w", " ", "xb", " ", "ya"}], "-", 
       RowBox[{"v", " ", "xc", " ", "ya"}], "-", 
       RowBox[{"w", " ", "xa", " ", "yb"}], "+", 
       RowBox[{"u", " ", "xc", " ", "yb"}], "+", 
       RowBox[{"v", " ", "xa", " ", "yc"}], "-", 
       RowBox[{"u", " ", "xb", " ", "yc"}]}]]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bCollinearityMatrix", "[", 
    RowBox[{"u_", ",", "v_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"u", "[", 
         RowBox[{"[", "3", "]"}], "]"}]},
       {
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}]},
       {
        RowBox[{"w", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bConcurrencyMatrix", "[", 
    RowBox[{"u_", ",", "v_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "1", "]"}], "]"}]},
       {
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "2", "]"}], "]"}]},
       {
        RowBox[{"u", "[", 
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cCollinearityMatrix", "[", 
    RowBox[{"u_", ",", "v_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"u", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "1"},
       {
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "1"},
       {
        RowBox[{"w", "[", 
         RowBox[{"[", "1", "]"}], "]"}], 
        RowBox[{"w", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "1"}
      }], ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cConcurrencyMatrix", "[", 
    RowBox[{"l1_", ",", "l2_", ",", "l3_"}], "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"(", GridBox[{
       {
        RowBox[{"Coefficient", "[", 
         RowBox[{"l1", ",", "x"}], "]"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"l1", ",", "y"}], "]"}], 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"l1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "->", "0"}], ",", 
            RowBox[{"y", "->", "0"}]}], "}"}]}], "]"}]},
       {
        RowBox[{"Coefficient", "[", 
         RowBox[{"l2", ",", "x"}], "]"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"l2", ",", "y"}], "]"}], 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"l2", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "->", "0"}], ",", 
            RowBox[{"y", "->", "0"}]}], "}"}]}], "]"}]},
       {
        RowBox[{"Coefficient", "[", 
         RowBox[{"l3", ",", "x"}], "]"}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"l3", ",", "y"}], "]"}], 
        RowBox[{"ReplaceAll", "[", 
         RowBox[{"l3", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "->", "0"}], ",", 
            RowBox[{"y", "->", "0"}]}], "}"}]}], "]"}]}
      }], ")"}], "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[538]:=",ExpressionUUID->"c9896926-9e62-48e1-be02-b966460bf823"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsParallel", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"b1", " ", "c2"}], " ", "-", " ", 
     RowBox[{"c1", " ", "b2"}], " ", "+", " ", 
     RowBox[{"c1", " ", "a2"}], " ", "-", " ", 
     RowBox[{"a1", " ", "c2"}], " ", "+", " ", 
     RowBox[{"a1", " ", "b2"}], " ", "-", " ", 
     RowBox[{"b1", " ", "a2"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsHomothetic", "[", 
     RowBox[{"tr1_", ",", "tr2_"}], "]"}], ":=", 
    RowBox[{"bIsParallel", "[", 
     RowBox[{
      RowBox[{"bLine", "[", 
       RowBox[{
        RowBox[{"tr1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"tr1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"bLine", "[", 
       RowBox[{
        RowBox[{"tr2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"tr2", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bParallelLine", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l1_", ",", "l2_", ",", "l3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "tot", ",", "xx", ",", "yy", ",", "zz"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Line", " ", "through", " ", "p", " ", "parallel", " ", "to", " ", 
        "l"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tot", "=", 
        RowBox[{"p1", "+", "p2", "+", "p3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", GridBox[{
            {
             RowBox[{"l2", "-", "l3"}], 
             RowBox[{"l3", "-", "l1"}], 
             RowBox[{"l1", "-", "l2"}]},
            {
             RowBox[{"p1", "/", "tot"}], 
             RowBox[{"p2", "/", "tot"}], 
             RowBox[{"p3", "/", "tot"}]},
            {"xx", "yy", "zz"}
           }], ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "xx"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "yy"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "zz"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]",
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Reflection", " ", "of", " ", "point", " ", "U", " ", "in", " ", "line", 
    " ", "L"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bReflectionPL", "[", 
     RowBox[{"ptU_", ",", 
      RowBox[{"{", 
       RowBox[{"pp_", ",", "qq_", ",", "rr_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tot", ",", " ", "uu", ",", "vv", ",", "ww", ",", "mtxv", ",", "ssa", 
        ",", "ssb", ",", "ssc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"uu", ",", "vv", ",", "ww"}], "}"}], "=", 
        RowBox[{"ptU", "/", 
         RowBox[{"Total", "[", "ptU", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ssa", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"], "-", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       RowBox[{"ssb", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox["c", "2"], "+", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       RowBox[{"ssc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"], "+", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mtxv", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ssb", 
            RowBox[{"(", 
             RowBox[{"pp", "-", "rr"}], ")"}]}], "-", 
           RowBox[{"ssc", 
            RowBox[{"(", 
             RowBox[{"qq", "-", "pp"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"ssc", 
            RowBox[{"(", 
             RowBox[{"qq", "-", "pp"}], ")"}]}], "-", 
           RowBox[{"ssa", 
            RowBox[{"(", 
             RowBox[{"rr", "-", "qq"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"ssa", 
            RowBox[{"(", 
             RowBox[{"rr", "-", "qq"}], ")"}]}], "-", 
           RowBox[{"ssb", 
            RowBox[{"(", 
             RowBox[{"pp", "-", "rr"}], ")"}]}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"uu", ",", "vv", ",", "ww"}], "}"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], ".", 
            RowBox[{"{", 
             RowBox[{"uu", ",", "vv", ",", "ww"}], "}"}]}], 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], ".", "mtxv"}]], 
          ")"}], "*", "mtxv"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Reflection", " ", "of", " ", "Line", " ", "l1", " ", "in", " ", "line", 
    " ", "l2"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bReflectionLL", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l_", ",", "m_", ",", "n_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["m", "2"], " ", "p"}], "-", 
          RowBox[{"m", " ", "n", " ", "p"}], "+", 
          RowBox[{"l", " ", "n", " ", "q"}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"q", "-", "r"}], ")"}]}], "+", 
          RowBox[{"l", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "q"}], "+", "r"}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["n", "2"], " ", "p"}], "+", 
          RowBox[{"l", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"q", "-", 
             RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "q"}], "+", "r"}], ")"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "n"}], " ", "p"}], "+", 
             RowBox[{"l", " ", "r"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "m"}], " ", "n", " ", "p"}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q", "-", "r"}], ")"}]}], "+", 
          RowBox[{"l", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"n", " ", "q"}], "+", 
             RowBox[{"m", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "n", " ", "p"}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", "q"}], "-", 
          RowBox[{"l", " ", "n", " ", "q"}], "+", 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "r"}], ")"}]}], "+", 
          RowBox[{"l", " ", "m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "p"}], "+", "r"}], ")"}]}]}], ")"}]}], 
       "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "+", "n"}], ")"}], " ", "q"}], "+", 
          RowBox[{"m", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", 
             RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
          RowBox[{"l", " ", "m", " ", "r"}], "+", 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "r"}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l", " ", "n", " ", "q"}], "+", 
          RowBox[{
           SuperscriptBox["m", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q", "+", "r"}], ")"}]}], "-", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"n", " ", "p"}], "+", 
             RowBox[{"l", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "n", " ", "p"}], "+", 
          RowBox[{
           SuperscriptBox["n", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "q"}], ")"}]}], "+", 
          RowBox[{"l", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "p"}], "+", "q"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["l", "2"], " ", "r"}], "-", 
          RowBox[{"l", " ", "m", " ", "r"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"m", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", 
             RowBox[{"2", " ", "q"}]}], ")"}]}], "+", 
          RowBox[{"l", " ", "n", " ", "q"}], "+", 
          RowBox[{
           SuperscriptBox["n", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "p"}], "+", "q"}], ")"}]}], "-", 
          RowBox[{"l", " ", "m", " ", "r"}], "+", 
          RowBox[{
           SuperscriptBox["m", "2"], " ", "r"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "l"}], " ", "q"}], "+", 
             RowBox[{"n", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "-", "r"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"m", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "n"}], " ", "p"}], "+", 
             RowBox[{"l", " ", "r"}]}], ")"}]}]}], ")"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Homotethy", " ", "of", " ", "point", " ", "P", " ", "with", " ", "center",
     " ", "O", " ", "and", " ", "factor", " ", 
    RowBox[{"1", "/", "k"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHomotethy", "[", 
     RowBox[{"ptP_", ",", "ptO_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "w", ",", "oa", ",", "ob", ",", "oc"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v", ",", "w"}], "}"}], "=", 
        RowBox[{"ptP", "/", 
         RowBox[{"Total", "[", "ptP", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"oa", ",", "ob", ",", "oc"}], "}"}], "=", 
        RowBox[{"ptO", "/", 
         RowBox[{"Total", "[", "ptO", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"k", " ", "oa"}], "+", 
           RowBox[{"ob", " ", "u"}], "+", 
           RowBox[{"oc", " ", "u"}], "-", 
           RowBox[{"oa", " ", "v"}], "-", 
           RowBox[{"oa", " ", "w"}]}], "k"], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"k", " ", "ob"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"oa", "+", "oc"}], ")"}], " ", "v"}], "-", 
           RowBox[{"ob", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], "k"], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"k", " ", "oc"}], "-", 
           RowBox[{"oc", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"oa", "+", "ob"}], ")"}], " ", "w"}]}], "k"]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Homotethy", " ", "of", " ", "point", " ", "P", " ", "with", " ", "center",
     " ", "O", " ", "and", " ", "factor", " ", "k"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHomotethy2", "[", 
     RowBox[{"ptP_", ",", "ptO_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"bHomotethy", "[", 
     RowBox[{"ptP", ",", "ptO", ",", 
      RowBox[{"1", "/", "k"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Reflection", " ", "of", " ", "point", " ", "P", " ", "in", " ", "point", 
    " ", "U"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bReflectionPP", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"uu_", ",", "vv_", ",", "ww_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"oa_", ",", "ob_", ",", "oc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ob", "+", "oc"}], ")"}], " ", "uu"}], ")"}]}], "+", 
       RowBox[{"oa", " ", 
        RowBox[{"(", 
         RowBox[{"uu", "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"vv", "+", "ww"}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"oa", "+", "oc"}], ")"}], " ", "vv"}], ")"}]}], "+", 
       RowBox[{"ob", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "uu"}], "+", "vv", "+", 
          RowBox[{"2", " ", "ww"}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"oa", "+", "ob"}], ")"}], " ", "ww"}], ")"}]}], "+", 
       RowBox[{"oc", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "uu"}], "+", 
          RowBox[{"2", " ", "vv"}], "+", "ww"}], ")"}]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Given", " ", "circle", " ", "c"}], "=", 
     RowBox[{"(", 
      RowBox[{"O", ",", "R"}], ")"}]}], ",", " ", 
    RowBox[{
    "it", " ", "calculates", " ", "the", " ", "point", " ", "X", " ", "which",
      " ", "is", " ", "the", " ", "inverse", " ", "of", " ", "point", " ", 
     "P"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bInversePoint", "[", 
     RowBox[{"ptP_", ",", "ptO_", ",", "rad_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coef", ",", "ptP2", ",", "ptO2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ptP2", "=", 
        RowBox[{"ptP", "/", 
         RowBox[{"Total", "[", "ptP", "]"}]}]}], ";", 
       RowBox[{"ptO2", "=", 
        RowBox[{"ptO", "/", 
         RowBox[{"Total", "[", "ptO", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coef", "=", 
        RowBox[{
         FractionBox[
          SuperscriptBox["rad", "2"], 
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"ptP", ",", "ptO"}], "]"}], "2"]], "//", "Simplify"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"ptO2", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"coef", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ptP2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"ptO2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"ptO2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", 
          RowBox[{"coef", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ptP2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"ptO2", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{"ptO2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"coef", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ptP2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"ptO2", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}]}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircumcircleInverse", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["b", "4"]}], " ", "u", " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"u", "-", "v"}], ")"}], " ", "w"}]}], ")"}]}]}], 
        ")"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["b", "6"], " ", "u", " ", "w"}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["c", "4"]}], " ", "u"}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["c", "2"], " ", "v"}], "-", 
          RowBox[{
           SuperscriptBox["a", "4"], " ", "w"}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"v", "-", "w"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "u"}], "+", "v"}], ")"}], " ", "w"}]}], ")"}]}]}], 
      ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "4"]}], " ", "v", " ", "w"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", "v"}], "+", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", "w"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["w", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "u"}], "+", "w"}], ")"}]}]}], ")"}]}]}], 
        ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Given", " ", "a", " ", "conic"}], ",", " ", 
    RowBox[{
    "it", " ", "calculates", " ", "the", " ", "point", " ", "X", " ", "which",
      " ", "is", " ", "the", " ", "inverse", " ", "of", " ", "point", " ", 
     "P", " ", "wrt", " ", "the", " ", "conic", "\[IndentingNewLine]", 
     RowBox[{"i", ".", "e", ".", " ", "the"}], " ", "intersection", " ", "of",
      " ", "the", " ", "polar", " ", "of", " ", "X", " ", "with", " ", "line",
      " ", "OX", " ", "where", " ", "O", " ", "is", " ", "the", " ", "center",
      " ", "of", " ", "the", " ", 
     RowBox[{"conic", "."}]}]}], "\[IndentingNewLine]", " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bInverseInConic", "[", 
    RowBox[{"ptP_", ",", "mx_"}], "]"}], ":=", 
   RowBox[{"bLineIntersection", "[", 
    RowBox[{
     RowBox[{"bPolar", "[", 
      RowBox[{"mx", ",", "ptP"}], "]"}], ",", 
     RowBox[{"bLine", "[", 
      RowBox[{"ptP", ",", 
       RowBox[{"bConicCenter", "[", "mx", "]"}]}], "]"}]}], "]"}]}], 
  ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[548]:=",ExpressionUUID->"45dd24a4-88e8-4d54-9e84-f9aa0bf4232c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeInternal", "[", "eq_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"partB", ",", " ", "partC"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"pp", ",", "qq", ",", "rr", ",", "uu", ",", "vv", ",", "ww"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"eq", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pp", "->", "qq"}], ",", " ", 
          RowBox[{"qq", "->", "rr"}], ",", " ", 
          RowBox[{"rr", "->", "pp"}], ",", " ", 
          RowBox[{"uu", "->", "vv"}], ",", " ", 
          RowBox[{"vv", "->", "ww"}], ",", " ", 
          RowBox[{"ww", "->", "uu"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pp", "->", "qq"}], ",", " ", 
          RowBox[{"qq", "->", "rr"}], ",", " ", 
          RowBox[{"rr", "->", "pp"}], ",", " ", 
          RowBox[{"uu", "->", "vv"}], ",", " ", 
          RowBox[{"vv", "->", "ww"}], ",", " ", 
          RowBox[{"ww", "->", "uu"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"eq", ",", "partB", ",", "partC"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sym", "=", "symmetrizeInternal"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeInternal2", "[", "eq_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"partB", ",", " ", "partC"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"p", ",", "q", ",", "r", ",", "u", ",", "v", ",", "w"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"eq", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", "q"}], ",", " ", 
          RowBox[{"q", "->", "r"}], ",", " ", 
          RowBox[{"r", "->", "p"}], ",", " ", 
          RowBox[{"u", "->", "v"}], ",", " ", 
          RowBox[{"v", "->", "w"}], ",", " ", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", "q"}], ",", " ", 
          RowBox[{"q", "->", "r"}], ",", " ", 
          RowBox[{"r", "->", "p"}], ",", " ", 
          RowBox[{"u", "->", "v"}], ",", " ", 
          RowBox[{"v", "->", "w"}], ",", " ", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"eq", ",", "partB", ",", "partC"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sym2", "=", "symmetrizeInternal2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeInternal3", "[", "eq_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"partB", ",", " ", "partC"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"p", ",", "q", ",", "r", ",", "u", ",", "v", ",", "w"}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"eq", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", "q"}], ",", " ", 
          RowBox[{"q", "->", "r"}], ",", " ", 
          RowBox[{"r", "->", "p"}], ",", " ", 
          RowBox[{"u", "->", "v"}], ",", " ", 
          RowBox[{"v", "->", "w"}], ",", " ", 
          RowBox[{"w", "->", "u"}], ",", 
          RowBox[{"x", "->", "y"}], ",", 
          RowBox[{"y", "->", "z"}], ",", 
          RowBox[{"z", "->", "x"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "->", "q"}], ",", " ", 
          RowBox[{"q", "->", "r"}], ",", " ", 
          RowBox[{"r", "->", "p"}], ",", " ", 
          RowBox[{"u", "->", "v"}], ",", " ", 
          RowBox[{"v", "->", "w"}], ",", " ", 
          RowBox[{"w", "->", "u"}], ",", 
          RowBox[{"x", "->", "y"}], ",", 
          RowBox[{"y", "->", "z"}], ",", 
          RowBox[{"z", "->", "x"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partC", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"angleA", "->", "angleB"}], ",", 
          RowBox[{"angleB", "->", "angleC"}], ",", 
          RowBox[{"angleC", "->", "angleA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"eq", ",", "partB", ",", "partC"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sym3", "=", "symmetrizeInternal3"}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"f", 
       RowBox[{"(", 
        RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], ":", 
      RowBox[{"g", 
       RowBox[{"(", 
        RowBox[{"b", ",", "c", ",", "a"}], ")"}]}], ":", 
      RowBox[{"g", 
       RowBox[{"(", 
        RowBox[{"c", ",", "a", ",", "b"}], ")"}], "\n", 
       RowBox[{"B", "'"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], ":", 
       RowBox[{"f", 
        RowBox[{"(", 
         RowBox[{"b", ",", "c", ",", "a"}], ")"}]}], ":", 
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"c", ",", "a", ",", "b"}], ")"}], "\n", 
        RowBox[{"C", "'"}]}]}], "=", 
      RowBox[{
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], ":", 
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"b", ",", "c", ",", "a"}], ")"}]}], ":", 
       RowBox[{"f", 
        RowBox[{"(", 
         RowBox[{"c", ",", "a", ",", "b"}], ")"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"symmetrizeTriangle", "[", "name_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
       "v1", ",", "v2", ",", "v3", ",", "partB1", ",", "partB2", ",", 
        "partB3", ",", "partC1", ",", "partC2", ",", "partC3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], "=", 
        RowBox[{"KimberlingTrianglesBary", "[", "name", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"partB1", "=", 
        RowBox[{"v2", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b", "->", "a"}], ",", 
           RowBox[{"c", "->", "b"}], ",", 
           RowBox[{"a", "->", "c"}], ",", 
           RowBox[{"sb", "->", "sa"}], ",", 
           RowBox[{"sc", "->", "sb"}], ",", 
           RowBox[{"sa", "->", "sc"}], ",", 
           RowBox[{"SB", "->", "SA"}], ",", 
           RowBox[{"SC", "->", "SB"}], ",", 
           RowBox[{"SA", "->", "SC"}], ",", 
           RowBox[{"B", "->", "A"}], ",", 
           RowBox[{"C", "->", "B"}], ",", 
           RowBox[{"A", "->", "C"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partB2", "=", 
        RowBox[{"v1", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", 
           RowBox[{"b", "->", "c"}], ",", 
           RowBox[{"c", "->", "a"}], ",", 
           RowBox[{"sa", "->", "sb"}], ",", 
           RowBox[{"sb", "->", "sc"}], ",", 
           RowBox[{"sc", "->", "sa"}], ",", 
           RowBox[{"SA", "->", "SB"}], ",", 
           RowBox[{"SB", "->", "SC"}], ",", 
           RowBox[{"SC", "->", "SA"}], ",", 
           RowBox[{"A", "->", "B"}], ",", 
           RowBox[{"B", "->", "C"}], ",", 
           RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partB3", "=", "v3"}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC1", "=", " ", "partB1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC2", " ", "=", "v2"}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC3", " ", "=", " ", 
        RowBox[{"partB2", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "->", "b"}], ",", 
           RowBox[{"b", "->", "c"}], ",", 
           RowBox[{"c", "->", "a"}], ",", 
           RowBox[{"sa", "->", "sb"}], ",", 
           RowBox[{"sb", "->", "sc"}], ",", 
           RowBox[{"sc", "->", "sa"}], ",", 
           RowBox[{"SA", "->", "SB"}], ",", 
           RowBox[{"SB", "->", "SC"}], ",", 
           RowBox[{"SC", "->", "SA"}], ",", 
           RowBox[{"A", "->", "B"}], ",", 
           RowBox[{"B", "->", "C"}], ",", 
           RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"partB1", ",", "partB2", ",", "partB3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"partC1", ",", "partC2", ",", "partC3"}], "}"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "'"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"f", 
       RowBox[{"(", 
        RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], ":", 
      RowBox[{"g", 
       RowBox[{"(", 
        RowBox[{"b", ",", "c", ",", "a"}], ")"}]}], ":", 
      RowBox[{"g", 
       RowBox[{"(", 
        RowBox[{"c", ",", "b", ",", "a"}], ")"}], "\n", 
       RowBox[{"B", "'"}]}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"a", ",", "c", ",", "b"}], ")"}]}], ":", 
       RowBox[{"f", 
        RowBox[{"(", 
         RowBox[{"b", ",", "c", ",", "a"}], ")"}]}], ":", 
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"c", ",", "a", ",", "b"}], ")"}], "\n", 
        RowBox[{"C", "'"}]}]}], "=", 
      RowBox[{
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"a", ",", "b", ",", "c"}], ")"}]}], ":", 
       RowBox[{"g", 
        RowBox[{"(", 
         RowBox[{"b", ",", "a", ",", "c"}], ")"}]}], ":", 
       RowBox[{"f", 
        RowBox[{"(", 
         RowBox[{"c", ",", "a", ",", "b"}], ")"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeTriangleType2", "[", "name_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "v1", ",", "v2", ",", "v3", ",", "partB1", ",", "partB2", ",", "partB3",
        ",", "partC1", ",", "partC2", ",", "partC3"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], "=", 
       RowBox[{"KimberlingTrianglesBary", "[", "name", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"partB1", "=", 
       RowBox[{"v3", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB2", "=", 
       RowBox[{"v1", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB3", "=", 
       RowBox[{"v2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC1", "=", " ", 
       RowBox[{"partB3", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC2", " ", "=", 
       RowBox[{"partB1", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC3", " ", "=", " ", 
       RowBox[{"partB2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"partB1", ",", "partB2", ",", "partB3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"partC1", ",", "partC2", ",", "partC3"}], "}"}]}], "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"triangle", " ", "=", " ", "symmetrizeTriangleType2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"symmetrizeTriangleExprType2Bary", "[", 
     RowBox[{"{", 
      RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
       "partB1", ",", "partB2", ",", "partB3", ",", "partC1", ",", "partC2", 
        ",", "partC3", ",", "repl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"repl", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"u", "->", "v"}], ",", 
          RowBox[{"v", "->", "w"}], ",", 
          RowBox[{"w", "->", "u"}], ",", 
          RowBox[{"p", "->", "q"}], ",", " ", 
          RowBox[{"q", "->", "r"}], ",", " ", 
          RowBox[{"r", "->", "p"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partB1", "=", 
        RowBox[{"v3", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partB2", "=", 
        RowBox[{"v1", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partB3", "=", 
        RowBox[{"v2", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC1", "=", " ", 
        RowBox[{"partB3", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC2", " ", "=", 
        RowBox[{"partB1", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"partC3", " ", "=", " ", 
        RowBox[{"partB2", "/.", "repl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"partB1", ",", "partB2", ",", "partB3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"partC1", ",", "partC2", ",", "partC3"}], "}"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeTriangleExprType1Bary", "[", 
    RowBox[{"{", 
     RowBox[{"v1_", ",", "v2_", ",", "v3_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "partB1", ",", "partB2", ",", "partB3", ",", "partC1", ",", "partC2", 
       ",", "partC3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partB1", "=", 
       RowBox[{"v2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "->", "a"}], ",", 
          RowBox[{"c", "->", "b"}], ",", 
          RowBox[{"a", "->", "c"}], ",", 
          RowBox[{"sb", "->", "sa"}], ",", 
          RowBox[{"sc", "->", "sb"}], ",", 
          RowBox[{"sa", "->", "sc"}], ",", 
          RowBox[{"SB", "->", "SA"}], ",", 
          RowBox[{"SC", "->", "SB"}], ",", 
          RowBox[{"SA", "->", "SC"}], ",", 
          RowBox[{"v", "->", "u"}], ",", 
          RowBox[{"w", "->", "v"}], ",", 
          RowBox[{"u", "->", "w"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB2", "=", 
       RowBox[{"v1", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"u", "->", "v"}], ",", 
          RowBox[{"v", "->", "w"}], ",", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partB3", "=", "v3"}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC1", "=", " ", "partB1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC2", " ", "=", "v2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC3", " ", "=", " ", 
       RowBox[{"partB2", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", 
          RowBox[{"b", "->", "c"}], ",", 
          RowBox[{"c", "->", "a"}], ",", 
          RowBox[{"sa", "->", "sb"}], ",", 
          RowBox[{"sb", "->", "sc"}], ",", 
          RowBox[{"sc", "->", "sa"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"u", "->", "v"}], ",", 
          RowBox[{"v", "->", "w"}], ",", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"partB1", ",", "partB2", ",", "partB3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"partC1", ",", "partC2", ",", "partC3"}], "}"}]}], "}"}]}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[559]:=",ExpressionUUID->"12911951-98bf-4dbb-87c5-3b1bbfdddeaf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircumcevianTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u1_", ",", " ", "v1_", ",", " ", "w1_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "w", ",", "A1", ",", "B1", ",", "C1"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Returns", " ", "a", " ", "list", " ", "of", " ", "3", " ", "points", 
        " ", "representing", " ", "the", " ", "circumcevian", " ", "triangle",
         " ", "of", " ", "point", " ", 
        RowBox[{"(", 
         RowBox[{"u", ",", "v", ",", "w"}], ")"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", " ", "v", ",", " ", "w"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u1", "/", "a"}], ",", 
          RowBox[{"v1", "/", "b"}], ",", 
          RowBox[{"w1", "/", "c"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"A1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a"}], " ", "v", " ", "w"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", "w"}], " ", "+", " ", 
             RowBox[{"c", " ", "v"}]}], ")"}], "v"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"b", " ", "w"}], " ", "+", " ", 
             RowBox[{"c", " ", "v"}]}], ")"}], "w"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "u"}], " ", "+", " ", 
             RowBox[{"a", " ", "w"}]}], ")"}], "u"}], ",", " ", 
          RowBox[{
           RowBox[{"-", "b"}], " ", "u", " ", "w"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"c", " ", "u"}], " ", "+", " ", 
             RowBox[{"a", " ", "w"}]}], ")"}], "w"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C1", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "v"}], " ", "+", " ", 
             RowBox[{"b", " ", "u"}]}], ")"}], "u"}], ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", "v"}], " ", "+", " ", 
             RowBox[{"b", " ", "u"}]}], ")"}], "v"}], ",", "  ", 
          RowBox[{
           RowBox[{"-", "c"}], " ", "u", " ", "v"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bFromTrilinear", "/@", 
        RowBox[{"{", 
         RowBox[{"A1", ",", "B1", ",", "C1"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCevianTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", " ", "v_", ",", " ", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "v", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "0", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "w"}], "}"}], "-", 
       RowBox[{"pedal", " ", "triangle", " ", "of", " ", "Q"}]}], "=", 
      RowBox[{"{", 
       RowBox[{"p", ",", "q", ",", "r"}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
    "Through", " ", "Q", " ", "construct", " ", "a", " ", "line", " ", 
     "parallel", " ", "to", " ", "AP", " ", "and", " ", "let", " ", 
     RowBox[{"A", "'"}], " ", "be", " ", "the", " ", "intersection", " ", 
     "point", " ", "with", " ", 
     RowBox[{"BC", ".", " ", "Similarly"}], " ", "define", " ", 
     RowBox[{"B", "'"}], " ", "and", " ", 
     RowBox[{"C", "'"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"A", "'"}], 
      RowBox[{"B", "'"}], 
      RowBox[{"C", "'"}], " ", "is", " ", "called", " ", "P"}], "-", 
     RowBox[{"pedal", " ", "triangle", " ", "of", " ", 
      RowBox[{"Q", "."}]}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPCevianTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", " ", "v_", ",", " ", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"p", " ", "v"}], "+", 
         RowBox[{"q", " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"p", " ", "w"}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}]}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{"q", " ", "w"}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}]}]}], ",", "0"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossCevianTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", " ", "v_", ",", " ", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "+", 
           RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"q", " ", "v", " ", "w"}], ",", 
        RowBox[{"r", " ", "v", " ", "w"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", " ", "u", " ", "w"}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "+", 
           RowBox[{"p", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"r", " ", "u", " ", "w"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", " ", "u", " ", "v"}], ",", 
        RowBox[{"q", " ", "u", " ", "v"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}]}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{"P", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "w"}], "}"}], "-", 
      RowBox[{"antipedal", " ", "triangle", " ", "of", " ", "Q"}]}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", ",", "q", ",", "r"}], "}"}], ".", " ", "This"}], " ", 
       "is", " ", "a", " ", "triangle", " ", 
       RowBox[{"A", "'"}], 
       RowBox[{"B", "'"}], 
       RowBox[{"C", "'"}], " ", "such", " ", "that", " ", "ABC", " ", "is", 
       " ", "P"}], "-", 
      RowBox[{"Pedal", " ", "of", " ", "Q", " ", "qrt", " ", 
       RowBox[{"A", "'"}], 
       RowBox[{"B", "'"}], 
       RowBox[{
        RowBox[{"C", "'"}], "."}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bPAntipedal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "q"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "w"}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "r"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "u"}], "+", 
          RowBox[{"p", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "v"}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAnticevianTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", " ", "v_", ",", " ", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "u"}], ",", "v", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", 
        RowBox[{"-", "v"}], ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", 
        RowBox[{"-", "w"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAnticevianGeneral", "[", 
     RowBox[{"pp_", ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa", ",", "pb", ",", "pc", ",", "qa", ",", "qb", ",", "qc"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pa", ",", "pb", ",", "pc"}], "}"}], "=", 
        RowBox[{"bCevianTriangleGeneral", "[", 
         RowBox[{"pp", ",", "xa", ",", "xb", ",", "xc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qa", "=", 
        RowBox[{"bHarmonicConjugateFull", "[", 
         RowBox[{"xa", ",", "pa", ",", "pp"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qb", "=", 
        RowBox[{"bHarmonicConjugateFull", "[", 
         RowBox[{"xb", ",", "pb", ",", "pp"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qc", "=", 
        RowBox[{"bHarmonicConjugateFull", "[", 
         RowBox[{"xc", ",", "pc", ",", "pp"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qa", ",", "qb", ",", "qc"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPedalTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", " ", "v_", ",", " ", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "v"}], "+", 
         RowBox[{"SC", " ", "u"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "w"}], "+", 
         RowBox[{"SB", " ", "u"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], "u"}], "+", 
         RowBox[{"SC", " ", "v"}]}], ",", "0", ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], "w"}], "+", 
         RowBox[{"SA", " ", "v"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], "u"}], "+", 
         RowBox[{"SB", " ", "w"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], "v"}], "+", 
         RowBox[{"SA", " ", "w"}]}], ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPedalGeneral", "[", 
     RowBox[{"pp_", ",", "p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"h1", ",", "h2", ",", "h3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h1", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bPerpendicular", "[", 
            RowBox[{
             RowBox[{"bLine", "[", 
              RowBox[{"p2", ",", "p3"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"p2", ",", "p3"}], "]"}]}], "]"}], "//", "Simplify"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"h2", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bPerpendicular", "[", 
            RowBox[{
             RowBox[{"bLine", "[", 
              RowBox[{"p1", ",", "p3"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"p1", ",", "p3"}], "]"}]}], "]"}], "//", "Simplify"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"h3", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bPerpendicular", "[", 
            RowBox[{
             RowBox[{"bLine", "[", 
              RowBox[{"p1", ",", "p2"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"p1", ",", "p2"}], "]"}]}], "]"}], "//", "Simplify"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"h1", ",", "h2", ",", "h3"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPedalGeneral", "[", 
     RowBox[{"pp_", ",", 
      RowBox[{"{", 
       RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bPedalGeneral", "[", 
     RowBox[{"pp", ",", "p1", ",", "p2", ",", "p3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Triangle", " ", "formed", " ", "by", " ", "the", " ", "A"}], 
     "-"}], ",", " ", 
    RowBox[{"B", "-"}], ",", " ", 
    RowBox[{
     RowBox[{"and", " ", "C"}], "-", 
     RowBox[{"Fregier", " ", "points", " ", "of", " ", "P"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bFregierTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"SA", " ", "u"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "SA"}], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "w"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v"}], "-", 
         RowBox[{"SA", " ", "w"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "SB"}], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w"}]}], ",", 
        RowBox[{"SB", " ", "v"}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u"}], "-", 
         RowBox[{"SB", " ", "w"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "SC"}], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u"}], "-", 
         RowBox[{"SC", " ", "v"}]}], ",", 
        RowBox[{"SC", " ", "w"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bFuhrmannTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"symmetrizeTriangleExprType2Bary", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", "v", " ", "w"}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], " ", "w"}], "+", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], " ", "v"}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "w"}], "}"}], " ", "is", " ", 
     "perspector"}], ",", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "q", ",", "r"}], "}"}], " ", "is", " ", "the", " ", 
     "point"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircumconcevianTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"q", " ", "r", " ", "u"}], ",", 
        RowBox[{
         RowBox[{"-", "q"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "+", 
           RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "r"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "+", 
           RowBox[{"q", " ", "w"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "+", 
           RowBox[{"p", " ", "w"}]}], ")"}]}], ",", 
        RowBox[{"p", " ", "r", " ", "v"}], ",", 
        RowBox[{
         RowBox[{"-", "r"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "+", 
           RowBox[{"p", " ", "w"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "p"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", "v"}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "q"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", "v"}]}], ")"}]}], ",", 
        RowBox[{"p", " ", "q", " ", "w"}]}], "}"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Let", " ", "the", " ", "line", " ", "through", " ", "Q", " ", "parallel",
      " ", "to", " ", "AP", " ", "intersect", " ", "lines", " ", "AB", " ", 
     "and", " ", "AC", " ", "at", " ", "points", " ", "Ab", " ", "and", " ", 
     RowBox[{"Ac", ".", " ", "Similarly"}], " ", "define", " ", "Ba"}], ",", 
    "Bc", ",", "Ca", ",", 
    RowBox[{
     RowBox[{"Cb", ".", "\[IndentingNewLine]", "Let"}], " ", "lines", " ", 
     "BaCa"}], ",", "AbCb", ",", 
    RowBox[{
     RowBox[{
     "AcBc", " ", "define", " ", "a", " ", "triangle", " ", "called", " ", 
      "here", " ", "the", " ", "P"}], "-", 
     RowBox[{"crosspedal", " ", "of", " ", 
      RowBox[{"Q", "."}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossPedalTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "u"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", "v"}], "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", "w"}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "-", 
           RowBox[{"q", " ", "w"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "u"}], "+", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "v"}], "-", 
             RowBox[{"q", " ", "w"}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "u"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "-", 
           RowBox[{"p", " ", "w"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", "v"}], "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "w"}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "-", 
           RowBox[{"p", " ", "w"}]}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "-", 
           RowBox[{"p", " ", "v"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", "w"}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", "u"}], "+", 
           RowBox[{"p", " ", "v"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "w"}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "u"}], "+", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "v"}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}], " ", "w"}], 
          ")"}]}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHaimovTriangle", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}]}]}], ",", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}]}], ",", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], ",", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}]}]}], "}"}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bTangentialTriangle", "[", 
    RowBox[{"crv_", ",", "a1_", ",", "b1_", ",", "c1_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ta", ",", "tb", ",", "tc", ",", "a2", ",", "b2", ",", "c2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ta", "=", 
       RowBox[{
        RowBox[{"bPolar", "[", 
         RowBox[{"crv", ",", "a1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tb", "=", 
       RowBox[{
        RowBox[{"bPolar", "[", 
         RowBox[{"crv", ",", "b1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tc", "=", 
       RowBox[{
        RowBox[{"bPolar", "[", 
         RowBox[{"crv", ",", "c1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"tb", ",", "tc"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"tc", ",", "ta"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"ta", ",", "tb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"a2", ",", "b2", ",", "c2"}], "}"}]}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bTangentialTriangle2", "[", 
   RowBox[{"crv_", ",", "a1_", ",", "b1_", ",", "c1_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ta", ",", "tb", ",", "tc", ",", "a2", ",", "b2", ",", "c2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ta", "=", 
      RowBox[{
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"bImplicitTangent", "[", 
         RowBox[{"crv", ",", "a1"}], "]"}], "]"}], "//", "bLineFromEq"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"tb", "=", 
      RowBox[{
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"bImplicitTangent", "[", 
         RowBox[{"crv", ",", "b1"}], "]"}], "]"}], "//", "bLineFromEq"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"tc", "=", 
      RowBox[{
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"bImplicitTangent", "[", 
         RowBox[{"crv", ",", "c1"}], "]"}], "]"}], "//", "bLineFromEq"}]}], 
     ";", " ", "\[IndentingNewLine]", 
     RowBox[{"a2", "=", 
      RowBox[{
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"tb", ",", "tc"}], "]"}], "//", 
       "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"b2", "=", 
      RowBox[{
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"tc", ",", "ta"}], "]"}], "//", 
       "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"c2", "=", 
      RowBox[{
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"ta", ",", "tb"}], "]"}], "//", 
       "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"a2", ",", "b2", ",", "c2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 Background->RGBColor[1, 0.925, 0.925],
 CellLabel->
  "In[570]:=",ExpressionUUID->"a42a917b-d9c5-4a4a-9de2-720df6996073"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bMidpoint", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "b", "]"}], "*", "a"}], "+", 
         RowBox[{
          RowBox[{"Total", "[", "a", "]"}], "*", "b"}]}]}], "}"}], ",", " ", 
      RowBox[{"m", "/", 
       RowBox[{"Total", "[", "m", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCentroid", "[", 
     RowBox[{"{", 
      RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], "]"}], ":=", 
    RowBox[{"Cross", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{
         RowBox[{"bMidpoint", "[", 
          RowBox[{"pa", ",", "pb"}], "]"}], ",", "pc"}], "]"}], "//", 
       "simplifyRationalBarycentrics"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{
         RowBox[{"bMidpoint", "[", 
          RowBox[{"pa", ",", "pc"}], "]"}], ",", "pb"}], "]"}], "//", 
       "simplifyRationalBarycentrics"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsogonalConjugate", "[", "po_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"po", "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       RowBox[{"po", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], 
       RowBox[{"po", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{"po", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], 
       RowBox[{"po", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       RowBox[{"po", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsogonalConjugateGeneral", "[", 
     RowBox[{"ptx_", ",", 
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"inc", ",", "la", ",", "lb"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"inc", "=", 
        RowBox[{
         RowBox[{"bCoordChangeK", "[", 
          RowBox[{"1", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"la", "=", 
        RowBox[{
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"pa", ",", "ptx"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"pa", ",", "inc"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lb", "=", 
        RowBox[{
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"pb", ",", "ptx"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"pb", ",", "inc"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"la", ",", "lb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cevian", " ", "quotient", " ", "or", " ", "Ceva"}], "-", 
    "conjugate"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCevianQuotient", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r"}], " ", "u", " ", "v"}], "-", 
         RowBox[{"q", " ", "u", " ", "w"}], "+", 
         RowBox[{"p", " ", "v", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r"}], " ", "u", " ", "v"}], "+", 
         RowBox[{"q", " ", "u", " ", "w"}], "-", 
         RowBox[{"p", " ", "v", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u", " ", "v"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q", " ", "u"}], "+", 
            RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}]}], ")"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"cevian", " ", "product", " ", "or", " ", "Ceva"}], "-", 
    "point"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCevianProduct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", "v"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", "v"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrosspoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"q", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrosspointGeneral", "[", 
     RowBox[{"pp_", ",", "pq_", ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}], ",", 
      RowBox[{"simplify_", ":", "True"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "smpl", ",", "a1", ",", "b1", ",", "c1", ",", "a2", ",", "b2", ",", 
        "c2", ",", "a3", ",", "b3", ",", "c3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"introduce", " ", "helper", " ", "function"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{"simplify", ",", 
         RowBox[{"smpl", "=", "simplifyRationalBarycentrics"}], ",", 
         RowBox[{
          RowBox[{"smpl", "[", "xvar_", "]"}], "=", "xvar"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a1", ",", "b1", ",", "c1"}], "}"}], "=", 
        RowBox[{
         RowBox[{"bCevianTriangleGeneral", "[", 
          RowBox[{"pp", ",", "xa", ",", "xb", ",", "xc"}], "]"}], "//", 
         "smpl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a2", ",", "b2", ",", "c2"}], "}"}], "=", 
        RowBox[{
         RowBox[{"bCevianTriangleGeneral", "[", 
          RowBox[{"pq", ",", "xa", ",", "xb", ",", "xc"}], "]"}], "//", 
         "smpl"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a3", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xa", ",", "a2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"b1", ",", "c1"}], "]"}]}], "]"}], "//", "smpl"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"b3", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xb", ",", "b2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "c1"}], "]"}]}], "]"}], "//", "smpl"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c3", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xc", ",", "c2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "b1"}], "]"}]}], "]"}], "//", "smpl"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"a1", ",", "a3"}], "]"}], ",", 
          RowBox[{"bLine", "[", 
           RowBox[{"b1", ",", "b3"}], "]"}]}], "]"}], "//", "smpl"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bTripole", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "r"}], " ", "v"}], "+", 
        RowBox[{"q", " ", "w"}]}]], ",", 
      FractionBox["1", 
       RowBox[{
        RowBox[{"r", " ", "u"}], "-", 
        RowBox[{"p", " ", "w"}]}]], ",", 
      FractionBox["1", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "q"}], " ", "u"}], "+", 
        RowBox[{"p", " ", "v"}]}]]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bTripoleL", "[", "L1_", "]"}], ":=", 
    RowBox[{"1", "/", "L1"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "\[Minus]", 
    RowBox[{"crossconjugate", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "q"}], " ", "r", " ", "u"}], "-", 
         RowBox[{"p", " ", "r", " ", "v"}], "+", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "r", " ", "u"}], "-", 
         RowBox[{"p", " ", "r", " ", "v"}], "+", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "r", " ", "u"}], "-", 
         RowBox[{"p", " ", "r", " ", "v"}], "-", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "r", " ", "u"}], "+", 
         RowBox[{"p", " ", "r", " ", "v"}], "-", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "r", " ", "u"}], "-", 
         RowBox[{"p", " ", "r", " ", "v"}], "-", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "r", " ", "u"}], "-", 
         RowBox[{"p", " ", "r", " ", "v"}], "+", 
         RowBox[{"p", " ", "q", " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "cyclocevian", " ", "conjugate", " ", "of", " ", "P", " ", 
    "\[IndentingNewLine]", "It", " ", "is", " ", "also", " ", "defined", " ", 
    RowBox[{"as", ":", " ", "\[IndentingNewLine]", 
     RowBox[{"bIsotomicConjugate", "[", "\[IndentingNewLine]", 
      RowBox[{"bAntiComplement", "[", 
       RowBox[{
        RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"bIsogonalConjugate", "[", "\[IndentingNewLine]", 
         RowBox[{"bComplement", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
           RowBox[{"bIsotomicConjugate", "[", 
            RowBox[{"{", 
             RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCyclocevianConjugate", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["a", "2"], " ", "v", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", "u", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}]], ",", 
      FractionBox["1", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}]}], "-", 
        RowBox[{"u", " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}], " ", "w"}], "-", 
           RowBox[{
            SuperscriptBox["c", "2"], " ", "v", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}]}]], ",", 
      FractionBox["1", 
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "u", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{"v", "+", "w"}], ")"}]}], "-", 
        RowBox[{"v", " ", 
         RowBox[{"(", 
          RowBox[{"u", "+", "w"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}], " ", "w"}], "+", 
           RowBox[{
            SuperscriptBox["c", "2"], " ", "u", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}]]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bZayinConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["b", "2"]}], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "p"}], "+", 
            RowBox[{"a", " ", "r"}]}], ")"}], " ", "u"}], "+", 
         RowBox[{"a", " ", "c", " ", 
          SuperscriptBox["q", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "c"}], " ", "u"}], "+", 
            RowBox[{"a", " ", "w"}]}], ")"}]}], "+", 
         RowBox[{"b", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["c", "2"]}], " ", "p", " ", "q", " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["r", "2"], " ", "v"}], "+", 
            RowBox[{"a", " ", "c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "q", " ", "r", " ", "u"}], "+", 
               RowBox[{"p", " ", "r", " ", "v"}], "+", 
               RowBox[{"p", " ", "q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ",", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "2"]}], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "q"}], "+", 
            RowBox[{"b", " ", "r"}]}], ")"}], " ", "v"}], "+", 
         RowBox[{"b", " ", "c", " ", 
          SuperscriptBox["p", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "c"}], " ", "v"}], "+", 
            RowBox[{"b", " ", "w"}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["r", "2"], " ", "u"}], "-", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", "p", " ", "q", " ", "v"}], "+", 
            RowBox[{"b", " ", "c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q", " ", "r", " ", "u"}], "-", 
               RowBox[{"2", " ", "p", " ", "r", " ", "v"}], "+", 
               RowBox[{"p", " ", "q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ",", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "2"]}], " ", "q", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "q"}], "+", 
            RowBox[{"b", " ", "r"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{"b", " ", "c", " ", 
          SuperscriptBox["p", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"c", " ", "v"}], "-", 
            RowBox[{"b", " ", "w"}]}], ")"}]}], "+", 
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             SuperscriptBox["q", "2"], " ", "u"}], "-", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", "p", " ", "r", " ", "w"}], "+", 
            RowBox[{"b", " ", "c", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q", " ", "r", " ", "u"}], "+", 
               RowBox[{"p", " ", "r", " ", "v"}], "-", 
               RowBox[{"2", " ", "p", " ", "q", " ", "w"}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bWawConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"r", " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", "q", " ", "u"}], "+", 
            RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["q", "2"], " ", 
             SuperscriptBox["u", "2"]}], "-", 
            RowBox[{"p", " ", "q", " ", "u", " ", "v"}], "+", 
            RowBox[{
             SuperscriptBox["p", "2"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"r", " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q", " ", "u"}], "+", 
            RowBox[{"4", " ", "p", " ", "v"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["q", "2"], " ", 
             SuperscriptBox["u", "2"]}], "-", 
            RowBox[{"p", " ", "q", " ", "u", " ", "v"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["p", "2"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{"r", " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q", " ", "u"}], "+", 
            RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", " ", "u"}], "-", 
             RowBox[{"p", " ", "v"}]}], ")"}], "2"], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "\[Minus]", 
    RowBox[{"anticomplement", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAntiComplement", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u", " ", "v"}], "+", 
         RowBox[{"q", " ", "u", " ", "w"}], "-", 
         RowBox[{"p", " ", "v", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u", " ", "v"}], "-", 
         RowBox[{"q", " ", "u", " ", "w"}], "+", 
         RowBox[{"p", " ", "v", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "r"}], " ", "u", " ", "v"}], "+", 
         RowBox[{"q", " ", "u", " ", "w"}], "+", 
         RowBox[{"p", " ", "v", " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAntitomicConjugate", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["v", "2"], "-", 
         RowBox[{"u", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "u"}], " ", "v"}], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], ",", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "-", 
         RowBox[{"v", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "u"}], " ", "v"}], "+", 
         SuperscriptBox["w", "2"]}], ")"}]}], ",", 
      RowBox[{"w", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["v", "2"], "-", 
         RowBox[{"u", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["u", "2"], "-", 
         RowBox[{"v", " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "\[Minus]", 
    RowBox[{"complement", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bComplement", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["u", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["v", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", "w"}]}], ")"}]}], ",", " ", 
      RowBox[{
       SuperscriptBox["w", "2"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", "v"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bLozadaPerspector", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "a"}], "+", "b", "+", "c"}], ")"}], " ", 
      SuperscriptBox["u", "2"]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "-", "b", "+", "c"}], ")"}], " ", 
      SuperscriptBox["v", "2"]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"a", "+", "b", "-", "c"}], ")"}], " ", 
      SuperscriptBox["w", "2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLozadaPerspector2nd", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "-", "b", "+", "c"}], ")"}], " ", 
       SuperscriptBox["u", "2"]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "+", "c"}], ")"}], " ", 
       SuperscriptBox["v", "2"]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "-", "b", "+", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "a"}], "+", "b", "+", "c"}], ")"}], " ", 
       SuperscriptBox["w", "2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Q", "\[Minus]", 
    RowBox[{"Hirst", " ", "inverse", " ", "of", " ", "P"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHirstInverse", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"-", "q"}], " ", "r", " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["p", "2"], " ", "v", " ", "w"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "p"}], " ", "r", " ", 
        SuperscriptBox["v", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", "u", " ", "w"}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["r", "2"], " ", "u", " ", "v"}], "-", 
       RowBox[{"p", " ", "q", " ", 
        SuperscriptBox["w", "2"]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "q", ",", "r"}], "}"}], "-", 
    RowBox[{"reciprocal", " ", "conjugate", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "w"}], "}"}]}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bReciprocalConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", " ", "v", " ", "w"}], ",", 
      RowBox[{"q", " ", "u", " ", "w"}], ",", 
      RowBox[{"r", " ", "u", " ", "v"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"P", "-", 
    RowBox[{"aleph", " ", "conjugate", " ", "of", " ", "U"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAlephConjugate", "[", 
     RowBox[{"P1_", ",", "U1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq", ",", "eq2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"pp", ",", "qq", ",", "rr", ",", "uu", ",", "vv", ",", "ww"}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["qq", "2"]}], 
            SuperscriptBox["rr", "2"], 
            SuperscriptBox["uu", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["rr", "2"], 
            SuperscriptBox["pp", "2"], 
            SuperscriptBox["vv", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["pp", "2"], 
            SuperscriptBox["qq", "2"], 
            SuperscriptBox["ww", "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"vv", " ", "ww"}], "+", 
              RowBox[{"ww", " ", "uu"}], "+", 
              RowBox[{"uu", " ", "vv"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                SuperscriptBox["qq", "2"]}], 
               SuperscriptBox["rr", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["rr", "2"], 
               SuperscriptBox["pp", "2"]}], "+", 
              RowBox[{
               SuperscriptBox["pp", "2"], 
               SuperscriptBox["qq", "2"]}]}], ")"}]}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pp", "->", 
            RowBox[{"pp", "/", "a"}]}], ",", 
           RowBox[{"qq", "->", 
            RowBox[{"qq", "/", "b"}]}], ",", 
           RowBox[{"rr", "->", 
            RowBox[{"rr", "/", "c"}]}], ",", 
           RowBox[{"uu", "->", 
            RowBox[{"uu", "/", "a"}]}], ",", 
           RowBox[{"vv", "->", 
            RowBox[{"vv", "/", "b"}]}], ",", 
           RowBox[{"ww", "->", 
            RowBox[{"ww", "/", "c"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq2", "=", 
        RowBox[{"symmetrizeInternal", "[", "eq", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"bFromTrilinear", "[", 
          RowBox[{
           RowBox[{"eq2", "/.", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "->", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], ",", "P1"}], 
               "}"}]}], "]"}]}], "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "->", "#2"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"uu", ",", "vv", ",", "ww"}], "}"}], ",", "U1"}], 
              "}"}]}], "]"}]}], "]"}], ")"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "-", 
    RowBox[{"anticomplementary", " ", "conjugate", " ", "of", " ", "uu"}]}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAnticomplementaryConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"p", "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q", "+", "r"}], ")"}], " ", "u", " ", "v"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], "-", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "r"}], ")"}], " ", "v"}]}], ")"}], " ", "w"}]}],
       ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["c", "3"], " ", 
        RowBox[{"(", 
         RowBox[{"p", "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q", "+", "r"}], ")"}], " ", "u", " ", "v"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "3"]}], " ", 
           RowBox[{"(", 
            RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], "+", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "r"}], ")"}], " ", "v"}]}], ")"}], " ", "w"}]}],
       ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["c", "3"]}], " ", 
        RowBox[{"(", 
         RowBox[{"p", "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"q", "+", "r"}], ")"}], " ", "u", " ", "v"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"p", "+", "q"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], "+", 
          RowBox[{
           SuperscriptBox["a", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"p", "+", "r"}], ")"}], " ", "v"}]}], ")"}], " ", 
        "w"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "-", 
    RowBox[{"complementary", " ", "conjugate", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bComplementaryConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q", "-", "r"}], ")"}], " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "-", "q", "+", "r"}], ")"}], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "+", "q", "-", "r"}], ")"}], " ", "w"}]}], ")"}]}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "-", "q", "+", "r"}], ")"}], " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "-", "q", "-", "r"}], ")"}], " ", "u"}], "-", 
         RowBox[{
          SuperscriptBox["a", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "+", "q", "-", "r"}], ")"}], " ", "w"}]}], ")"}]}], 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "+", "q", "-", "r"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "-", "q", "-", "r"}], ")"}], " ", "u"}], "-", 
         RowBox[{
          SuperscriptBox["a", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"p", "-", "q", "+", "r"}], ")"}], " ", "v"}]}], ")"}], " ",
        "w"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"P", "-", 
    RowBox[{"beth", " ", "conjugate", " ", "of", " ", "U"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bBethConjugate", "[", 
     RowBox[{"P1_", ",", "U1_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq", ",", " ", "eq2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Clear", "[", 
        RowBox[{"pp", ",", "qq", ",", "rr", ",", "uu", ",", "vv", ",", "ww"}],
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "a", " ", "b", " ", "c", " ", "pp", 
            RowBox[{"(", 
             RowBox[{
              FractionBox[
               RowBox[{
                SuperscriptBox["a", "2"], "-", 
                SuperscriptBox["b", "2"], "+", 
                SuperscriptBox["c", "2"]}], 
               RowBox[{"2", "a", " ", "c"}]], "+", 
              FractionBox[
               RowBox[{
                SuperscriptBox["a", "2"], "+", 
                SuperscriptBox["b", "2"], "-", 
                SuperscriptBox["c", "2"]}], 
               RowBox[{"2", " ", "a", " ", "b"}]]}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"uu", " ", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"b", "+", "c", "-", "a"}], ")"}], "pp"]}], "+", 
              RowBox[{"vv", " ", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"a", "+", "c", "-", "b"}], ")"}], "qq"]}], "+", 
              RowBox[{"ww", " ", 
               FractionBox[
                RowBox[{"(", 
                 RowBox[{"a", "+", "b", "-", "c"}], ")"}], "rr"]}]}], ")"}]}],
            "-", 
           RowBox[{"uu", 
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "+", "c"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"b", "+", "c", "-", "a"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"a", "+", "c", "-", "b"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "-", "c"}], ")"}]}]}], ")"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"pp", "->", 
            RowBox[{"pp", "/", "a"}]}], ",", 
           RowBox[{"qq", "->", 
            RowBox[{"qq", "/", "b"}]}], ",", 
           RowBox[{"rr", "->", 
            RowBox[{"rr", "/", "c"}]}], ",", 
           RowBox[{"uu", "->", 
            RowBox[{"uu", "/", "a"}]}], ",", 
           RowBox[{"vv", "->", 
            RowBox[{"vv", "/", "b"}]}], ",", 
           RowBox[{"ww", "->", 
            RowBox[{"ww", "/", "c"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq2", "=", 
        RowBox[{"symmetrizeInternal", "[", "eq", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"bFromTrilinear", "[", 
         RowBox[{
          RowBox[{"eq2", "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#1", "->", "#2"}], "&"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], ",", "P1"}], 
              "}"}]}], "]"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "->", "#2"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"uu", ",", "vv", ",", "ww"}], "}"}], ",", "U1"}], 
             "}"}]}], "]"}]}], "]"}], ")"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"crossdifference", " ", "of", " ", "P", " ", "of", " ", "Q"}], " ",
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossDiff", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "-", 
         RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"p", " ", "w"}], " ", "-", 
         RowBox[{"r", " ", "u"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "-", 
         RowBox[{"p", " ", "v"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"cross", "-", 
    RowBox[{"sum", " ", "of", " ", "P", " ", "of", " ", "Q"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossSum", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "v"}], "+", 
         RowBox[{"q", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", " ", "u"}], "+", 
         RowBox[{"p", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q", " ", "u"}], "+", 
         RowBox[{"p", " ", "v"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "-", 
    RowBox[{"isogonal", " ", "conjugate", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPIsogonalConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "3"], " ", "q", " ", "r", " ", "v", " ", "w"}], 
      ",", 
      RowBox[{
       SuperscriptBox["b", "3"], " ", "p", " ", "r", " ", "u", " ", "w"}], 
      ",", 
      RowBox[{
       SuperscriptBox["c", "3"], " ", "p", " ", "q", " ", "u", " ", "v"}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"p1", "-", 
    RowBox[{"dao", " ", "conjugate", " ", "of", " ", "p2"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bDaoConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", " ", "r", " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "u"}], "+", "v", "+", "w"}], ")"}]}], ",", 
      RowBox[{"p", " ", "r", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "v", "+", "w"}], ")"}]}], ",", 
      RowBox[{"p", " ", "q", " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", "v", "-", "w"}], ")"}], " ", "w"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "-", 
    RowBox[{"vertex", " ", "conjugate", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bVertexConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "4"]}], " ", "p", " ", "q", " ", "u", " ", 
          "v"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "p"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "q"}]}], ")"}], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w"}]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "p", " ", "q", " ", "u", " ", "v"}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["b", "4"]}], " ", "p", " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", "q", " ", "v"}]}], ")"}], " ", 
          "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["c", "2"], " ", "q", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "u"}], "+", 
            RowBox[{"p", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "4"]}], " ", "p", " ", "q", " ", "u", " ", 
          "v"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "p"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "q"}]}], ")"}], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w"}]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "p", " ", "q", " ", "u", " ", "v"}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "4"], " ", "p", " ", "u"}], "-", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", "q", " ", "v"}]}], ")"}], " ", 
          "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"], " ", "p", " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "v"}], "+", 
            RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "p", " ", "q", " ", "u", " ", "v"}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["b", "4"]}], " ", "p", " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", "q", " ", "v"}]}], ")"}], " ", 
          "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["c", "2"], " ", "q", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "u"}], "+", 
            RowBox[{"p", " ", "w"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "p", " ", "q", " ", "u", " ", "v"}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "4"], " ", "p", " ", "u"}], "-", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", "q", " ", "v"}]}], ")"}], " ", 
          "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"], " ", "p", " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "v"}], "+", 
            RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bTCCPerspector", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "4"]}], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["b", "4"]}], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "4"]}], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "4"], " ", 
             SuperscriptBox["u", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "4"], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "4"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"bCevianQuotient", "[", 
    RowBox[{"P1", ",", 
     RowBox[{"bIsogonalConjugate", "[", "P1", "]"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bEigentransform", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", "v", " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "2"]}], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["b", "2"]}], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "u", " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "2"]}], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["u", "2"]}], "-", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["u", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             SuperscriptBox["v", "2"]}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", " ", "isotomic", " ", "conjugate"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsotomicConjugate", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"v", " ", "w"}], ",", 
      RowBox[{"u", " ", "w"}], ",", 
      RowBox[{"u", " ", "v"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "Zosma", " ", "transform", " ", "of", " ", "a", " ", "point", 
    " ", "P", " ", "is", " ", "the", " ", "isogonal", " ", "conjugate", " ", 
    "of", " ", "the", " ", "inverse", " ", "Mimosa", " ", "transform", " ", 
    "of", " ", "P"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bZosmaTransform", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "v"}], "+", 
         RowBox[{"b", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "+", 
         SuperscriptBox["b", "2"], "-", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "u"}], "+", 
         RowBox[{"a", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{"c", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["a", "2"], "-", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], "+", 
         SuperscriptBox["b", "2"], "+", 
         SuperscriptBox["c", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"b", " ", "u"}], "+", 
         RowBox[{"a", " ", "v"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bOrthoassociate", "[", "P1_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq", ",", "g"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{
         "a_", ",", "b_", ",", "c_", ",", "p_", ",", "q_", ",", "r_"}], "]"}],
         ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"q", "+", "r"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["b", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"p", "+", "q", "-", "r"}], ")"}]}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], " ", 
               RowBox[{"(", 
                RowBox[{"p", "-", "q", "+", "r"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["q", "2"], "+", 
              SuperscriptBox["r", "2"], "+", 
              RowBox[{"p", " ", 
               RowBox[{"(", 
                RowBox[{"q", "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"a", ",", "b", ",", "c", ",", "pp", ",", "qq", ",", "rr"}],
            "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{
           "b", ",", "c", ",", "a", ",", "qq", ",", "rr", ",", " ", "pp"}], 
           "]"}], ",", 
          RowBox[{"g", "[", 
           RowBox[{"c", ",", "a", ",", "b", ",", "rr", ",", "pp", ",", "qq"}],
            "]"}]}], "}"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pp", ",", "qq", ",", "rr"}], "}"}], "->", "P1"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"pp", "-", 
    RowBox[{"line", " ", "conjugate", " ", "of", " ", "uu"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLineConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "q", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q", " ", "u"}], "-", 
            RowBox[{"p", " ", "v"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "u"}], "-", 
            RowBox[{"p", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "p", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "q"}], " ", "u"}], "+", 
            RowBox[{"p", " ", "v"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", "v"}], "-", 
            RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "p", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r"}], " ", "u"}], "+", 
            RowBox[{"p", " ", "w"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "q", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "r"}], " ", "v"}], "+", 
            RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bTrilinearProduct", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", " ", "c", " ", "p", " ", "u"}], ",", 
      RowBox[{"c", " ", "a", " ", "q", " ", "v"}], ",", 
      RowBox[{"a", " ", "b", " ", "r", " ", "w"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Saragossa", " ", "Points", " ", "X", 
    RowBox[{"(", "1166", ")"}], " ", "for", " ", "barycentric", " ", 
    RowBox[{"(", 
     RowBox[{"x", ",", "y", ",", "z"}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSaragossa1", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSaragossa2", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "u", " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["u", "2"], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "4"], " ", 
          SuperscriptBox["u", "2"], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["v", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSaragossa3", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", "u", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", "u", " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["v", "2"], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", "v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "4"], " ", 
          SuperscriptBox["u", "2"], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["u", "2"], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v"}]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", "w", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["u", "2"], " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "4"], " ", 
          SuperscriptBox["u", "2"], " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["v", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["c", "2"], " ", "u"}], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCirclecevianPerspector", "[", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "p", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "r"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["q", "2"], " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "p", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "q"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "p", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "p", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "q", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "q"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "r"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["q", "2"], " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "q", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "q"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "p", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "p", " ", 
          SuperscriptBox["r", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "q", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "p", " ", 
          SuperscriptBox["q", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "r"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["q", "2"], " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "p", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "q"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          SuperscriptBox["p", "2"], " ", "r"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "p", " ", "q", " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["q", "2"], " ", "r"}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "q", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Orthopole", " ", "of", " ", "LINE", " ", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v", ",", "w"}], "}"}], " ", "wrt", " ", "ABC"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bOrthopole", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], " ", "u"}], "-", 
         RowBox[{"SC", " ", "v"}], "-", 
         RowBox[{"SB", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"SB", " ", "SC", " ", "u"}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "SB", " ", "v"}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "SC", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "SC"}], " ", "u"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "v"}], "-", 
         RowBox[{"SA", " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "2"]}], " ", "SA", " ", "u"}], "+", 
         RowBox[{"SA", " ", "SC", " ", "v"}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "SC", " ", "w"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "SB"}], " ", "u"}], "-", 
         RowBox[{"SA", " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "w"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["a", "2"]}], " ", "SA", " ", "u"}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "SB", " ", "v"}], "+", 
         RowBox[{"SA", " ", "SB", " ", "w"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Orthopole", " ", "of", " ", "LINE", " ", 
    RowBox[{"{", 
     RowBox[{"u", ",", "v", ",", "w"}], "}"}], " ", "wrt", " ", "XaXbXc"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bOrthopoleGen", "[", 
     RowBox[{"l_", ",", 
      RowBox[{"xa_", ":", "xA"}], ",", 
      RowBox[{"xb_", ":", "xB"}], ",", 
      RowBox[{"xc_", ":", "xC"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ha", ",", "hb", ",", "hc", ",", "la", ",", "lb"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ha", "=", 
        RowBox[{"bFootPerpendicular", "[", 
         RowBox[{"l", ",", "xa"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hb", "=", 
        RowBox[{"bFootPerpendicular", "[", 
         RowBox[{"l", ",", "xb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hc", "=", 
        RowBox[{"bFootPerpendicular", "[", 
         RowBox[{"l", ",", "xc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"la", "=", 
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"xb", ",", "xc"}], "]"}], ",", "ha"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lb", "=", 
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"xa", ",", "xc"}], "]"}], ",", "hb"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Cross", "[", 
         RowBox[{"la", ",", "lb"}], "]"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bOrthopoleGenSimplify", "[", 
    RowBox[{"l_", ",", 
     RowBox[{"xa_", ":", "xA"}], ",", 
     RowBox[{"xb_", ":", "xB"}], ",", 
     RowBox[{"xc_", ":", "xC"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ha", ",", "hb", ",", "hc", ",", "la", ",", "lb"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ha", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"bFootPerpendicular", "[", 
          RowBox[{"l", ",", "xa"}], "]"}], "//", "partialSReplace"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"hb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"bFootPerpendicular", "[", 
          RowBox[{"l", ",", "xb"}], "]"}], "//", "partialSReplace"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"hc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"bFootPerpendicular", "[", 
          RowBox[{"l", ",", "xc"}], "]"}], "//", "partialSReplace"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"la", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"bPerpendicular", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xb", ",", "xc"}], "]"}], ",", "ha"}], "]"}], "//", 
         "partialSReplace"}], "//", "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"lb", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"bPerpendicular", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xa", ",", "xc"}], "]"}], ",", "hb"}], "]"}], "//", 
         "partialSReplace"}], "//", "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"Return", "[", 
       RowBox[{"simplifyRationalBarycentrics", "[", 
        RowBox[{"la", "\[Cross]", "lb"}], "]"}], "]"}], ";"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "antigonal", " ", "image", " ", "of", " ", "the", " ", 
    "anticomplement", " ", "of", " ", 
    RowBox[{"P", ".", " ", "Also"}], " ", "called", " ", 
    RowBox[{"symgonal", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSyngonal", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["c", "2"], " ", "u", " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v", "-", "w"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v", "-", "w"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "v", "-", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "+", "w"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["c", "2"], " ", "u", " ", "v"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v", "-", "w"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "v", "-", "w"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"u", "-", "v", "+", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "-", "w"}], ")"}], " ", "w"}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "u"}], "+", "v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"u", "+", "v", "-", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "+", "w"}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "+", "w"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}], "+", 
         RowBox[{
          SuperscriptBox["b", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"u", "-", "v", "-", "w"}], ")"}], " ", "w"}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "u"}], "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"A", ",", "B"}], "}"}], "-", 
    RowBox[{"harmonic", " ", "conjugate", " ", "of", " ", "C"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHarmonicConjugate", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c1_", ",", "c2_", ",", "c3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a3", " ", "b1", " ", "c1"}], "+", 
       RowBox[{"a1", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"2", " ", "a1", " ", "b1", " ", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"a3", " ", "b2", " ", "c1"}], "+", 
       RowBox[{"a2", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"a2", " ", "b1", " ", "c3"}], "-", 
       RowBox[{"a1", " ", "b2", " ", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"2", " ", "a3", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"a3", " ", "b1", " ", "c3"}], "-", 
       RowBox[{"a1", " ", "b3", " ", "c3"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHarmonicConjugateFull", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c1_", ",", "c2_", ",", "c3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a2", " ", "b1", " ", "c1"}], "-", 
       RowBox[{"a3", " ", "b1", " ", "c1"}], "+", 
       RowBox[{"a1", " ", "b2", " ", "c1"}], "-", 
       RowBox[{"a1", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"2", " ", "a1", " ", "b1", " ", "c2"}], "+", 
       RowBox[{"a3", " ", "b1", " ", "c2"}], "+", 
       RowBox[{"a1", " ", "b3", " ", "c2"}], "+", 
       RowBox[{"2", " ", "a1", " ", "b1", " ", "c3"}], "-", 
       RowBox[{"a2", " ", "b1", " ", "c3"}], "-", 
       RowBox[{"a1", " ", "b2", " ", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"2", " ", "a2", " ", "b2", " ", "c1"}], "-", 
       RowBox[{"a3", " ", "b2", " ", "c1"}], "-", 
       RowBox[{"a2", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"a2", " ", "b1", " ", "c2"}], "-", 
       RowBox[{"a1", " ", "b2", " ", "c2"}], "+", 
       RowBox[{"a3", " ", "b2", " ", "c2"}], "+", 
       RowBox[{"a2", " ", "b3", " ", "c2"}], "+", 
       RowBox[{"a2", " ", "b1", " ", "c3"}], "+", 
       RowBox[{"a1", " ", "b2", " ", "c3"}], "-", 
       RowBox[{"2", " ", "a2", " ", "b2", " ", "c3"}]}], ",", 
      RowBox[{
       RowBox[{"a3", " ", "b2", " ", "c1"}], "+", 
       RowBox[{"a2", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"2", " ", "a3", " ", "b3", " ", "c1"}], "-", 
       RowBox[{"a3", " ", "b1", " ", "c2"}], "-", 
       RowBox[{"a1", " ", "b3", " ", "c2"}], "+", 
       RowBox[{"2", " ", "a3", " ", "b3", " ", "c2"}], "+", 
       RowBox[{"a3", " ", "b1", " ", "c3"}], "-", 
       RowBox[{"a3", " ", "b2", " ", "c3"}], "+", 
       RowBox[{"a1", " ", "b3", " ", "c3"}], "-", 
       RowBox[{"a2", " ", "b3", " ", "c3"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bCollingsTransform", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["b", "2"]}], " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "v", "-", "w"}], ")"}], " ", "w"}], "+", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{"u", "-", "v", "+", "w"}], ")"}]}]}]], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "v", "-", "w"}], ")"}], " ", "w"}], "-", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "u"}], "+", "v", "+", "w"}], ")"}]}]}]], ",", 
     FractionBox["1", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["a", "2"]}], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{"u", "-", "v", "+", "w"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "u"}], "+", "v", "+", "w"}], ")"}]}]}]]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bSteinerImage", "[", 
    RowBox[{"{", 
     RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["p", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["p", "2"]}], "+", 
       RowBox[{"p", " ", "q"}], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"p", " ", "r"}], "+", 
       RowBox[{"q", " ", "r"}], "+", 
       SuperscriptBox["r", "2"]}]], ",", 
     FractionBox["q", 
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       RowBox[{"p", " ", "q"}], "-", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"p", " ", "r"}], "+", 
       RowBox[{"q", " ", "r"}], "+", 
       SuperscriptBox["r", "2"]}]], ",", 
     FractionBox["r", 
      RowBox[{
       SuperscriptBox["p", "2"], "+", 
       RowBox[{"p", " ", "q"}], "+", 
       SuperscriptBox["q", "2"], "+", 
       RowBox[{"p", " ", "r"}], "+", 
       RowBox[{"q", " ", "r"}], "-", 
       SuperscriptBox["r", "2"]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bDC", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"v", " ", "w"}], 
      RowBox[{
       RowBox[{"b", " ", "v"}], "+", 
       RowBox[{"c", " ", "w"}]}]], ",", 
     FractionBox[
      RowBox[{"u", " ", "w"}], 
      RowBox[{
       RowBox[{"a", " ", "u"}], "+", 
       RowBox[{"c", " ", "w"}]}]], ",", 
     FractionBox[
      RowBox[{"u", " ", "v"}], 
      RowBox[{
       RowBox[{"a", " ", "u"}], "+", 
       RowBox[{"b", " ", "v"}]}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCD", "[", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "p", " ", "q"}], "+", 
         RowBox[{"b", " ", "p", " ", "r"}], "-", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "p", " ", "q"}], "+", 
         RowBox[{"b", " ", "p", " ", "r"}], "+", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}]}], ",", 
      RowBox[{"a", " ", "c", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "p", " ", "q"}], "-", 
         RowBox[{"b", " ", "p", " ", "r"}], "+", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "p", " ", "q"}], "+", 
         RowBox[{"b", " ", "p", " ", "r"}], "+", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}]}], ",", 
      RowBox[{"a", " ", "b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "c"}], " ", "p", " ", "q"}], "-", 
         RowBox[{"b", " ", "p", " ", "r"}], "+", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"c", " ", "p", " ", "q"}], "-", 
         RowBox[{"b", " ", "p", " ", "r"}], "+", 
         RowBox[{"a", " ", "q", " ", "r"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"H", "-", "Transform"}], ",", " ", 
    RowBox[{"Preamble", " ", "10025"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bHT", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"q", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["p", "u"], "+", 
         FractionBox["q", "v"], "-", 
         FractionBox["r", "w"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox["p", "u"], "-", 
         FractionBox["q", "v"], "+", 
         FractionBox["r", "w"]}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["p", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["p", "u"]}], "+", 
          FractionBox["q", "v"], "+", 
          FractionBox["r", "w"]}], ")"}], "2"]}]}], "//", "sym3"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"K", "-", "Transform"}], ",", " ", 
    RowBox[{"Preamble", " ", "10025"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bKT", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["p", "2"]}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["q", "u"], "+", 
        FractionBox["r", "v"], "-", 
        FractionBox["p", "w"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["r", "u"], "-", 
        FractionBox["p", "v"], "+", 
        FractionBox["q", "w"]}], ")"}]}], "+", 
     RowBox[{"q", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["q", "u"]}], "+", 
        FractionBox["r", "v"], "+", 
        FractionBox["p", "w"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["r", "u"]}], "+", 
        FractionBox["p", "v"], "+", 
        FractionBox["q", "w"]}], ")"}]}]}], "//", "sym3"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bMiquelAssociate", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", "v"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "2"]}], " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"u", "+", "w"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u", " ", 
             RowBox[{"(", 
              RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", "v"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"v", "+", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["c", "2"]}], " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"u", "+", "w"}], ")"}]}], "-", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u", " ", 
             RowBox[{"(", 
              RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"v", "+", "w"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
          RowBox[{"(", 
           RowBox[{"u", "+", "w"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"v", "+", "w"}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["a", "2"], " ", "v", " ", 
             RowBox[{"(", 
              RowBox[{"u", "+", "w"}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", "u", " ", 
             RowBox[{"(", 
              RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Let", " ", "P", " ", "be", " ", "a", " ", "point"}], ",", " ", 
    RowBox[{"L", " ", "its", " ", 
     RowBox[{"tripolar", ".", "Let"}], " ", 
     RowBox[{"P", "'"}], " ", "be", " ", "the", " ", "infinite", " ", "point",
      " ", "of", " ", "L"}], ",", 
    RowBox[{"and", " ", 
     RowBox[{"L", "'"}], " ", "the", " ", "tripolar", " ", "of", " ", 
     RowBox[{
      RowBox[{"P", "'"}], ".", "The"}], " ", "intersection", " ", "between", 
     " ", "L", " ", "and", " ", 
     RowBox[{"L", "'"}], " ", "is", " ", "the", " ", "point", " ", "TG", 
     RowBox[{"(", "P", ")"}], " ", "called", " ", "the", " ", "tripolar", " ",
      "centroid", " ", "of", " ", 
     RowBox[{"P", "."}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bTripolarCentroid", "[", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "p"}], "+", "q", "+", "r"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "q"}], ")"}]}], ",", 
      RowBox[{"q", " ", 
       RowBox[{"(", 
        RowBox[{"r", "-", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "p"}], "+", 
         RowBox[{"2", " ", "q"}], "-", "r"}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q", "-", "p"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"p", "+", "q", "-", 
         RowBox[{"2", " ", "r"}]}], ")"}], " ", "r"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"groups", ".", "io"}], "/", "g"}], "/", "euclid"}], "/", 
      "message"}], "/", "1285"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bNesbittTransform", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["x", 
       RowBox[{"y", "+", "z"}]], ",", 
      FractionBox["y", 
       RowBox[{"x", "+", "z"}]], ",", 
      FractionBox["z", 
       RowBox[{"y", "+", "x"}]]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPsiInvolution", "[", 
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["u", "2"], "-", 
          SuperscriptBox["v", "2"], "+", 
          RowBox[{"v", " ", "w"}], "-", 
          SuperscriptBox["w", "2"]}], ")"}]}], "-", 
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v", "-", 
             RowBox[{"2", " ", "w"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"u", "-", 
             RowBox[{"2", " ", "v"}], "+", "w"}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["a", "2"]}], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "v", "-", 
          RowBox[{"2", " ", "w"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "u"}], "+", "v", "+", "w"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["u", "2"], "-", 
          SuperscriptBox["v", "2"], "-", 
          RowBox[{"u", " ", "w"}], "+", 
          SuperscriptBox["w", "2"]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["a", "2"]}], " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{"u", "-", 
          RowBox[{"2", " ", "v"}], "+", "w"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "u"}], "+", "v", "+", "w"}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["u", "2"], "-", 
          RowBox[{"u", " ", "v"}], "+", 
          SuperscriptBox["v", "2"], "-", 
          SuperscriptBox["w", "2"]}], ")"}]}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"see", " ", "X", 
    RowBox[{"(", "98", ")"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lambda", "[", 
    RowBox[{"p1_", ",", "q1_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bLine", "[", 
       RowBox[{"p1", ",", "q1"}], "]"}], "//", "bInfinityPoint"}], "//", 
     "bIsogonalConjugate"}], "//", "simplifyRationalBarycentrics"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"psi", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"sym3", "[", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", "v", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"q", " ", "u"}], "-", 
       RowBox[{"p", " ", "v"}]}], ")"}], " ", "w", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", " ", "u"}], "-", 
       RowBox[{"p", " ", "w"}]}], ")"}]}], "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[587]:=",ExpressionUUID->"c8e3f601-a511-415e-a197-a6b942ea57db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPerpendicular", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", " ", "w_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sa", ",", "sb", ",", "sc", ",", " ", "f", " ", ",", " ", "g", " ", 
        ",", " ", "h", ",", " ", "ff", ",", " ", "gg", ",", " ", "hh", ",", 
        " ", "m", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sa", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"], "-", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       RowBox[{"sb", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox["c", "2"], "+", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       RowBox[{"sc", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"], "+", 
           SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"f", "=", 
        RowBox[{"q", "\[Minus]", "r"}]}], ";", 
       RowBox[{"g", "=", 
        RowBox[{"r", "\[Minus]", "p"}]}], ";", " ", 
       RowBox[{"h", "=", 
        RowBox[{"p", "\[Minus]", "q"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ff", " ", "=", " ", 
        RowBox[{
         RowBox[{"sb", "*", "g"}], "-", 
         RowBox[{"sc", "*", "h"}]}]}], ";", " ", 
       RowBox[{"gg", " ", "=", " ", 
        RowBox[{
         RowBox[{"sc", "*", "h"}], "-", 
         RowBox[{"sa", "*", "f"}]}]}], ";", " ", 
       RowBox[{"hh", " ", "=", " ", 
        RowBox[{
         RowBox[{"sa", "*", "f"}], "-", 
         RowBox[{"sb", "*", "g"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", GridBox[{
            {"ff", "gg", "hh"},
            {"u", "v", "w"},
            {"x", "y", "z"}
           }], ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "x"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "y"}], "]"}], ",", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"m", ",", "z"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bFootPerpendicular", "[", 
     RowBox[{"line_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", " ", "w_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "h", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"h", "=", 
        RowBox[{"bPerpendicular", "[", 
         RowBox[{"line", ",", " ", 
          RowBox[{"{", 
           RowBox[{"u", ",", "v", ",", " ", "w"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"h", ",", " ", "line"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bInfinityPoint", "[", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", "-", "r"}], ",", 
      RowBox[{"r", "-", "p"}], ",", 
      RowBox[{"p", "-", "q"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAreLinePerpendicular", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      SuperscriptBox["a", "2"], "x1", " ", "x2"}], " ", "+", 
     RowBox[{
      SuperscriptBox["b", "2"], "y1", " ", "y2"}], "+", 
     RowBox[{
      SuperscriptBox["c", "2"], "z1", " ", "z2"}], "-", 
     RowBox[{"SA", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"y1", " ", "z2"}], "+", 
        RowBox[{"y2", " ", "z1"}]}], ")"}]}], "-", 
     RowBox[{"SB", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"z1", " ", "x2"}], "+", 
        RowBox[{"z2", " ", "x1"}]}], ")"}]}], "-", 
     RowBox[{"SC", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x1", " ", "y2"}], "+", 
        RowBox[{"x2", " ", "y1"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertLine", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "z", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"z", " ", "=", " ", 
        RowBox[{"bIntersection", "[", 
         RowBox[{"aa", ",", "bb", ",", "cc", ",", " ", "dd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bLine", "[", 
        RowBox[{
         RowBox[{"bCoordChangeK", "[", 
          RowBox[{"4", ",", "z", ",", " ", "bb", ",", " ", "cc"}], "]"}], ",", 
         RowBox[{"bCoordChangeK", "[", 
          RowBox[{"4", ",", " ", "z", ",", " ", "aa", ",", " ", "dd"}], 
          "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertLineNew", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "zz", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zz", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bIntersection", "[", 
          RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bLine", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"simplifyRationalBarycentrics", "[", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bPerpendicular", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bLine", "[", 
                  RowBox[{"bb", ",", "cc"}], "]"}], "//", 
                 "simplifyRationalBarycentrics"}], ",", "zz"}], "]"}], "//", 
              "simplifyRationalBarycentrics"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bPerpendicular", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bLine", "[", 
                  RowBox[{"bb", ",", "zz"}], "]"}], "//", 
                 "simplifyRationalBarycentrics"}], ",", "cc"}], "]"}], "//", 
              "simplifyRationalBarycentrics"}]}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"simplifyRationalBarycentrics", "[", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"bPerpendicular", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bLine", "[", 
                  RowBox[{"aa", ",", "dd"}], "]"}], "//", 
                 "simplifyRationalBarycentrics"}], ",", "zz"}], "]"}], "//", 
              "simplifyRationalBarycentrics"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bPerpendicular", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bLine", "[", 
                  RowBox[{"aa", ",", "zz"}], "]"}], "//", 
                 "simplifyRationalBarycentrics"}], ",", "dd"}], "]"}], "//", 
              "simplifyRationalBarycentrics"}]}], "]"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}], "//", 
        "simplifyRationalBarycentrics"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertCenter", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "bb", ",", "dd", ",", " ", "cc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"l1", ",", " ", "l2"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertCenterSimplify", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bAubertLineNew", "[", 
             RowBox[{"aa", ",", "bb", ",", "cc", ",", "dd"}], "]"}], "//", 
            "Simplify"}], ")"}], "/.", 
          RowBox[{"Abs", "->", "RealAbs"}]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bAubertLineNew", "[", 
             RowBox[{"aa", ",", "bb", ",", "dd", ",", " ", "cc"}], "]"}], "//",
             "Simplify"}], ")"}], "/.", 
          RowBox[{"Abs", "->", "RealAbs"}]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"l1", ",", " ", "l2"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertCenter2", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l3"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l1", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "bb", ",", "cc", ",", " ", "dd"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l3", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "dd", ",", "bb", ",", " ", "cc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"l1", ",", " ", "l3"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAubertCenter3", "[", 
     RowBox[{"aa_", ",", "bb_", ",", "cc_", ",", "dd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l2", ",", "l3"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l2", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "bb", ",", "dd", ",", " ", "cc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l3", " ", "=", " ", 
        RowBox[{"bAubertLine", "[", 
         RowBox[{"aa", ",", "dd", ",", "bb", ",", " ", "cc"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{"l2", ",", " ", "l3"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bExsimilicenter", "[", 
     RowBox[{
     "P1_", ",", "P2_", ",", "P3_", ",", "Q1_", ",", "Q2_", ",", "Q3_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rad1", ",", "rad2", ",", "O1", ",", "O2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"O1", "=", 
        RowBox[{"bCircleCenter", "[", 
         RowBox[{"P1", ",", "P2", ",", "P3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"O2", "=", 
        RowBox[{"bCircleCenter", "[", 
         RowBox[{"Q1", ",", "Q2", ",", "Q3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rad1", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O1", ",", "P1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rad2", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O2", ",", "Q2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rad1", "*", 
         FractionBox["O2", 
          RowBox[{"Total", "[", "O2", "]"}]]}], "-", 
        RowBox[{"rad2", "*", 
         FractionBox["O1", 
          RowBox[{"Total", "[", "O1", "]"}]]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bExsimilicenter2", "[", 
     RowBox[{"O1_", ",", "P1_", ",", "O2_", ",", "P2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rad1", ",", "rad2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rad1", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O1", ",", "P1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rad2", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O2", ",", "P2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rad1", "*", 
         FractionBox["O2", 
          RowBox[{"Total", "[", "O2", "]"}]]}], "-", 
        RowBox[{"rad2", "*", 
         FractionBox["O1", 
          RowBox[{"Total", "[", "O1", "]"}]]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bExsimilicenter3", "[", 
     RowBox[{"O1_", ",", "rad1_", ",", "O2_", ",", "rad2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rad1", "*", 
      FractionBox["O2", 
       RowBox[{"Total", "[", "O2", "]"}]]}], "-", 
     RowBox[{"rad2", "*", 
      FractionBox["O1", 
       RowBox[{"Total", "[", "O1", "]"}]]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bInsimilicenter", "[", 
     RowBox[{
     "P1_", ",", "P2_", ",", "P3_", ",", "Q1_", ",", "Q2_", ",", "Q3_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rad1", ",", "rad2", ",", "O1", ",", "O2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"O1", "=", 
        RowBox[{"bCircleCenter", "[", 
         RowBox[{"P1", ",", "P2", ",", "P3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"O2", "=", 
        RowBox[{"bCircleCenter", "[", 
         RowBox[{"Q1", ",", "Q2", ",", "Q3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rad1", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O1", ",", "P1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rad2", " ", "=", " ", 
        RowBox[{"bDistance", "[", 
         RowBox[{"O2", ",", "Q2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rad1", "*", 
         FractionBox["O2", 
          RowBox[{"Total", "[", "O2", "]"}]]}], "+", 
        RowBox[{"rad2", "*", 
         FractionBox["O1", 
          RowBox[{"Total", "[", "O1", "]"}]]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bInsimilicenter2", "[", 
    RowBox[{"O1_", ",", "P1_", ",", "O2_", ",", "P2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rad1", ",", "rad2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rad1", " ", "=", " ", 
       RowBox[{"bDistance", "[", 
        RowBox[{"O1", ",", "P1"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rad2", " ", "=", " ", 
       RowBox[{"bDistance", "[", 
        RowBox[{"O2", ",", "P2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rad1", "*", 
        FractionBox["O2", 
         RowBox[{"Total", "[", "O2", "]"}]]}], "+", 
       RowBox[{"rad2", "*", 
        FractionBox["O1", 
         RowBox[{"Total", "[", "O1", "]"}]]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bInsimilicenter3", "[", 
     RowBox[{"O1_", ",", "O2_", ",", "rad1_", ",", "rad2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"rad1", "*", 
      FractionBox["O2", 
       RowBox[{"Total", "[", "O2", "]"}]]}], "+", 
     RowBox[{"rad2", "*", 
      FractionBox["O1", 
       RowBox[{"Total", "[", "O1", "]"}]]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircleInvervse", "[", 
     RowBox[{"circ_", ",", "pt_"}], "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", 
     RowBox[{
      RowBox[{"bPolar", "[", 
       RowBox[{"circ", ",", "pt"}], "]"}], ",", 
      RowBox[{"bLine", "[", 
       RowBox[{
        RowBox[{"bConicCenter", "[", "circ", "]"}], ",", "pt"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"com", "[", 
    RowBox[{"pt_", ",", "trg_"}], "]"}], ":=", 
   RowBox[{"pt", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "/", 
        RowBox[{"Total", "[", "#", "]"}]}], "&"}], "/@", "trg"}], ")"}]}]}], 
  ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[646]:=",ExpressionUUID->"7db9c1d5-51bd-4160-b9f5-e08877f6539e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"from", " ", "trilinear", " ", "to", " ", "bary"}], " ", "*)"}], 
  " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bFromTrilinear", "[", "p_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", "a"}], ",", " ", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", "b"}], ",", " ", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "*", "c"}]}], "}"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"from", " ", "bary", " ", "to", " ", "trilinear"}], " ", "*)"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bToTril", "[", "p_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "/", "a"}], ",", " ", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", "b"}], ",", " ", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", "c"}]}], "}"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"from", " ", "bary", " ", "to", " ", "cartesian"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bToCartesian", "[", 
      RowBox[{"p_", ",", "PA_", ",", "PB_", ",", "PC_"}], "]"}], ":=", 
     RowBox[{"Dot", "[", 
      RowBox[{
       FractionBox["p", 
        RowBox[{"Total", "[", "p", "]"}]], ",", 
       RowBox[{"{", 
        RowBox[{"PA", ",", "PB", ",", "PC"}], "}"}]}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bToCartesianN", "[", "p_", "]"}], ":=", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"bToCartesian", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"31", "/", "3"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"4", " ", 
               RowBox[{"\[Sqrt]", "35"}]}], ")"}], "/", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "0"}], "}"}]}], "]"}], "/.", "rule69"}], ",", 
       "30"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cToBary", "[", 
      RowBox[{"v1_", ",", "v2_", ",", "v3_", ",", "xy_"}], "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"v2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"v3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"v1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"v2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"v3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"LinearSolve", "[", 
        RowBox[{"mat", ",", 
         RowBox[{"Append", "[", 
          RowBox[{"xy", ",", "1"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setupBaseTriangle", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"y", ",", "z"}], "]"}]}], ",", 
       RowBox[{"b", "->", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], ",", " ", 
       RowBox[{"c", "->", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"setupBaseTriangleBary", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", 
        RowBox[{"bDistance", "[", 
         RowBox[{"y", ",", "z"}], "]"}]}], ",", 
       RowBox[{"b", "->", 
        RowBox[{"bDistance", "[", 
         RowBox[{"x", ",", "z"}], "]"}]}], ",", " ", 
       RowBox[{"c", "->", 
        RowBox[{"bDistance", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setupParamTriangle", ":=", 
     RowBox[{"setupBaseTriangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], 
          RowBox[{"2", " ", "c"}]], ",", 
         FractionBox[
          SqrtBox[
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "4"]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["b", "2"], "-", 
               SuperscriptBox["c", "2"]}], ")"}], "2"], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["b", "2"], "+", 
               SuperscriptBox["c", "2"]}], ")"}]}]}]], 
          RowBox[{"2", " ", "c"}]]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Generates", " ", "ETC", " ", "search", " ", "triple"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bToSearchNumbers", "[", "pt_", "]"}], ":=", 
     RowBox[{
      RowBox[{"S", " ", 
       FractionBox[
        RowBox[{"(", 
         RowBox[{"pt", "/", 
          RowBox[{"Total", "[", "pt", "]"}]}], ")"}], 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c"}], "}"}]]}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "->", "6"}], ",", 
        RowBox[{"b", "->", "9"}], ",", 
        RowBox[{"c", "->", "13"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Converts", " ", "Mathematica", " ", "Expression", " ", "to", " ", 
     "TraditionalForm"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExpressionToTrad", "[", 
      RowBox[{"expr_", ",", 
       RowBox[{"lClearSpaces_", ":", "True"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "sub"}], "}"}], ",", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"ToString", "[", 
          RowBox[{"expr", ",", "InputForm"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Abs\>\"", ",", "\"\<Sqrt\>\"", ",", "\"\<Sign\>\"", ",", 
           "\"\<Log\>\"", ",", "\"\<Log10\>\"", ",", "\"\<Exp\>\"", ",", 
           "\"\<Sin\>\"", ",", "\"\<Cos\>\"", ",", "\"\<Tan\>\"", ",", 
           "\"\<Cot\>\"", ",", "\"\<Sec\>\"", ",", "\"\<Csc\>\"", ",", 
           "\"\<ArcSin\>\"", ",", "\"\<ArcCos\>\"", ",", "\"\<ArcTan\>\"", 
           ",", "\"\<ArcCot\>\"", ",", "\"\<ArcSec\>\"", ",", 
           "\"\<ArcCsc\>\"", ",", "\"\<Sinh\>\"", ",", "\"\<Cosh\>\"", ",", 
           "\"\<Tanh\>\"", ",", "\"\<Coth\>\"", ",", "\"\<Sech\>\"", ",", 
           "\"\<Csch\>\"", ",", "\"\<ArcSinh\>\"", ",", "\"\<ArcCosh\>\"", 
           ",", "\"\<ArcTanh\>\"", ",", "\"\<ArcCoth\>\"", ",", 
           "\"\<ArcSech\>\"", ",", "\"\<ArcCsch\>\""}], "}"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "extend", " ", "this", " ", "list", " ", "if", " ", "necessary"}], 
         "*)"}], 
        RowBox[{"sub", "=", 
         RowBox[{"SortBy", "[", 
          RowBox[{"sub", ",", 
           RowBox[{
            RowBox[{"StringLength", "[", "#", "]"}], "&"}], ",", "Greater"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "<>", "\"\<[\>\""}], ".."}], "->", 
              RowBox[{
               RowBox[{"ToLowerCase", "[", "#", "]"}], "<>", "\"\<[\>\""}]}], 
             ")"}], "&"}], ",", "sub"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"res", ",", "sub"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"StringReplace", "[", 
          RowBox[{"res", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<[\>\"", ".."}], "->", "\"\<(\>\""}], ",", 
             RowBox[{
              RowBox[{"\"\<]\>\"", ".."}], "->", "\"\<)\>\""}], ",", 
             RowBox[{
              RowBox[{"\"\<  \>\"", ".."}], "->", "\"\< \>\""}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"lClearSpaces", ",", 
          RowBox[{"res", "=", 
           RowBox[{"StringReplace", "[", 
            RowBox[{"res", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\< \>\"", ".."}], "->", "\"\<\>\""}], "}"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GetKey", "[", 
      RowBox[{"assoc_", ",", "index_"}], "]"}], ":=", 
     RowBox[{"First", "@", 
      RowBox[{"Keys", "@", 
       RowBox[{"Take", "[", 
        RowBox[{"assoc", ",", 
         RowBox[{"{", "index", "}"}]}], "]"}]}]}]}], ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[664]:=",ExpressionUUID->"7b75e626-99ae-4d70-9a85-249c52780e5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Collect", " ", "for", " ", "multivariate", " ", "polynomials"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"multiCollect", "[", 
      RowBox[{"expr_", ",", "vars_"}], "]"}], ":=", 
     RowBox[{"Activate", "@", 
      RowBox[{"Expand", "@", 
       RowBox[{"Collect", "[", 
        RowBox[{"expr", ",", "vars", ",", 
         RowBox[{"Inactive", "[", "Simplify", "]"}]}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sCollect", "[", 
     RowBox[{"expr_", ",", "vars_"}], "]"}], ":=", 
    RowBox[{"Activate", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Collect", "[", 
        RowBox[{"expr", ",", "vars", ",", 
         RowBox[{"Inactive", "[", "Simplify", "]"}]}], "]"}], "/.", 
       RowBox[{"Simplify", "->", "intFullSimplifyFactors"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"multiCollectFactors", "[", 
      RowBox[{"expr_", ",", "vars_"}], "]"}], ":=", 
     RowBox[{"Times", "@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]], "&"}], ",", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"multiCollect", "[", 
            RowBox[{"#", ",", "vars"}], "]"}], "&"}], ",", 
          RowBox[{"FactorList", "[", "expr", "]"}]}], "]"}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"multiCollectABC", "[", "pt_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "a"}], "]"}], ",", 
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "c"}], "]"}]}], "}"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"multiCollectFactorsABC", "[", "pt_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"multiCollectFactors", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "a"}], "]"}], ",", 
       RowBox[{"multiCollectFactors", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "b"}], "]"}], ",", 
       RowBox[{"multiCollectFactors", "[", 
        RowBox[{
         RowBox[{"pt", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "c"}], "]"}]}], "}"}]}], 
    ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[675]:=",ExpressionUUID->"99de6d6b-676e-475c-a9af-2ce02421e251"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bCircle4Check", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p11_", ",", "p12_", ",", "p13_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p21_", ",", "p22_", ",", "p23_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p31_", ",", "p32_", ",", "p33_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p41_", ",", "p42_", ",", "p43_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "ss", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ss", "[", 
        RowBox[{"{", 
         RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"x2", "*", "x3", "*", 
           SuperscriptBox["a", "2"]}], "+", 
          RowBox[{"x1", "*", "x3", "*", 
           SuperscriptBox["b", "2"]}], "+", 
          RowBox[{"x1", "*", "x2", "*", 
           SuperscriptBox["c", "2"]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"x1", "+", "x2", "+", "x3"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Det", "[", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"ss", "[", 
            RowBox[{"{", 
             RowBox[{"p11", ",", "p12", ",", "p13"}], "}"}], "]"}], 
           RowBox[{"ss", "[", 
            RowBox[{"{", 
             RowBox[{"p21", ",", "p22", ",", "p23"}], "}"}], "]"}], 
           RowBox[{"ss", "[", 
            RowBox[{"{", 
             RowBox[{"p31", ",", "p32", ",", "p33"}], "}"}], "]"}], 
           RowBox[{"ss", "[", 
            RowBox[{"{", 
             RowBox[{"p41", ",", "p42", ",", "p43"}], "}"}], "]"}]},
          {"p11", "p21", "p31", "p41"},
          {"p12", "p22", "p32", "p42"},
          {"p13", "p23", "p33", "p43"}
         }], "\[NoBreak]", ")"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircleEq", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"u3_", ",", "v3_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d1", ",", "d2", ",", "d3", ",", "d", ",", "p", ",", "q", ",", "r", 
        ",", "s1", ",", "s2", ",", "s3"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s1", "=", 
        RowBox[{"u1", "+", "v1", "+", "w1"}]}], ";", 
       RowBox[{"s2", "=", 
        RowBox[{"u2", "+", "v2", "+", "w2"}]}], ";", 
       RowBox[{"s3", "=", 
        RowBox[{"u3", "+", "v3", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d1", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}], 
             RowBox[{"s1", "*", "v1"}], 
             RowBox[{"s1", "*", "w1"}]},
            {
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}], 
             RowBox[{"s2", "*", "v2"}], 
             RowBox[{"s2", "*", "w2"}]},
            {
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}], 
             RowBox[{"s3", "*", "v3"}], 
             RowBox[{"s3", "*", "w3"}]}
           }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d2", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"s1", "*", "u1"}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}], 
             RowBox[{"s1", "*", "w1"}]},
            {
             RowBox[{"s2", "*", "u2"}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}], 
             RowBox[{"s2", "*", "w2"}]},
            {
             RowBox[{"s3", "*", "u3"}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}], 
             RowBox[{"s3", "*", "w3"}]}
           }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d3", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"s1", "*", "u1"}], 
             RowBox[{"s1", "*", "v1"}], 
             RowBox[{" ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
               RowBox[{
                SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
               RowBox[{
                SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}]}]},
            {
             RowBox[{"s2", "*", "u2"}], 
             RowBox[{"s2", "*", "v2"}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}]},
            {
             RowBox[{"s3", "*", "u3"}], 
             RowBox[{"s3", "*", "v3"}], 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}]}
           }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Det", "[", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"u1", "v1", 
             RowBox[{" ", "w1"}]},
            {"u2", "v2", "w2"},
            {"u3", "v3", "w3"}
           }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"p", "=", 
        RowBox[{"d1", "/", 
         RowBox[{"(", 
          RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
       RowBox[{"q", "=", 
        RowBox[{"d2", "/", 
         RowBox[{"(", 
          RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
       RowBox[{"r", "=", 
        RowBox[{"d3", "/", 
         RowBox[{"(", 
          RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], "y", " ", "z"}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], "z", " ", "x"}], "+", 
        RowBox[{
         SuperscriptBox["c", "2"], "x", " ", "y"}], " ", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", "y", "+", "z"}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"p", " ", "x"}], "+", 
           RowBox[{"q", " ", "y"}], "+", 
           RowBox[{"r", " ", "z"}]}], ")"}]}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircleOnDiameter", "[", 
     RowBox[{"U1_", ",", "U2_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"bAreLinePerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "U1"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "U2"}], "]"}]}], 
       "]"}], "//", "evaluate"}], "//", "curveSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bCircleCenter", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"u3_", ",", "v3_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "d1", ",", "d2", ",", "d3", ",", "d", ",", "p", ",", "q", ",", "r", ",",
        "s1", ",", "s2", ",", "s3"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s1", "=", 
       RowBox[{"u1", "+", "v1", "+", "w1"}]}], ";", 
      RowBox[{"s2", "=", 
       RowBox[{"u2", "+", "v2", "+", "w2"}]}], ";", 
      RowBox[{"s3", "=", 
       RowBox[{"u3", "+", "v3", "+", "w3"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d1", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}], 
            RowBox[{"s1", "*", "v1"}], 
            RowBox[{"s1", "*", "w1"}]},
           {
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}], 
            RowBox[{"s2", "*", "v2"}], 
            RowBox[{"s2", "*", "w2"}]},
           {
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}], 
            RowBox[{"s3", "*", "v3"}], 
            RowBox[{"s3", "*", "w3"}]}
          }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"s1", "*", "u1"}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}], 
            RowBox[{"s1", "*", "w1"}]},
           {
            RowBox[{"s2", "*", "u2"}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}], 
            RowBox[{"s2", "*", "w2"}]},
           {
            RowBox[{"s3", "*", "u3"}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}], 
            RowBox[{"s3", "*", "w3"}]}
          }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d3", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {
            RowBox[{"s1", "*", "u1"}], 
            RowBox[{"s1", "*", "v1"}], 
            RowBox[{" ", 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "*", "v1", "*", "w1"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "*", "w1", "*", "u1"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "*", "u1", "*", "v1"}]}]}]},
           {
            RowBox[{"s2", "*", "u2"}], 
            RowBox[{"s2", "*", "v2"}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v2", "*", "w2"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w2", "*", "u2"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u2", "*", "v2"}]}]},
           {
            RowBox[{"s3", "*", "u3"}], 
            RowBox[{"s3", "*", "v3"}], 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "*", "v3", "*", "w3"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "*", "w3", "*", "u3"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "*", "u3", "*", "v3"}]}]}
          }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Det", "[", 
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"u1", "v1", 
            RowBox[{" ", "w1"}]},
           {"u2", "v2", "w2"},
           {"u3", "v3", "w3"}
          }], "\[NoBreak]", ")"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p", "=", 
       RowBox[{"d1", "/", 
        RowBox[{"(", 
         RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
      RowBox[{"q", "=", 
       RowBox[{"d2", "/", 
        RowBox[{"(", 
         RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
      RowBox[{"r", "=", 
       RowBox[{"d3", "/", 
        RowBox[{"(", 
         RowBox[{"s1", " ", "s2", " ", "s3", " ", "d"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bConicCenter", "[", 
       RowBox[{"(", "\[NoBreak]", GridBox[{
          {
           RowBox[{"-", "p"}], 
           FractionBox[
            RowBox[{
             SuperscriptBox["c", "2"], "-", "p", "-", "q"}], "2"], 
           FractionBox[
            RowBox[{
             SuperscriptBox["b", "2"], "-", "p", "-", "r"}], "2"]},
          {
           FractionBox[
            RowBox[{
             SuperscriptBox["c", "2"], "-", "p", "-", "q"}], "2"], 
           RowBox[{"-", "q"}], 
           FractionBox[
            RowBox[{
             SuperscriptBox["a", "2"], "-", "q", "-", "r"}], "2"]},
          {
           FractionBox[
            RowBox[{
             SuperscriptBox["b", "2"], "-", "p", "-", "r"}], "2"], 
           FractionBox[
            RowBox[{
             SuperscriptBox["a", "2"], "-", "q", "-", "r"}], "2"], 
           RowBox[{"-", "r"}]}
         }], "\[NoBreak]", ")"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bFivePointConicEq", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p1_", ",", "q1_", ",", "r1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p2_", ",", "q2_", ",", "r2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p3_", ",", "q3_", ",", "r3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p4_", ",", "q4_", ",", "r4_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p5_", ",", "q5_", ",", "r5_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Det", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         SuperscriptBox["x", "2"], 
         SuperscriptBox["y", "2"], 
         SuperscriptBox["z", "2"], 
         RowBox[{"y", " ", "z"}], 
         RowBox[{"z", " ", "x"}], 
         RowBox[{"x", " ", "y"}]},
        {
         SuperscriptBox["p1", "2"], 
         SuperscriptBox["q1", "2"], 
         SuperscriptBox["r1", "2"], 
         RowBox[{"q1", " ", "r1"}], 
         RowBox[{"r1", " ", "p1"}], 
         RowBox[{"p1", " ", "q1"}]},
        {
         SuperscriptBox["p2", "2"], 
         SuperscriptBox["q2", "2"], 
         SuperscriptBox["r2", "2"], 
         RowBox[{"q2", " ", "r2"}], 
         RowBox[{"r2", " ", "p2"}], 
         RowBox[{"p2", " ", "q2"}]},
        {
         SuperscriptBox["p3", "2"], 
         SuperscriptBox["q3", "2"], 
         SuperscriptBox["r3", "2"], 
         RowBox[{"q3", " ", "r3"}], 
         RowBox[{"r3", " ", "p3"}], 
         RowBox[{"p3", " ", "q3"}]},
        {
         SuperscriptBox["p4", "2"], 
         SuperscriptBox["q4", "2"], 
         SuperscriptBox["r4", "2"], 
         RowBox[{"q4", " ", "r4"}], 
         RowBox[{"r4", " ", "p4"}], 
         RowBox[{"p4", " ", "q4"}]},
        {
         SuperscriptBox["p5", "2"], 
         SuperscriptBox["q5", "2"], 
         SuperscriptBox["r5", "2"], 
         RowBox[{"q5", " ", "r5"}], 
         RowBox[{"r5", " ", "p5"}], 
         RowBox[{"p5", " ", "q5"}]}
       }], "\[NoBreak]", ")"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "subscript", " ", "replacement", " ", "suppression", " ", 
    "below", " ", "is", " ", "often", " ", "needed", " ", 
    RowBox[{"e", ".", "g", ".", " ", "when"}], " ", 
    SubscriptBox["x", "1"], " ", "is", " ", "passed", " ", "a", " ", 
    "variable"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPointOnConic", "[", 
     RowBox[{
     "XX_", ",", "PA_", ",", "PB_", ",", "PC_", ",", "PD_", ",", "PE_"}], 
     "]"}], ":=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"bFivePointConicEq", "[", 
       RowBox[{"PA", ",", "PB", ",", "PC", ",", "PD", ",", "PE"}], "]"}], "/.", 
      RowBox[{"First", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_Subscript", ":>", "x"}], "}"}], ",", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], "]"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "XX", "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bConicCenter", "[", "mx_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "m11", ",", " ", "m12", ",", " ", "m13", ",", " ", "m21", ",", "m22", 
        ",", "m23", ",", "m31", ",", "m32", ",", "m33"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MatrixQ", "[", "mx", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          RowBox[{"conicEqtoMtx", "[", "mx", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          "mx"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m23", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m13", "+", "m12"}], ")"}], "m23"}], "+", 
          RowBox[{"m22", " ", "m33"}], "-", 
          RowBox[{"m13", " ", "m22"}], "-", 
          RowBox[{"m12", " ", "m33"}]}], ",", " ", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m13", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m12", "+", "m23"}], ")"}], "m13"}], "+", 
          RowBox[{"m11", " ", "m33"}], "-", 
          RowBox[{"m12", " ", "m33"}], "-", 
          RowBox[{"m23", " ", "m11"}]}], ",", "  ", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["m12", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"m23", "+", "m13"}], ")"}], "m12"}], "+", 
          RowBox[{"m11", " ", "m22"}], "-", 
          RowBox[{"m23", " ", "m11"}], "-", 
          RowBox[{"m13", " ", "m22"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bDualConic", "[", "mx_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", " ", "m11", ",", " ", "m12", ",", " ", "m13", ",", " ", 
        "m21", ",", "m22", ",", "m23", ",", "m31", ",", "m32", ",", "m33"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MatrixQ", "[", "mx", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          RowBox[{"conicEqtoMtx", "[", "mx", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          "mx"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"x", "y", "z"}
             }], "\[NoBreak]", ")"}], ".", 
           RowBox[{"Adjugate", "[", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"m11", "m12", "m13"},
               {"m12", "m22", "m23"},
               {"m13", "m23", "m33"}
              }], "\[NoBreak]", ")"}], "]"}], ".", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {"x"},
              {"y"},
              {"z"}
             }], "\[NoBreak]", ")"}]}], ")"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"polarCurve", "[", 
     RowBox[{"crv_", ",", "pt_"}], "]"}], ":=", 
    RowBox[{"pt", ".", 
     RowBox[{"Grad", "[", 
      RowBox[{"crv", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCubicPolar", "[", 
     RowBox[{"crv_", ",", "pt_"}], "]"}], ":=", 
    RowBox[{"bPolar", "[", 
     RowBox[{
      RowBox[{"polarCurve", "[", 
       RowBox[{"crv", ",", "pt"}], "]"}], ",", "pt"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mixedPolarLine", "[", 
    RowBox[{"cubic_", ",", "ptP_", ",", "ptQ_"}], "]"}], ":=", 
   RowBox[{"bPolar", "[", 
    RowBox[{
     RowBox[{"polarCurve", "[", 
      RowBox[{"cubic", ",", "ptQ"}], "]"}], ",", "ptP"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPerspector", "[", "mx_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "p", ",", " ", "m11", ",", " ", "m12", ",", " ", "m13", ",", " ", 
        "m21", ",", "m22", ",", "m23", ",", "m31", ",", "m32", ",", "m33"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MatrixQ", "[", "mx", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          RowBox[{"conicEqtoMtx", "[", "mx", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m11", ",", "m12", ",", "m13"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m12", ",", "m22", ",", "m23"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"m13", ",", "m23", ",", "m33"}], "}"}]}], "}"}], "=", 
          "mx"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m13", " ", "m22"}], "-", 
            RowBox[{"m12", " ", "m23"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m13", " ", "m23"}], "-", 
            RowBox[{"m12", " ", "m33"}]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"m12", " ", "m13"}], "-", 
            RowBox[{"m11", " ", "m23"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "m13"}], " ", "m23"}], "+", 
            RowBox[{"m12", " ", "m33"}]}], ")"}]}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"m12", " ", "m13"}], "-", 
              RowBox[{"m11", " ", "m23"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "m13"}], " ", "m22"}], "+", 
              RowBox[{"m12", " ", "m23"}]}], ")"}]}], ")"}]}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPerspectorGeneric", "[", 
     RowBox[{"mx_", ",", "pa_", ",", "pb_", ",", "pc_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pla", ",", "plb", ",", "plc", ",", "a1", ",", "b1"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pla", "=", 
        RowBox[{"bPolar", "[", 
         RowBox[{"mx", ",", "pa"}], "]"}]}], ";", 
       RowBox[{"plb", "=", 
        RowBox[{"bPolar", "[", 
         RowBox[{"mx", ",", "pb"}], "]"}]}], ";", 
       RowBox[{"plc", "=", 
        RowBox[{"bPolar", "[", 
         RowBox[{"mx", ",", "pc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"a1", "=", 
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"plb", ",", "plc"}], "]"}]}], ";", 
       RowBox[{"b1", "=", 
        RowBox[{"bLineIntersection", "[", 
         RowBox[{"plc", ",", "pla"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"pa", ",", "a1"}], "]"}], ",", 
         RowBox[{"bLine", "[", 
          RowBox[{"pb", ",", "b1"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"m11", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", "m12", " ", "x", " ", "y"}], "+", 
    RowBox[{"m22", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"2", " ", "m13", " ", "x", " ", "z"}], "+", 
    RowBox[{"2", " ", "m23", " ", "y", " ", "z"}], "+", 
    RowBox[{"m33", " ", 
     SuperscriptBox["z", "2"]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conicEqtoMtx", "[", "eq_", "]"}], ":=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"Coefficient", "[", 
         RowBox[{"eq", ",", " ", 
          SuperscriptBox["x", "2"]}], "]"}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"x", " ", "y"}]}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"x", " ", "z"}]}], "]"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"x", " ", "y"}]}], "]"}]}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"eq", ",", " ", 
          SuperscriptBox["y", "2"]}], "]"}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"y", " ", "z"}]}], "]"}]}]},
       {
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"x", " ", "z"}]}], "]"}]}], 
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"Coefficient", "[", 
          RowBox[{"eq", ",", " ", 
           RowBox[{"y", " ", "z"}]}], "]"}]}], 
        RowBox[{"Coefficient", "[", 
         RowBox[{"eq", ",", " ", 
          SuperscriptBox["z", "2"]}], "]"}]}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Barycentric", " ", "equaiton", " ", "of", " ", "circle", " ", "wth", " ", 
    "center", " ", "through", " ", "point"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCircleEqRad", "[", 
     RowBox[{"cent_", ",", "rad_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u1", ",", "v1", ",", "w1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u1", ",", "v1", ",", "w1"}], "}"}], "=", 
        FractionBox["cent", 
         RowBox[{"Total", "[", "cent", "]"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SA", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "-", 
            RowBox[{"u1", 
             RowBox[{"(", 
              RowBox[{"x", "+", "y", "+", "z"}], ")"}]}]}], ")"}], "2"]}], 
        "+", 
        RowBox[{"SB", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"y", "-", 
            RowBox[{"v1", 
             RowBox[{"(", 
              RowBox[{"x", "+", "y", "+", "z"}], ")"}]}]}], ")"}], "2"]}], 
        "+", 
        RowBox[{"SC", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"z", "-", 
            RowBox[{"w1", 
             RowBox[{"(", 
              RowBox[{"x", "+", "y", "+", "z"}], ")"}]}]}], ")"}], "2"]}], 
        "-", 
        RowBox[{
         SuperscriptBox["rad", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"x", "+", "y", "+", "z"}], ")"}], "2"]}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "barycentric", " ", "coordinates", " ", "of", " ", "the", " ", "circle", 
    " ", "K", " ", "with", " ", "respect", " ", "to", " ", "fundamental", " ",
     "triangle", " ", 
    RowBox[{"ABC", ".", " ", "\[IndentingNewLine]", "The"}], " ", "values", 
    " ", "returned", " ", "here", " ", "are", " ", "multiplied", " ", "by", 
    " ", "S", " ", 
    RowBox[{"(", 
     RowBox[{"=", 
      RowBox[{"2", "*", "area"}]}], ")"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"circleBaryCoords", "[", 
     RowBox[{"cent_", ",", "rad_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "u1", ",", "v1", ",", "w1", ",", " ", "m1", ",", " ", "m2", ",", 
        "m3"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u1", ",", "v1", ",", "w1"}], "}"}], "=", 
        FractionBox["cent", 
         RowBox[{"Total", "[", "cent", "]"}]]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m1", "=", 
        RowBox[{
         RowBox[{"SA", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "\[Minus]", "u1"}], ")"}], "2"]}], "+", 
         RowBox[{"SB", " ", 
          SuperscriptBox["v1", "2"]}], "+", 
         RowBox[{"SC", " ", 
          SuperscriptBox["w1", "2"]}], "-", 
         SuperscriptBox["rad", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m2", "=", 
        RowBox[{
         RowBox[{"SA", " ", 
          SuperscriptBox["u1", "2"]}], "+", 
         RowBox[{"SB", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "v1"}], ")"}], "2"]}], "+", 
         RowBox[{"SC", " ", 
          SuperscriptBox["w1", "2"]}], "-", 
         SuperscriptBox["rad", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"m3", "=", 
        RowBox[{
         RowBox[{"SA", " ", 
          SuperscriptBox["u1", "2"]}], "+", 
         RowBox[{"SB", " ", 
          SuperscriptBox["v1", "2"]}], "+", 
         RowBox[{"SC", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", "w1"}], ")"}], "2"]}], "-", 
         SuperscriptBox["rad", "2"]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m1", ",", "m2", ",", "m3"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"radicalCenter", "[", 
     RowBox[{
     "c1_", ",", "r1_", ",", "c2_", ",", "r2_", ",", "c3_", ",", " ", "r3_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bc1", ",", "bc2", ",", "bc3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bc1", "=", 
        RowBox[{"circleBaryCoords", "[", 
         RowBox[{"c1", ",", "r1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bc2", "=", 
        RowBox[{"circleBaryCoords", "[", 
         RowBox[{"c2", ",", "r2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"bc3", "=", 
        RowBox[{"circleBaryCoords", "[", 
         RowBox[{"c3", ",", "r3"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Det", "[", GridBox[{
            {"1", "1", "1"},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}
           }], "]"}], ",", 
         RowBox[{"Det", "[", GridBox[{
            {"1", "1", "1"},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "3", "]"}], "]"}]},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}
           }], "]"}], ",", 
         RowBox[{"Det", "[", GridBox[{
            {"1", "1", "1"},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "1", "]"}], "]"}]},
            {
             RowBox[{"bc1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"bc2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], 
             RowBox[{"bc3", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}
           }], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"radicalAxis", "[", 
     RowBox[{"cent1_", ",", "rad1_", ",", "cent2_", ",", "rad2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pa1", ",", "pb1", ",", "pc1", ",", "pa2", ",", "pb2", ",", "pc2"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pa1", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xA", ",", "cent1"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad1", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pb1", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xB", ",", "cent1"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad1", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pc1", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xC", ",", "cent1"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad1", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pa2", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xA", ",", "cent2"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad2", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pb2", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xB", ",", "cent2"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad2", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pc2", "=", 
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"bDistance", "[", 
            RowBox[{"xC", ",", "cent2"}], "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", "rad2", ")"}], "2"]}], "//", "Simplify"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"pa1", "-", "pa2"}], ",", 
          RowBox[{"pb1", "-", "pb2"}], ",", 
          RowBox[{"pc1", "-", "pc2"}]}], "}"}], "//", "Simplify"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bPolar", "[", 
     RowBox[{"mx_", ",", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mxm", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"MatrixQ", "[", "mx", "]"}], "]"}], ",", 
         RowBox[{"mxm", "=", 
          RowBox[{"conicEqtoMtx", "[", "mx", "]"}]}], ",", 
         RowBox[{"mxm", "=", "mx"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"First", "/@", 
        RowBox[{"(", 
         RowBox[{"mxm", ".", 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"u"},
             {"v"},
             {"w"}
            }], "\[NoBreak]", ")"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bPole", "[", 
   RowBox[{"mx_", ",", "ln_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mtx", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"MatrixQ", "[", "mx", "]"}], "]"}], ",", 
       RowBox[{"mtx", "=", 
        RowBox[{"conicEqtoMtx", "[", "mx", "]"}]}], ",", 
       RowBox[{"mtx", "=", "mx"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Adjugate", "[", "mtx", "]"}], ".", "ln"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[680]:=",ExpressionUUID->"e86d7a40-128f-4f2b-87f8-bf1d22559338"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Ellipse", " ", "with", " ", "foci", " ", "F1", " ", "and", " ", "F2"}], 
    ",", " ", 
    RowBox[{
    "with", " ", "barycentric", " ", "coordinates", " ", "summing", " ", "up",
      " ", "to", " ", "1"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", 
       SubscriptBox["PF", "1"]}], "+", 
      SubscriptBox["PF", "2"]}], "=", "k"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"bEllipse", "[", 
     RowBox[{"f1_", ",", "f2_", ",", "k_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "expr", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"expr", "=", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "r1"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"x", "+", "y"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p1", "+", "q1"}], ")"}], " ", "z"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p1", "+", "r1"}], ")"}], " ", "y"}], "-", 
                RowBox[{"q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "r1"}], " ", 
                 RowBox[{"(", 
                  RowBox[{"x", "+", "y"}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p1", "+", "q1"}], ")"}], " ", "z"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"q1", " ", "x"}], "+", 
                RowBox[{"r1", " ", "x"}], "-", 
                RowBox[{"p1", " ", 
                 RowBox[{"(", 
                  RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"p1", "+", "r1"}], ")"}], " ", "y"}], "-", 
                RowBox[{"q1", " ", 
                 RowBox[{"(", 
                  RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"q1", " ", "x"}], "+", 
                RowBox[{"r1", " ", "x"}], "-", 
                RowBox[{"p1", " ", 
                 RowBox[{"(", 
                  RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}], 
           "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["k", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x", "+", "y", "+", "z"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r2", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "q2"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p2", "+", "r2"}], ")"}], " ", "y"}], "-", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"q2", " ", "x"}], "+", 
                  RowBox[{"r2", " ", "x"}], "-", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q2", "2"], " ", "x", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "r2"}], ")"}], " ", "y", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "r2"}], " ", "x"}], "+", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"r2", " ", "x", " ", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", "y", "+", "z"}], ")"}]}], "-", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}], "+", 
                    RowBox[{"x", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "y"}], "+", "z"}], ")"}]}]}], ")"}]}]}],
                  ")"}]}]}], ")"}]}]}], ")"}], "2"], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["k", "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x", "+", "y", "+", "z"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"r2", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "q2"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"p2", "+", "r2"}], ")"}], " ", "y"}], "-", 
                  RowBox[{"q2", " ", 
                   RowBox[{"(", 
                    RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"q2", " ", "x"}], "+", 
                  RowBox[{"r2", " ", "x"}], "-", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}]}], 
            "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["q2", "2"], " ", "x", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "r2"}], ")"}], " ", "y", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "r2"}], " ", "x"}], "+", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"r2", " ", "x", " ", 
                   RowBox[{"(", 
                    RowBox[{"x", "-", "y", "+", "z"}], ")"}]}], "-", 
                  RowBox[{"p2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"y", "+", "z"}], ")"}]}], "+", 
                    RowBox[{"x", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "y"}], "+", "z"}], ")"}]}]}], ")"}]}]}],
                  ")"}]}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r1"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "+", "q1"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "+", "r1"}], ")"}], " ", "y"}], "-", 
               RowBox[{"q1", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r1"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "+", "q1"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q1", " ", "x"}], "+", 
               RowBox[{"r1", " ", "x"}], "-", 
               RowBox[{"p1", " ", 
                RowBox[{"(", 
                 RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p1", "+", "r1"}], ")"}], " ", "y"}], "-", 
               RowBox[{"q1", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q1", " ", "x"}], "+", 
               RowBox[{"r1", " ", "x"}], "-", 
               RowBox[{"p1", " ", 
                RowBox[{"(", 
                 RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "+", "y", "+", "z"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["a", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "q2"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "r2"}], ")"}], " ", "y"}], "-", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["b", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "r2"}], " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "y"}], ")"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "q2"}], ")"}], " ", "z"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q2", " ", "x"}], "+", 
               RowBox[{"r2", " ", "x"}], "-", 
               RowBox[{"p2", " ", 
                RowBox[{"(", 
                 RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["c", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p2", "+", "r2"}], ")"}], " ", "y"}], "-", 
               RowBox[{"q2", " ", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "z"}], ")"}]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"q2", " ", "x"}], "+", 
               RowBox[{"r2", " ", "x"}], "-", 
               RowBox[{"p2", " ", 
                RowBox[{"(", 
                 RowBox[{"y", "+", "z"}], ")"}]}]}], ")"}]}]}], ")"}]}]}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"pr", "=", 
        RowBox[{"PolynomialReduce", "[", 
         RowBox[{"expr", ",", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"x", "+", "y", "+", "z"}], ")"}], "2"], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pr", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p1", ",", "q1", ",", "r1"}], "}"}], "->", 
           RowBox[{"f1", "/", 
            RowBox[{"Total", "[", "f1", "]"}]}]}], "]"}]}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p2", ",", "q2", ",", "r2"}], "}"}], "->", 
          RowBox[{"f2", "/", 
           RowBox[{"Total", "[", "f2", "]"}]}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.886577990480022*^9, 3.8865781412328486`*^9}, {
   3.886578190867366*^9, 3.8865782408206844`*^9}, 3.8865783959145555`*^9, {
   3.886578459109069*^9, 3.8865784954900017`*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[700]:=",ExpressionUUID->"3540bb30-f8f0-46db-b504-7b6bf8570298"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "inscribed", " ", "conic", " ", 
    RowBox[{"(", "inconic", ")"}], " ", "with", " ", "perspector", " ", "P", 
    RowBox[{"(", 
     RowBox[{"p", ",", "q", ",", "r"}], ")"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bInconicEq", "[", 
      RowBox[{"{", 
       RowBox[{"pp_", ",", "qq_", ",", "rr_"}], "}"}], "]"}], ":=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x", "/", "pp"}], ")"}], "2"], "-", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"y", "/", "qq"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"z", "/", "rr"}], ")"}]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y", "/", "qq"}], ")"}], "2"], "-", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"x", "/", "pp"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"z", "/", "rr"}], ")"}]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z", "/", "rr"}], ")"}], "2"], "-", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"y", "/", "qq"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"x", "/", "pp"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"circum", "-", 
     RowBox[{"conic", " ", "passing", " ", "through", " ", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], " ", "and", " ", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bCircumconicEq", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pp_", ",", "qq_", ",", "rr_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"pp", " ", "u", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rr", " ", "v"}], "\[Minus]", 
         RowBox[{"qq", " ", "w"}]}], ")"}], "y", " ", "z"}], "+", 
      RowBox[{"qq", " ", "v", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pp", " ", "w"}], "\[Minus]", 
         RowBox[{"rr", " ", "u"}]}], ")"}], "z", " ", "x"}], "+", 
      RowBox[{"rr", " ", "w", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"qq", " ", "u"}], "\[Minus]", 
         RowBox[{"pp", " ", "v"}]}], ")"}], "x", " ", "y"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "circumconic", " ", "with", " ", "perspector", " ", "P"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bCircumconicPEq", "[", 
      RowBox[{"{", 
       RowBox[{"pp_", ",", "qq_", ",", "rr_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"pp", " ", "y", " ", "z"}], " ", "+", " ", 
      RowBox[{"qq", " ", "x", " ", "z"}], " ", "+", " ", 
      RowBox[{"rr", " ", "x", " ", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bBicevianConic", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", "v1"}], " ", "v2", " ", "w1", " ", "w2", " ", 
       SuperscriptBox["x", "2"]}], "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"u2", " ", "v1"}], "+", 
         RowBox[{"u1", " ", "v2"}]}], ")"}], " ", "w1", " ", "w2", " ", "x", 
       " ", "y"}], "-", " ", 
      RowBox[{"u1", " ", "u2", " ", "w1", " ", "w2", " ", 
       SuperscriptBox["y", "2"]}], "+", " ", 
      RowBox[{"v1", " ", "v2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"u2", " ", "w1"}], "+", 
         RowBox[{"u1", " ", "w2"}]}], ")"}], " ", "x", " ", "z"}], "+", " ", 
      RowBox[{"u1", " ", "u2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"v2", " ", "w1"}], "+", 
         RowBox[{"v1", " ", "w2"}]}], ")"}], " ", "y", " ", "z"}], "-", " ", 
      RowBox[{"u1", " ", "u2", " ", "v1", " ", "v2", " ", 
       SuperscriptBox["z", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bAnticevianConic", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          SuperscriptBox["v", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["q", "2"], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}], " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["r", "2"]}], " ", 
          SuperscriptBox["u", "2"]}], "+", 
         RowBox[{
          SuperscriptBox["p", "2"], " ", 
          SuperscriptBox["w", "2"]}]}], ")"}], " ", 
       SuperscriptBox["y", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["q", "2"], " ", 
          SuperscriptBox["u", "2"]}], "-", 
         RowBox[{
          SuperscriptBox["p", "2"], " ", 
          SuperscriptBox["v", "2"]}]}], ")"}], " ", 
       SuperscriptBox["z", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "tripolar", " ", 
     RowBox[{"(", 
      RowBox[{"trilinear", " ", "polar"}], ")"}], " ", "of", " ", "P"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bTripolarEq", "[", 
      RowBox[{"{", 
       RowBox[{"pp_", ",", "qq_", ",", "rr_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "pp"}], ",", 
       RowBox[{"1", "/", "qq"}], ",", 
       RowBox[{"1", "/", "rr"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"the", " ", "tripolar", " ", 
      RowBox[{"(", 
       RowBox[{"trilinear", " ", "polar"}], ")"}], " ", "of", " ", "P"}], "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "w"}], "}"}], " ", "wrt", " ", "generic", 
      " ", "points"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bTripolarEqGeneral", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u3_", ",", "v3_", ",", "w3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", " ", "v1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"v2", " ", "w"}], "-", 
                RowBox[{"v", " ", "w2"}]}], ")"}]}], "+", 
             RowBox[{"v3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "u2", " ", "v1", " ", "w"}], "+", 
                RowBox[{"u1", " ", "v2", " ", "w"}], "+", 
                RowBox[{"u2", " ", "v", " ", "w1"}], "-", 
                RowBox[{"u", " ", "v2", " ", "w1"}], "-", 
                RowBox[{"u1", " ", "v", " ", "w2"}], "+", 
                RowBox[{"2", " ", "u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
             RowBox[{"v1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u2", " ", "v"}], "-", 
                RowBox[{"u", " ", "v2"}]}], ")"}], " ", "w3"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u3", " ", "v1", " ", "w"}], "-", 
                RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
                RowBox[{"u3", " ", "v", " ", "w1"}], "+", 
                RowBox[{"u", " ", "v3", " ", "w1"}]}], ")"}], " ", "w2"}], 
             "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u2", " ", "v1", " ", "w"}], "-", 
                RowBox[{"u1", " ", "v2", " ", "w"}], "-", 
                RowBox[{"u2", " ", "v", " ", "w1"}], "+", 
                RowBox[{"u", " ", "v2", " ", "w1"}], "+", 
                RowBox[{"2", " ", "u1", " ", "v", " ", "w2"}], "-", 
                RowBox[{"2", " ", "u", " ", "v1", " ", "w2"}]}], ")"}], " ", 
              "w3"}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v1", " ", "w"}], "-", 
              RowBox[{"v", " ", "w1"}]}], ")"}]}], "+", 
           RowBox[{"v3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "v1", " ", "w"}], "-", 
              RowBox[{"2", " ", "u1", " ", "v2", " ", "w"}], "-", 
              RowBox[{"u2", " ", "v", " ", "w1"}], "+", 
              RowBox[{"2", " ", "u", " ", "v2", " ", "w1"}], "+", 
              RowBox[{"u1", " ", "v", " ", "w2"}], "-", 
              RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u1", " ", "v"}], "-", 
              RowBox[{"u", " ", "v1"}]}], ")"}], " ", "v2", " ", "w3"}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"w1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u3", " ", "v2", " ", "w"}], "-", 
              RowBox[{"u2", " ", "v3", " ", "w"}], "-", 
              RowBox[{"u3", " ", "v", " ", "w2"}], "+", 
              RowBox[{"u", " ", "v3", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "u2"}], " ", "v1", " ", "w"}], "+", 
              RowBox[{"u1", " ", "v2", " ", "w"}], "+", 
              RowBox[{"2", " ", "u2", " ", "v", " ", "w1"}], "-", 
              RowBox[{"2", " ", "u", " ", "v2", " ", "w1"}], "-", 
              RowBox[{"u1", " ", "v", " ", "w2"}], "+", 
              RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}], " ", "w3"}]}], 
          ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"u3", " ", "v2", " ", "w"}], "-", 
                RowBox[{"u2", " ", "v3", " ", "w"}], "-", 
                RowBox[{"u3", " ", "v", " ", "w2"}], "+", 
                RowBox[{"u", " ", "v3", " ", "w2"}]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "u2"}], " ", "v1", " ", "w"}], "+", 
                RowBox[{"u1", " ", "v2", " ", "w"}], "+", 
                RowBox[{"2", " ", "u2", " ", "v", " ", "w1"}], "-", 
                RowBox[{"2", " ", "u", " ", "v2", " ", "w1"}], "-", 
                RowBox[{"u1", " ", "v", " ", "w2"}], "+", 
                RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}], " ", "w3"}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "u1"}], " ", "v2", " ", "w"}], "+", 
                RowBox[{"u", " ", "v2", " ", "w1"}], "+", 
                RowBox[{"u1", " ", "v", " ", "w2"}], "-", 
                RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
             RowBox[{"u2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "u3", " ", "v1", " ", "w"}], "-", 
                RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
                RowBox[{"2", " ", "u3", " ", "v", " ", "w1"}], "+", 
                RowBox[{"u", " ", "v3", " ", "w1"}], "+", 
                RowBox[{"u1", " ", "v", " ", "w3"}], "-", 
                RowBox[{"u", " ", "v1", " ", "w3"}]}], ")"}]}]}], ")"}]}], 
          ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u3", " ", "v1", " ", "w"}], "-", 
              RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
              RowBox[{"u3", " ", "v", " ", "w1"}], "+", 
              RowBox[{"u", " ", "v3", " ", "w1"}]}], ")"}], " ", "w2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "v1", " ", "w"}], "-", 
              RowBox[{"u1", " ", "v2", " ", "w"}], "-", 
              RowBox[{"u2", " ", "v", " ", "w1"}], "+", 
              RowBox[{"u", " ", "v2", " ", "w1"}], "+", 
              RowBox[{"2", " ", "u1", " ", "v", " ", "w2"}], "-", 
              RowBox[{"2", " ", "u", " ", "v1", " ", "w2"}]}], ")"}], " ", 
            "w3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", " ", "u3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v2", " ", "w1"}], "-", 
              RowBox[{"v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{"u2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u3", " ", "v1", " ", "w"}], "+", 
              RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
              RowBox[{"u3", " ", "v", " ", "w1"}], "-", 
              RowBox[{"u1", " ", "v", " ", "w3"}]}], ")"}]}], "+", 
           RowBox[{"u1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "u3", " ", "v2", " ", "w"}], "+", 
              RowBox[{"2", " ", "u3", " ", "v", " ", "w2"}], "-", 
              RowBox[{"u", " ", "v3", " ", "w2"}], "+", 
              RowBox[{"u", " ", "v2", " ", "w3"}]}], ")"}]}]}], ")"}]}]}], 
       ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v2", " ", "w"}], "-", 
              RowBox[{"v", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{"v3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "u2", " ", "v1", " ", "w"}], "+", 
              RowBox[{"u1", " ", "v2", " ", "w"}], "+", 
              RowBox[{"u2", " ", "v", " ", "w1"}], "-", 
              RowBox[{"u", " ", "v2", " ", "w1"}], "-", 
              RowBox[{"u1", " ", "v", " ", "w2"}], "+", 
              RowBox[{"2", " ", "u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{"v1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "v"}], "-", 
              RowBox[{"u", " ", "v2"}]}], ")"}], " ", "w3"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "u1"}], " ", "v2", " ", "w"}], "+", 
              RowBox[{"u", " ", "v2", " ", "w1"}], "+", 
              RowBox[{"u1", " ", "v", " ", "w2"}], "-", 
              RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{"u2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "u3", " ", "v1", " ", "w"}], "-", 
              RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
              RowBox[{"2", " ", "u3", " ", "v", " ", "w1"}], "+", 
              RowBox[{"u", " ", "v3", " ", "w1"}], "+", 
              RowBox[{"u1", " ", "v", " ", "w3"}], "-", 
              RowBox[{"u", " ", "v1", " ", "w3"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v1", " ", "w"}], "-", 
              RowBox[{"v", " ", "w1"}]}], ")"}]}], "+", 
           RowBox[{"v3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "v1", " ", "w"}], "-", 
              RowBox[{"2", " ", "u1", " ", "v2", " ", "w"}], "-", 
              RowBox[{"u2", " ", "v", " ", "w1"}], "+", 
              RowBox[{"2", " ", "u", " ", "v2", " ", "w1"}], "+", 
              RowBox[{"u1", " ", "v", " ", "w2"}], "-", 
              RowBox[{"u", " ", "v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u1", " ", "v"}], "-", 
              RowBox[{"u", " ", "v1"}]}], ")"}], " ", "v2", " ", "w3"}]}], 
          ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", " ", "u3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"v2", " ", "w1"}], "-", 
              RowBox[{"v1", " ", "w2"}]}], ")"}]}], "+", 
           RowBox[{"u2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u3", " ", "v1", " ", "w"}], "+", 
              RowBox[{"u1", " ", "v3", " ", "w"}], "-", 
              RowBox[{"u3", " ", "v", " ", "w1"}], "-", 
              RowBox[{"u1", " ", "v", " ", "w3"}]}], ")"}]}], "+", 
           RowBox[{"u1", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "u3", " ", "v2", " ", "w"}], "+", 
              RowBox[{"2", " ", "u3", " ", "v", " ", "w2"}], "-", 
              RowBox[{"u", " ", "v3", " ", "w2"}], "+", 
              RowBox[{"u", " ", "v2", " ", "w3"}]}], ")"}]}]}], ")"}]}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"the", " ", "tripole", " ", "of", " ", "line", " ", 
     RowBox[{"{", 
      RowBox[{"p", ",", "q", ",", "r"}], "}"}], " ", "wrt", " ", "generic", 
     " ", "points"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bTripoleEqGeneral", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u3_", ",", "v3_", ",", "w3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["p", "2"], " ", "u1", " ", "u2", " ", "u3"}], "+", 
        RowBox[{
         SuperscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v1", " ", "v2"}], "+", 
           RowBox[{"u2", " ", "v1", " ", "v3"}], "+", 
           RowBox[{"u1", " ", "v2", " ", "v3"}]}], ")"}]}], "+", 
        RowBox[{"q", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v2", " ", "w1"}], "+", 
           RowBox[{"u2", " ", "v3", " ", "w1"}], "+", 
           RowBox[{"u3", " ", "v1", " ", "w2"}], "+", 
           RowBox[{"u1", " ", "v3", " ", "w2"}], "+", 
           RowBox[{"u2", " ", "v1", " ", "w3"}], "+", 
           RowBox[{"u1", " ", "v2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "w1", " ", "w2"}], "+", 
           RowBox[{"u2", " ", "w1", " ", "w3"}], "+", 
           RowBox[{"u1", " ", "w2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "u3", " ", "v1"}], "+", 
              RowBox[{"u1", " ", "u3", " ", "v2"}], "+", 
              RowBox[{"u1", " ", "u2", " ", "v3"}]}], ")"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"u2", " ", "u3", " ", "w1"}], "+", 
              RowBox[{"u1", " ", "u3", " ", "w2"}], "+", 
              RowBox[{"u1", " ", "u2", " ", "w3"}]}], ")"}]}]}], ")"}]}]}], 
       ",", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["q", "2"], " ", "v1", " ", "v2", " ", "v3"}], "+", 
        RowBox[{
         SuperscriptBox["p", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u2", " ", "u3", " ", "v1"}], "+", 
           RowBox[{"u1", " ", "u3", " ", "v2"}], "+", 
           RowBox[{"u1", " ", "u2", " ", "v3"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v1", " ", "v2"}], "+", 
           RowBox[{"u2", " ", "v1", " ", "v3"}], "+", 
           RowBox[{"u1", " ", "v2", " ", "v3"}]}], ")"}]}], "+", 
        RowBox[{"p", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v2", " ", "w1"}], "+", 
           RowBox[{"u2", " ", "v3", " ", "w1"}], "+", 
           RowBox[{"u3", " ", "v1", " ", "w2"}], "+", 
           RowBox[{"u1", " ", "v3", " ", "w2"}], "+", 
           RowBox[{"u2", " ", "v1", " ", "w3"}], "+", 
           RowBox[{"u1", " ", "v2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "q", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v2", " ", "v3", " ", "w1"}], "+", 
           RowBox[{"v1", " ", "v3", " ", "w2"}], "+", 
           RowBox[{"v1", " ", "v2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v3", " ", "w1", " ", "w2"}], "+", 
           RowBox[{"v2", " ", "w1", " ", "w3"}], "+", 
           RowBox[{"v1", " ", "w2", " ", "w3"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["r", "2"], " ", "w1", " ", "w2", " ", "w3"}], "+", 
        RowBox[{
         SuperscriptBox["p", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u2", " ", "u3", " ", "w1"}], "+", 
           RowBox[{"u1", " ", "u3", " ", "w2"}], "+", 
           RowBox[{"u1", " ", "u2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{"p", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "v2", " ", "w1"}], "+", 
           RowBox[{"u2", " ", "v3", " ", "w1"}], "+", 
           RowBox[{"u3", " ", "v1", " ", "w2"}], "+", 
           RowBox[{"u1", " ", "v3", " ", "w2"}], "+", 
           RowBox[{"u2", " ", "v1", " ", "w3"}], "+", 
           RowBox[{"u1", " ", "v2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v2", " ", "v3", " ", "w1"}], "+", 
           RowBox[{"v1", " ", "v3", " ", "w2"}], "+", 
           RowBox[{"v1", " ", "v2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "p", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u3", " ", "w1", " ", "w2"}], "+", 
           RowBox[{"u2", " ", "w1", " ", "w3"}], "+", 
           RowBox[{"u1", " ", "w2", " ", "w3"}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "q", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"v3", " ", "w1", " ", "w2"}], "+", 
           RowBox[{"v2", " ", "w1", " ", "w3"}], "+", 
           RowBox[{"v1", " ", "w2", " ", "w3"}]}], ")"}]}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bKirikamiCenter", "[", 
      RowBox[{"pA_", ",", "pB_", ",", "pC_", ",", "pD_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "lAC", ",", "lBD", ",", "la", ",", "lb", ",", "lc", ",", "ld", ",", 
         "pAB", ",", "pBC", ",", "pCD", ",", "pDA"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lAC", " ", "=", " ", 
         RowBox[{"bLine", "[", 
          RowBox[{"pA", ",", "pC"}], "]"}]}], ";", " ", 
        RowBox[{"lBD", "=", 
         RowBox[{"bLine", "[", 
          RowBox[{"pB", ",", "pD"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"la", "=", 
         RowBox[{"bParallelLine", "[", 
          RowBox[{"pA", ",", "lBD"}], "]"}]}], ";", 
        RowBox[{"lb", "=", 
         RowBox[{"bParallelLine", "[", 
          RowBox[{"pB", ",", "lAC"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lc", "=", 
         RowBox[{"bParallelLine", "[", 
          RowBox[{"pC", ",", "lBD"}], "]"}]}], ";", 
        RowBox[{"ld", "=", 
         RowBox[{"bParallelLine", "[", 
          RowBox[{"pD", ",", "lAC"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pAB", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"la", ",", "lb"}], "]"}]}], ";", 
        RowBox[{"pBC", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"lb", ",", "lc"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pCD", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"lc", ",", "ld"}], "]"}]}], ";", 
        RowBox[{"pDA", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"ld", ",", "la"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bLineIntersection", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"pAB", ",", "pCD"}], "]"}], ",", 
          RowBox[{"bLine", "[", 
           RowBox[{"pBC", ",", "pDA"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bPerspeconic", "[", 
      RowBox[{
      "a1_", ",", "b1_", ",", "c1_", ",", "a2_", ",", "b2_", ",", "c2_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "b1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a2", ",", "c2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "b1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"b2", ",", "c2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p3", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "c1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a2", ",", "b2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p4", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "c1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"b2", ",", "c2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p5", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"b1", ",", "c1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a2", ",", "b2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bFivePointConicEq", "[", 
         RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bPerspectivityAxis", "[", 
      RowBox[{
      "a1_", ",", "b1_", ",", "c1_", ",", "a2_", ",", "b2_", ",", "c2_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p1", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "b1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a2", ",", "b2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"a1", ",", "c1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"a2", ",", "c2"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bLine", "[", 
         RowBox[{"p1", ",", "p2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bPerspectivityAxis", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"bPerspectivityAxis", "[", 
      RowBox[{"a1", ",", "b1", ",", "c1", ",", "a2", ",", "b2", ",", "c2"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bIsPerspective", "[", 
      RowBox[{
      "a1_", ",", "b1_", ",", "c1_", ",", "a2_", ",", "b2_", ",", "c2_"}], 
      "]"}], ":=", 
     RowBox[{"bConcurrencyMatrix", "[", 
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"b1", ",", "b2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"c1", ",", "c2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bIsPerspective", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"bConcurrencyMatrix", "[", 
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"b1", ",", "b2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"c1", ",", "c2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bTrianglePerspector", "[", 
      RowBox[{
      "a1_", ",", "b1_", ",", "c1_", ",", "a2_", ",", "b2_", ",", "c2_"}], 
      "]"}], ":=", 
     RowBox[{"bLineIntersection", "[", 
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"b1", ",", "b2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bTrianglePerspector", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"bLineIntersection", "[", 
      RowBox[{
       RowBox[{"bLine", "[", 
        RowBox[{"a1", ",", "a2"}], "]"}], ",", 
       RowBox[{"bLine", "[", 
        RowBox[{"b1", ",", "b2"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Let", " ", "ABC", " ", "and", " ", 
      RowBox[{"A", "'"}], 
      RowBox[{"B", "'"}], 
      RowBox[{"C", "'"}], " ", "be", " ", "two", " ", "perspective", " ", 
      RowBox[{"triangles", ".", " ", "Denote"}], " ", "by", " ", "\[Kappa]a", 
      " ", "the", " ", "bicevian", " ", "conic", " ", "of", " ", 
      RowBox[{"B", "'"}], " ", "and", " ", 
      RowBox[{"C", "'"}], " ", "wrt", " ", "ABC"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"and", " ", "cyclically", " ", "\[Kappa]b", " ", "and", " ", 
        RowBox[{"\[Kappa]c", ".", " ", "\[IndentingNewLine]", "Consider"}], 
        " ", "the", " ", "common", " ", "points", " ", "of", " ", "these", 
        " ", "conics", " ", "which", " ", "do", " ", "not", " ", "lie", " ", 
        "on", " ", "the", " ", "sides", " ", "of", " ", 
        RowBox[{"ABC", ".", "\[IndentingNewLine]", "There"}], " ", "is", " ", 
        "one", " ", "for", " ", "each", " ", "pair", " ", "of", " ", 
        "conics"}], "-", 
       RowBox[{"let", " ", "A1"}]}], "=", 
      RowBox[{"\[Kappa]b", " ", "\:2229", " ", "\[Kappa]c"}]}], ",", 
     RowBox[{"B1", "=", 
      RowBox[{"\[Kappa]a", " ", "\:2229", " ", "\[Kappa]c"}]}], ",", 
     RowBox[{"C1", "=", 
      RowBox[{"\[Kappa]a", " ", "\:2229", " ", 
       RowBox[{"\[Kappa]b", ".", "\[IndentingNewLine]", "Then"}], " ", 
       "AA1"}]}], ",", " ", 
     RowBox[{"BB1", " ", "and", " ", "CC1", " ", "are", " ", 
      RowBox[{"concurrent", ".", " ", "Call"}], " ", "this", " ", 
      "provisionally", " ", 
      StyleBox["bicevian",
       FontWeight->"Bold"], 
      StyleBox[" ",
       FontWeight->"Bold"], 
      StyleBox["perspector",
       FontWeight->"Bold"], " ", "of", " ", "ABC", " ", "and", " ", 
      RowBox[{"A", "'"}], 
      RowBox[{"B", "'"}], 
      RowBox[{
       RowBox[{"C", "'"}], "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bBicevianPerspector", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u1_", ",", "v1_", ",", "w1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u2_", ",", "v2_", ",", "w2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u3_", ",", "v3_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u1", "*", "u3", "*", "w2", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u3", "*", "v2"}], "-", 
            RowBox[{"u2", "*", "v3"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"v3", "*", "w1"}], "-", 
            RowBox[{"v1", "*", "w3"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1", "*", "v3", "*", "w2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", "*", "v2", "*", "w1"}], "+", 
             RowBox[{"u2", "*", "v1", "*", "w3"}]}], ")"}]}], "-", 
          RowBox[{"u3", "*", "v1", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", "*", "v1", "*", 
              RowBox[{"w2", "^", "2"}]}], "+", 
             RowBox[{"u2", "*", "v2", "*", "w1", "*", "w3"}]}], ")"}]}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v2", "*", "v3", "*", "w1", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u1", "*", "v3"}], "-", 
            RowBox[{"u3", "*", "v1"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u3", "*", "w2"}], "-", 
            RowBox[{"u2", "*", "w3"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1", "*", "v3", "*", "w2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", "*", "v2", "*", "w1"}], "-", 
             RowBox[{"u2", "*", "v1", "*", "w3"}]}], ")"}]}], "+", 
          RowBox[{"u3", "*", "v1", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "u3"}], "*", "v1", "*", 
              RowBox[{"w2", "^", "2"}]}], "+", 
             RowBox[{"u2", "*", "v2", "*", "w1", "*", "w3"}]}], ")"}]}]}], 
         ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"w1", "*", "w2", "*", "w3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u1", "*", "v3"}], "-", 
            RowBox[{"u3", "*", "v1"}]}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"u3", "*", "v2"}], "-", 
            RowBox[{"u2", "*", "v3"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"u1", "*", "v3", "*", "w2", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", "*", "v2", "*", "w1"}], "-", 
             RowBox[{"u2", "*", "v1", "*", "w3"}]}], ")"}]}], "+", 
          RowBox[{"u3", "*", "v1", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u3", "*", "v1", "*", 
              RowBox[{"w2", "^", "2"}]}], "-", 
             RowBox[{"u2", "*", "v2", "*", "w1", "*", "w3"}]}], ")"}]}]}], 
         ")"}]}]}], "}"}]}], ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[701]:=",ExpressionUUID->"ab7891ab-2c51-4a5c-ac53-2f1fcf968492"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bMixtilinearIncircleA", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"4", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "y", " ", "z"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "z", " ", "x"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "x", " ", "y"}]}], ")"}], 
            SuperscriptBox["s", "2"]}], "\[Minus]", 
           RowBox[{"4", 
            SuperscriptBox["b", "2"], 
            SuperscriptBox["c", "2"], 
            RowBox[{"(", 
             RowBox[{"x", "+", "y", "+", "z"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"x", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"s", "/", "b"}], "\[Minus]", "1"}], ")"}], "2"], 
               " ", "y"}], "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"s", "/", "c"}], "\[Minus]", "1"}], ")"}], "2"], 
               " ", "z"}]}], ")"}]}]}], "//", "Simplify"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bMixtilinearIncircleB", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"4", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["a", "2"], "y", " ", "z"}], "+", 
              RowBox[{
               SuperscriptBox["b", "2"], "z", " ", "x"}], "+", 
              RowBox[{
               SuperscriptBox["c", "2"], "x", " ", "y"}]}], ")"}], 
            SuperscriptBox["s", "2"]}], "\[Minus]", 
           RowBox[{"4", 
            SuperscriptBox["a", "2"], 
            SuperscriptBox["c", "2"], 
            RowBox[{"(", 
             RowBox[{"x", "+", "y", "+", "z"}], ")"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"s", "/", "a"}], "\[Minus]", "1"}], ")"}], "2"], 
               "x"}], "+", " ", "y", "+", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"s", "/", "c"}], "\[Minus]", "1"}], ")"}], "2"], 
               " ", "z"}]}], ")"}]}]}], "//", "Simplify"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bMixtilinearIncircleC", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"multiCollect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"4", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["a", "2"], "y", " ", "z"}], "+", 
             RowBox[{
              SuperscriptBox["b", "2"], "z", " ", "x"}], "+", 
             RowBox[{
              SuperscriptBox["c", "2"], "x", " ", "y"}]}], ")"}], 
           SuperscriptBox["s", "2"]}], "\[Minus]", 
          RowBox[{"4", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["b", "2"], 
           RowBox[{"(", 
            RowBox[{"x", "+", "y", "+", "z"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "/", "a"}], "\[Minus]", "1"}], ")"}], "2"], 
              "x"}], "+", " ", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"s", "/", "b"}], "\[Minus]", "1"}], ")"}], "2"], 
              "y"}], "+", " ", "z"}], ")"}]}]}], "//", "Simplify"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8746330303315363`*^9, 3.874633056762065*^9}, {
  3.8746331147009397`*^9, 3.8746331432641993`*^9}, {3.8746332308600974`*^9, 
  3.87463327535168*^9}, {3.8794279444254627`*^9, 3.879427949399571*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[718]:=",ExpressionUUID->"854ee259-2162-45a0-a7f4-91d6c40b8ef6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"H", ".", "M", ".", "Cundy"}], " ", "and", " ", 
        RowBox[{"C", ".", "F", ".", "Parry"}], " ", "have", " ", "studied", 
        " ", "a", " ", "transformation", " ", "we", " ", "shall", " ", "call",
         " ", "the", " ", "Cundy"}], "-", 
       RowBox[{"Parry", " ", 
        RowBox[{"transformation", ":", " ", "Phi", ":", "M"}]}]}], "->", 
      "M1"}], " ", "=", " ", 
     RowBox[{"OM", " ", "\:2229", " ", 
      RowBox[{"HM", "'"}]}]}], ",", 
    RowBox[{"where", " ", 
     RowBox[{"M", "'"}], " ", "is", " ", "the", " ", "isogonal", " ", 
     "conjugate", " ", "of", " ", 
     RowBox[{"M", ".", " ", "\[IndentingNewLine]", "Naturally"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "we", " ", "can", " ", "also", " ", "define", " ", "the", " ", 
       "related", " ", "other", " ", "transformation", " ", 
       RowBox[{"Psi", ":", "M"}]}], "->", "M2"}], "=", 
     RowBox[{"HM", " ", "\:2229", " ", 
      RowBox[{
       RowBox[{"OM", "'"}], "."}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"cundyParryPhi", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"SB", " ", "y"}], " ", "-", " ", 
         RowBox[{"SC", " ", "z"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["c", "2"], "SC", " ", "y"}], "-", 
         RowBox[{
          SuperscriptBox["b", "2"], "SB", " ", "z"}]}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"SC", " ", "z"}], " ", "-", " ", 
         RowBox[{"SA", " ", "x"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["a", "2"], "SA", " ", "z"}], "-", 
         RowBox[{
          SuperscriptBox["c", "2"], "SC", " ", "x"}]}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"SA", " ", "x"}], " ", "-", " ", 
         RowBox[{"SB", " ", "y"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["b", "2"], "SB", " ", "x"}], "-", 
         RowBox[{
          SuperscriptBox["a", "2"], "SA", " ", "y"}]}]]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cundyParryPsi", "[", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["a", "2"], ",", 
        SuperscriptBox["b", "2"], ",", 
        SuperscriptBox["c", "2"]}], "}"}], "/", 
      RowBox[{"cundyParryPhi", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bDrozFarnyPole", "[", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"2", " ", "SA", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"2", " ", "SB", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"2", " ", "SC", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bOrthocorrespondent", "[", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SA", " ", "p", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SB", " ", "q", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SC", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{"p", "+", "q", "+", "r"}], ")"}]}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "r"}], "+", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "p"}], "+", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "q"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bVuPole", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", " ", "r", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], "-", 
             RowBox[{"p", " ", "v", " ", "w", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "p", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}]}], "-", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "p", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "r"}], ")"}]}], "-", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"r", " ", "p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "p", " ", "v", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], "-", 
             RowBox[{"q", " ", "w", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", "q", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}]}], "-", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "q", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", " ", 
              RowBox[{"(", 
               RowBox[{"q", "+", "p"}], ")"}]}], "-", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "u"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "^", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", "q", " ", "w", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}], "-", 
             RowBox[{"r", " ", "u", " ", "v", " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"a", "^", "2"}], " ", "r", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"v", " ", 
              RowBox[{"(", 
               RowBox[{"r", "+", "p"}], ")"}]}], "-", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"w", "+", "u"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"b", "^", "2"}], " ", "r", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u", " ", 
              RowBox[{"(", 
               RowBox[{"r", "+", "q"}], ")"}]}], "-", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"w", "+", "v"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bVuCirclesPoint", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["b", "2"], " ", "p", " ", "u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], " ", "w"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", "p", " ", "u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "p"}], "-", "r"}], ")"}], " ", "v"}], "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "p"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "v", " ", "w"}], 
           "+", 
           RowBox[{"q", " ", "r", " ", "u", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "q", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "p"}], "-", "q"}], ")"}], " ", "w"}]}], ")"}]}], 
        "+", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", "q", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], ")"}]}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "q"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "u", " ", "w"}], 
           "+", 
           RowBox[{"p", " ", "r", " ", "v", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "r", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "r"}], ")"}], " ", "v"}], ")"}]}], "+", 
           RowBox[{"q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", "r", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q"}], "-", "r"}], ")"}], " ", "u"}], "+", 
           RowBox[{"p", " ", 
            RowBox[{"(", 
             RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "r"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "u", " ", "v"}], 
           "+", 
           RowBox[{"p", " ", "q", " ", "w", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bVuCirclesPoint2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["b", "2"]}], " ", "p", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r"}], " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], " ", "w"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", "p", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "r"}], ")"}], " ", "v"}], "-", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "p"}], " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "v", " ", "w"}],
              "+", 
             RowBox[{"q", " ", "r", " ", "u", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], ",", 
       RowBox[{"p", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], " ", "q", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r"}], " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], " ", "w"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", "q", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], "-", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "q"}], " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "u", " ", "w"}],
              "+", 
             RowBox[{"p", " ", "r", " ", "v", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], ",", 
       RowBox[{"p", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], " ", "r", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "+", "r"}], ")"}], " ", "v"}], "-", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", "r", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}], " ", "u"}], "-", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r"}], " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q", "+", "r"}], ")"}], " ", "u", " ", "v"}],
              "+", 
             RowBox[{"p", " ", "q", " ", "w", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v", "+", "w"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bVuCevianTangentialPerspector", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        SuperscriptBox["a", "2"], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "w"}], ")"}]}], ",", 
       RowBox[{
        SuperscriptBox["b", "2"], " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "v"}], ")"}], " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{"v", "+", "w"}], ")"}]}], ",", 
       RowBox[{
        SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{"u", "+", "w"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"v", "+", "w"}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bKP1", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a2"}], " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a2"}], " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bKP2", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "-", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "-", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a2"}], " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "a2"}], " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "-", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "-", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"bKP3", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b2", " ", "b3", " ", "u", " ", "v"}],
           "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a2", " ", "a3", " ", "b1", " ", "b2", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b2", " ", "b3", " ", "u", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a2", " ", "a3", " ", "b2", " ", "b3", " ", 
           SuperscriptBox["u", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b3", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"a1", " ", "a3", " ", "b1", " ", "b2", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b3", " ", "v", " ", "w"}],
           "+", 
          RowBox[{"a1", " ", "a2", " ", "b1", " ", "b2", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bKP4", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a1_", ",", "a2_", ",", "a3_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b1_", ",", "b2_", ",", "b3_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"simplifyRationalBarycentrics", "[", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["u", 
         RowBox[{
          FractionBox[
           SuperscriptBox["u", "2"], 
           RowBox[{"a1", " ", "b1"}]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["v", "a2"], "-", 
             FractionBox["w", "a3"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["v", "b2"], "-", 
             FractionBox["w", "b3"]}], ")"}]}]}]], ",", 
        FractionBox["v", 
         RowBox[{
          FractionBox[
           SuperscriptBox["v", "2"], 
           RowBox[{"a2", " ", "b2"}]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["u", "a1"], "-", 
             FractionBox["w", "a3"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["u", "b1"], "-", 
             FractionBox["w", "b3"]}], ")"}]}]}]], ",", 
        FractionBox["w", 
         RowBox[{
          FractionBox[
           SuperscriptBox["w", "2"], 
           RowBox[{"a3", " ", "b3"}]], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["u", "a1"], "-", 
             FractionBox["v", "a2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["u", "b1"], "-", 
             FractionBox["v", "b2"]}], ")"}]}]}]]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"See", " ", "preamble", " ", "to", " ", "X", 
     RowBox[{"(", "7680", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bHatzipolakisMoses", " ", "[", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "p", " ", "q"}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "p", " ", "r"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox["b", "4"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["c", "2"]}], "+", 
           SuperscriptBox["c", "4"]}], ")"}], " ", "q", " ", "r"}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "p", " ", "q"}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "4"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["c", "2"]}], "+", 
           SuperscriptBox["c", "4"]}], ")"}], " ", "p", " ", "r"}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "+", 
           SuperscriptBox["b", "2"], "-", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "q", " ", "r"}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "4"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox["b", "4"], "-", 
           RowBox[{
            SuperscriptBox["a", "2"], " ", 
            SuperscriptBox["c", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["b", "2"], " ", 
            SuperscriptBox["c", "2"]}]}], ")"}], " ", "p", " ", "q"}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "p", " ", "r"}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["a", "2"], "-", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["a", "2"]}], "+", 
           SuperscriptBox["b", "2"], "+", 
           SuperscriptBox["c", "2"]}], ")"}], " ", "q", " ", "r"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bHodpiece", "[", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        SuperscriptBox["a", "2"], 
        RowBox[{"p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox["a", "2"], "p"]}], "+", 
           FractionBox[
            SuperscriptBox["b", "2"], "q"], "+", 
           FractionBox[
            SuperscriptBox["c", "2"], "r"]}], ")"}]}]], ",", 
       FractionBox[
        SuperscriptBox["b", "2"], 
        RowBox[{"q", " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["a", "2"], "p"], "-", 
           FractionBox[
            SuperscriptBox["b", "2"], "q"], "+", 
           FractionBox[
            SuperscriptBox["c", "2"], "r"]}], ")"}]}]], ",", 
       FractionBox[
        SuperscriptBox["c", "2"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["a", "2"], "p"], "+", 
           FractionBox[
            SuperscriptBox["b", "2"], "q"], "-", 
           FractionBox[
            SuperscriptBox["c", "2"], "r"]}], ")"}], " ", "r"}]]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bOrionTransform", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", 
           SuperscriptBox["u", "2"], " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", 
           SuperscriptBox["u", "2"], " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "v", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["u", "2"], "+", 
             RowBox[{"v", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c", "2"], " ", "u", " ", 
           SuperscriptBox["v", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", 
           SuperscriptBox["v", "2"], " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["b", "2"], " ", "u", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["v", "2"], "+", 
             RowBox[{"u", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["b", "2"], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}], " ", 
           SuperscriptBox["w", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["a", "2"], " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}], " ", 
           SuperscriptBox["w", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["c", "2"], " ", "u", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"u", " ", "v"}], "+", 
             SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}]}], "}"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Let", " ", "C", 
       RowBox[{"(", "P", ")"}], " ", "be", " ", "the", " ", "circumconic", 
       " ", "with", " ", "perspector", " ", "P"}], "=", 
      RowBox[{"p", ":", "q", ":", 
       RowBox[{"r", " ", 
        RowBox[{"(", "barycentrics", ")"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"and", " ", "let", " ", "U"}], "=", 
      RowBox[{
       RowBox[{"u", ":", "v", ":", 
        RowBox[{"w", " ", "and", " ", "F"}]}], "=", 
       RowBox[{"x", ":", "y", ":", 
        RowBox[{"z", " ", "be", " ", "distinct", " ", "points"}]}]}]}], ",", 
     " ", 
     RowBox[{"with", " ", "U", " ", "on", " ", "C", 
      RowBox[{
       RowBox[{"(", "P", ")"}], ".", "\[IndentingNewLine]", "Let"}], " ", "U",
       "*", " ", "be", " ", "the", " ", "point"}], ",", " ", 
     RowBox[{"other", " ", "than", " ", "U"}], ",", " ", 
     RowBox[{
      RowBox[{"that", " ", "lies", " ", "on", " ", "C", 
       RowBox[{"(", "P", ")"}], " ", "and", " ", "on", " ", "the", " ", 
       "line", " ", 
       RowBox[{"FU", ".", " ", "It"}], " ", "is", " ", "called", " ", 
       "circumconic"}], "-", "F", "-", 
      RowBox[{"antipode", " ", "of", " ", "U"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bXAntipodeInCircumconic", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", " ", "r", " ", 
        SuperscriptBox["u", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v", " ", "x"}], "+", 
          RowBox[{"q", " ", "w", " ", "x"}], "+", 
          RowBox[{"p", " ", "w", " ", "y"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v", " ", "x"}], "+", 
          RowBox[{"q", " ", "w", " ", "x"}], "+", 
          RowBox[{"p", " ", "v", " ", "z"}]}], ")"}]}], ",", 
       RowBox[{"p", " ", "r", " ", 
        SuperscriptBox["v", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "w", " ", "x"}], "+", 
          RowBox[{"r", " ", "u", " ", "y"}], "+", 
          RowBox[{"p", " ", "w", " ", "y"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "u", " ", "y"}], "+", 
          RowBox[{"p", " ", "w", " ", "y"}], "+", 
          RowBox[{"q", " ", "u", " ", "z"}]}], ")"}]}], ",", 
       RowBox[{"p", " ", "q", " ", 
        SuperscriptBox["w", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "v", " ", "x"}], "+", 
          RowBox[{"q", " ", "u", " ", "z"}], "+", 
          RowBox[{"p", " ", "v", " ", "z"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"r", " ", "u", " ", "y"}], "+", 
          RowBox[{"q", " ", "u", " ", "z"}], "+", 
          RowBox[{"p", " ", "v", " ", "z"}]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Cevian", " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "w"}], "}"}], " ", "and", " ", "anticevian",
      " ", "of", " ", 
     RowBox[{"{", 
      RowBox[{"p", ",", "q", ",", "r"}], "}"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bAnticevianIntersectionConicCenter", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", "v", " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["q", "2"]}], " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "r", " ", "u"}], "+", 
             RowBox[{"p", " ", "w"}]}], ")"}]}], "+", 
          RowBox[{"p", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["r", "2"]}], " ", "u"}], "+", 
             RowBox[{
              SuperscriptBox["p", "2"], " ", "w"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "q", " ", "r", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "u"}], "+", 
             RowBox[{"p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"q", " ", "u", " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["r", "2"]}], " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", " ", "u"}], "+", 
             RowBox[{"2", " ", "p", " ", "v"}]}], ")"}]}], "+", 
          RowBox[{"q", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["q", "2"], " ", "u"}], "-", 
             RowBox[{
              SuperscriptBox["p", "2"], " ", "v"}]}], ")"}], " ", "w"}], "-", 
          RowBox[{"2", " ", "p", " ", "r", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", " ", "v"}], "+", 
             RowBox[{"q", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"r", " ", "u", " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "p", " ", "q", " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}], "+", 
             RowBox[{"q", " ", "w"}]}], ")"}]}], "-", 
          RowBox[{
           SuperscriptBox["p", "2"], " ", "w", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "v"}], "+", 
             RowBox[{"2", " ", "q", " ", "w"}]}], ")"}]}], "+", 
          RowBox[{"r", " ", "u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["r", "2"], " ", "v"}], "-", 
             RowBox[{
              SuperscriptBox["q", "2"], " ", "w"}]}], ")"}]}]}], ")"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bAnticevianIntersectionConicPerspector", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q", " ", "r", " ", "u"}], "+", 
          RowBox[{"2", " ", "p", " ", "r", " ", "v"}], "+", 
          RowBox[{"p", " ", "q", " ", "w"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "r", " ", "v"}], "+", 
          RowBox[{"2", " ", "q", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "u"}], "+", 
             RowBox[{"p", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"q", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", " ", "u"}], "+", 
             RowBox[{"p", " ", "v"}]}], ")"}]}], "+", 
          RowBox[{"p", " ", "q", " ", "w"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "r", " ", "u"}], "+", 
          RowBox[{"2", " ", "p", " ", "r", " ", "v"}], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", "w"}]}], ")"}]}], ",", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "q", " ", "r", " ", "u"}], "+", 
          RowBox[{"p", " ", "r", " ", "v"}], "+", 
          RowBox[{"2", " ", "p", " ", "q", " ", "w"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"q", " ", "r", " ", "u"}], "+", 
          RowBox[{"2", " ", "p", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "v"}], "+", 
             RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bParallelsConicCenter", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["u", "2"], "-", 
          RowBox[{"2", " ", "v", " ", "w"}], "-", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["v", "2"], "-", 
          RowBox[{"2", " ", "u", " ", "w"}], "-", 
          RowBox[{"v", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "u", " ", "v"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"u", "+", "v"}], ")"}], " ", "w"}], "+", 
          SuperscriptBox["w", "2"]}], ")"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bParallelsConicPerspector", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "v", " ", "w"}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "v"}], "+", "w"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "v", " ", "w"}], "+", 
          RowBox[{"u", " ", 
           RowBox[{"(", 
            RowBox[{"v", "+", 
             RowBox[{"2", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "u", " ", "w"}], "+", 
          RowBox[{"v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "u"}], "+", "w"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "u", " ", "w"}], "+", 
          RowBox[{"v", " ", 
           RowBox[{"(", 
            RowBox[{"u", "+", 
             RowBox[{"2", " ", "w"}]}], ")"}]}]}], ")"}]}], ",", 
       RowBox[{"w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "u", " ", "v"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "u"}], "+", "v"}], ")"}], " ", "w"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "u", " ", "v"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"u", "+", 
             RowBox[{"2", " ", "v"}]}], ")"}], " ", "w"}]}], ")"}]}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bPolluxPoint", "[", 
      RowBox[{"h_", ",", "k_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "-", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "h"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"b", "+", "c"}], ")"}], " ", "k"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "a"}], "+", "c"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"b", " ", "h"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "c"}], ")"}], " ", "k"}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "-", "b"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", " ", "h"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b"}], ")"}], " ", "k"}]}], ")"}]}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"laHireRadicalCenter", "[", "func_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "e", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"e", "=", 
         RowBox[{"symmetrizeInternal2", "[", "func", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"radicalCenter", "[", 
         RowBox[{"xA", ",", 
          RowBox[{"e", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "xB", ",", 
          RowBox[{"e", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "xC", ",", 
          RowBox[{"e", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Let", " ", "A1B1C1", " ", "be", " ", "the", " ", "traces", " ", "of", 
       " ", 
       StyleBox["M",
        FontWeight->"Bold"]}], 
      StyleBox["=",
       FontWeight->"Bold"], 
      RowBox[{
       RowBox[{
        StyleBox[
         RowBox[{"{", 
          RowBox[{"u", ",", "v", ",", "w"}], "}"}],
         FontWeight->"Bold"], " ", "upon", " ", "the", " ", "circumconic", 
        " ", 
        RowBox[{"(", "cc", ")"}], " ", "with", " ", "perspector", " ", 
        StyleBox["N",
         FontWeight->"Bold"]}], 
       StyleBox["=",
        FontWeight->"Bold"], 
       RowBox[{
        RowBox[{
         StyleBox[
          RowBox[{"{", 
           RowBox[{"p", ",", "q", ",", "r"}], "}"}],
          FontWeight->"Bold"], ".", " ", "\[IndentingNewLine]", 
         RowBox[{"A", "'"}]}], 
        RowBox[{"B", "'"}], 
        RowBox[{"C", "'"}], " ", "be", " ", "the", " ", "triangle", " ", 
        "formed", " ", "by", " ", "the", " ", "tangents", " ", "to", " ", 
        RowBox[{"(", "cc", ")"}], " ", "at", " ", "A1"}]}]}], ",", "B1", ",", 
     RowBox[{"and", " ", 
      RowBox[{"C1", ".", "\[IndentingNewLine]", "Let"}], " ", "P", " ", "be", 
      " ", "the", " ", "perspector", " ", "of", " ", 
      RowBox[{"(", "cc", ")"}], " ", "wrt", " ", 
      RowBox[{"A", "'"}], 
      RowBox[{"B", "'"}], 
      RowBox[{"C", "'"}]}], ",", " ", 
     RowBox[{
      RowBox[{
      "here", " ", "it", " ", "is", " ", "called", " ", "the", " ", "N"}], 
      "-", 
      RowBox[{
      "circumconcevian", " ", "tangential", " ", "perspector", " ", "of", " ",
        "M"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bSecondCircumconcevianTangentialPerspector", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "q", " ", "r", " ", 
         SuperscriptBox["u", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["p", "2"], " ", "v", " ", "w"}], "-", 
        RowBox[{"p", " ", "u", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "v"}], "+", 
           RowBox[{"q", " ", "w"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "p", " ", "r", " ", 
         SuperscriptBox["v", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["q", "2"], " ", "u", " ", "w"}], "-", 
        RowBox[{"q", " ", "v", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"r", " ", "u"}], "+", 
           RowBox[{"p", " ", "w"}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["r", "2"], " ", "u", " ", "v"}], "-", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q", " ", "u"}], "+", 
           RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}], "-", 
        RowBox[{"2", " ", "p", " ", "q", " ", 
         SuperscriptBox["w", "2"]}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bKirikamiEuler", "[", 
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["u", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          SuperscriptBox["u", "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            SuperscriptBox["b", "2"], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "u", " ", "v"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "u", " ", "w"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["a", "2"], " ", "v", " ", "w"}]}]], ",", 
       FractionBox["v", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            SuperscriptBox["b", "2"], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "u", " ", "v"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          SuperscriptBox["v", "2"]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["b", "2"], " ", "u", " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "+", 
            SuperscriptBox["b", "2"], "-", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "v", " ", "w"}]}]], ",", 
       FractionBox["w", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["c", "2"], " ", "u", " ", "v"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "+", 
            SuperscriptBox["b", "2"], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "u", " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["a", "2"], "-", 
            SuperscriptBox["b", "2"], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", "v", " ", "w"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["a", "2"]}], "-", 
            SuperscriptBox["b", "2"], "+", 
            SuperscriptBox["c", "2"]}], ")"}], " ", 
          SuperscriptBox["w", "2"]}]}]]}], "}"}]}], ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[721]:=",ExpressionUUID->"e747c5f3-bec1-4d52-bcdb-370e27b77f8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bobillierTransversal", "[", 
    RowBox[{"pp_", ",", "q1_", ",", "q2_", ",", "q3_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"h1", ",", "h2", ",", "h3", ",", "m1", ",", "m2", ",", "m3"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h1", "=", 
       RowBox[{"bPerpendicular", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"pp", ",", "q1"}], "]"}], ",", "pp"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h2", "=", 
       RowBox[{"bPerpendicular", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"pp", ",", "q2"}], "]"}], ",", "pp"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"h3", "=", 
       RowBox[{"bPerpendicular", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"pp", ",", "q3"}], "]"}], ",", "pp"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m1", "=", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"q2", ",", "q3"}], "]"}], ",", "h1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m2", "=", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"q1", ",", "q3"}], "]"}], ",", "h2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m3", "=", 
       RowBox[{"bLineIntersection", "[", 
        RowBox[{
         RowBox[{"bLine", "[", 
          RowBox[{"q1", ",", "q2"}], "]"}], ",", "h3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bLine", "[", 
       RowBox[{"m1", ",", "m2"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[745]:=",ExpressionUUID->"52833883-5115-433b-b514-862dceb9bd4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"centralCircle", "[", "l_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"expr", ",", "eq"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"expr", " ", "=", " ", 
        RowBox[{"symmetrizeInternal", "[", "l", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"expr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "x"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"expr", "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "y"}], " ", "+", 
            RowBox[{
             RowBox[{"expr", "[", 
              RowBox[{"[", "3", "]"}], "]"}], " ", "z"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "x"}], " ", "+", " ", 
            RowBox[{"b", " ", "y"}], " ", "+", 
            RowBox[{"c", " ", "z"}]}], ")"}]}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "y", " ", "z"}], " ", "+", 
           RowBox[{"b", " ", "x", " ", "z"}], " ", "+", " ", 
           RowBox[{"c", " ", "x", " ", "y"}]}], " ", ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"multiCollect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"a", " ", "b", " ", "c", " ", 
           RowBox[{"(", 
            RowBox[{"eq", "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"x", "/", "a"}], ",", " ", 
                 RowBox[{"y", "/", "b"}], ",", " ", 
                 RowBox[{"z", "/", "c"}]}], "}"}]}], "]"}]}], ")"}]}], "//", 
          "Simplify"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y", ",", "z"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bImplicitTangent", "[", 
    RowBox[{"crv_", ",", "pt_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"crv", ",", "x"}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], "]"}]}], 
      ")"}]}], "+", 
    RowBox[{"y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"crv", ",", "y"}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], "]"}]}], 
      ")"}]}], "+", 
    RowBox[{"z", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"crv", ",", "z"}], "]"}], "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], "]"}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bLineFromEq", "[", "lineq_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"lineq", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"lineq", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"lineq", "/.", 
       RowBox[{"Thread", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bNinePointConic", "[", 
    RowBox[{"va_", ",", "vb_", ",", "vc_", ",", "vd_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"p1", "=", 
       RowBox[{
        RowBox[{"bMidpoint", "[", 
         RowBox[{"va", ",", "vb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"p2", "=", 
       RowBox[{
        RowBox[{"bMidpoint", "[", 
         RowBox[{"va", ",", "vc"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"p3", "=", 
       RowBox[{
        RowBox[{"bMidpoint", "[", 
         RowBox[{"vc", ",", "vb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"p4", "=", 
       RowBox[{
        RowBox[{"bMidpoint", "[", 
         RowBox[{"vd", ",", "vb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", 
      RowBox[{"p5", "=", 
       RowBox[{
        RowBox[{"bMidpoint", "[", 
         RowBox[{"vd", ",", "va"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bFivePointConicEq", "[", 
       RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[746]:=",ExpressionUUID->"eeb36738-51f6-4da0-901e-74933ce00d21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Three", " ", "common", " ", "points"}], ",", " ", 
    RowBox[{
    "and", " ", "perspectors", " ", "of", " ", "the", " ", "two", " ", 
     "conics", " ", "wrt", " ", "the", " ", "triangle", " ", "defined", " ", 
     "by", " ", "these", " ", "three", " ", "points"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"b4thConicIntersection", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3_", ",", "y3_", ",", "z3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ix_", ",", "iy_", ",", "iz_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"hx_", ",", "hy_", ",", "hz_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        SuperscriptBox["hz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["iy", "2"], " ", "x1", " ", "x2", " ", "x3"}], "-", 
          RowBox[{"2", " ", "ix", " ", "iy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["ix", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hy", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["iz", "2"], " ", "x1", " ", "x2", " ", "x3"}], "-", 
          RowBox[{"2", " ", "ix", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["ix", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"hx", " ", "hy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "iy", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{"ix", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "ix", " ", "iy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}], "-", 
          RowBox[{"iy", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["iy", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"hz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "iy", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
                RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "ix", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["iy", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
                RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "+", 
             RowBox[{"ix", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"hy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "6", " ", "iy", " ", "iz", " ", "x1", " ", "x2", " ", "x3"}], 
             "-", 
             RowBox[{"2", " ", "ix", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
                RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "+", 
             RowBox[{"ix", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "iz", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
                   RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
                   RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "+", 
                RowBox[{"ix", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                   RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                   RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                   RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                   RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                   RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["hz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["ix", "2"], " ", "y1", " ", "y2", " ", "y3"}], "+", 
          RowBox[{
           SuperscriptBox["iy", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "ix", " ", "iy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hy", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "-", 
          RowBox[{"ix", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["ix", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"hx", " ", "hy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}], "+", 
          RowBox[{"iy", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{"2", " ", "ix", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "ix", " ", "iy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["iz", "2"], " ", "y1", " ", "y2", " ", "y3"}], "-", 
          RowBox[{"2", " ", "iy", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["iy", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"hz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "iy", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x2", " ", "x3", " ", "y1"}], "+", 
                RowBox[{"x1", " ", "x3", " ", "y2"}], "+", 
                RowBox[{"x1", " ", "x2", " ", "y3"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "ix", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y1", " ", "y2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "y3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "y3"}]}], ")"}]}], "+", 
             RowBox[{"ix", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["ix", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}]}], ")"}]}], 
          "-", 
          RowBox[{"hx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "6", " ", "ix", " ", "iz", " ", "y1", " ", "y2", " ", "y3"}], 
             "+", 
             RowBox[{
              SuperscriptBox["iy", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"iz", " ", "x3", " ", "y1", " ", "y2"}], "+", 
                RowBox[{"iz", " ", "x2", " ", "y1", " ", "y3"}], "+", 
                RowBox[{"iz", " ", "x1", " ", "y2", " ", "y3"}], "+", 
                RowBox[{"ix", " ", "y2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"ix", " ", "y1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"ix", " ", "y1", " ", "y2", " ", "z3"}]}], ")"}]}]}], 
            ")"}]}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["hz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["iy", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"ix", " ", "iy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["ix", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hy", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["ix", "2"], " ", "z1", " ", "z2", " ", "z3"}], "+", 
          RowBox[{
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
             RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "ix", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["hx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox["iy", "2"], " ", "z1", " ", "z2", " ", "z3"}], "+", 
          RowBox[{
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "iy", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"hx", " ", "hy", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
          "6", " ", "ix", " ", "iy", " ", "z1", " ", "z2", " ", "z3"}], "+", 
          RowBox[{
           SuperscriptBox["iz", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
             RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
             RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
             RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
             RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
             RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "iz", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"iy", " ", "x3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"ix", " ", "y3", " ", "z1", " ", "z2"}], "+", 
             RowBox[{"iy", " ", "x2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"ix", " ", "y2", " ", "z1", " ", "z3"}], "+", 
             RowBox[{"iy", " ", "x1", " ", "z2", " ", "z3"}], "+", 
             RowBox[{"ix", " ", "y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], 
         ")"}]}], "+", 
       RowBox[{"hz", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hx", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"iy", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", "ix", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y2", " ", "y3", " ", "z1"}], "+", 
                RowBox[{"y1", " ", "y3", " ", "z2"}], "+", 
                RowBox[{"y1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["iy", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "ix", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
                RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
                RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"hy", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "iy", " ", "iz", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x2", " ", "x3", " ", "z1"}], "+", 
                RowBox[{"x1", " ", "x3", " ", "z2"}], "+", 
                RowBox[{"x1", " ", "x2", " ", "z3"}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "ix", " ", "iy", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", " ", "z1", " ", "z2"}], "+", 
                RowBox[{"x2", " ", "z1", " ", "z3"}], "+", 
                RowBox[{"x1", " ", "z2", " ", "z3"}]}], ")"}]}], "+", 
             RowBox[{"ix", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"iz", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x3", " ", "y2", " ", "z1"}], "+", 
                   RowBox[{"x2", " ", "y3", " ", "z1"}], "+", 
                   RowBox[{"x3", " ", "y1", " ", "z2"}], "+", 
                   RowBox[{"x1", " ", "y3", " ", "z2"}], "+", 
                   RowBox[{"x2", " ", "y1", " ", "z3"}], "+", 
                   RowBox[{"x1", " ", "y2", " ", "z3"}]}], ")"}]}], "-", 
                RowBox[{"2", " ", "ix", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"y3", " ", "z1", " ", "z2"}], "+", 
                   RowBox[{"y2", " ", "z1", " ", "z3"}], "+", 
                   RowBox[{"y1", " ", "z2", " ", "z3"}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}]}]}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.8850166607401156`*^9, 3.885016668135591*^9}, {
  3.8850167169309607`*^9, 3.885016753290004*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[750]:=",ExpressionUUID->"15b3e8a6-e87b-4c02-9f2a-fdd61d710068"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsOrthologic", "[", 
     RowBox[{
     "pa_", ",", "pb_", ",", "pc_", ",", "xa_", ",", "xb_", ",", "xc_"}], 
     "]"}], ":=", 
    RowBox[{"bConcurrencyMatrix", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}], ",", "pa"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}], ",", "pb"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xb"}], "]"}], ",", "pc"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsOrthologic", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bConcurrencyMatrix", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}], ",", "pa"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}], ",", "pb"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xb"}], "]"}], ",", "pc"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsOrthologicSimplify", "[", 
     RowBox[{
     "pa_", ",", "pb_", ",", "pc_", ",", "xa_", ",", "xb_", ",", "xc_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"bConcurrencyMatrix", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"xb", ",", "xc"}], "]"}], ",", "pa"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"xa", ",", "xc"}], "]"}], ",", "pb"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"xa", ",", "xb"}], "]"}], ",", "pc"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], "\[IndentingNewLine]", "]"}], "//",
      "Factor"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bOrthologyCenter", "[", 
     RowBox[{
     "pa_", ",", "pb_", ",", "pc_", ",", "xa_", ",", "xb_", ",", "xc_"}], 
     "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}], ",", "pa"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}], ",", "pb"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bOrthologyCenter", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}], ",", "pa"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bPerpendicular", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}], ",", "pb"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsParallelogic", "[", 
     RowBox[{
     "pa_", ",", "pb_", ",", "pc_", ",", "xa_", ",", "xb_", ",", "xc_"}], 
     "]"}], ":=", 
    RowBox[{"bConcurrencyMatrix", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pa", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pb", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pc", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xb"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIsParallelogic", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bConcurrencyMatrix", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pa", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pb", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pc", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xb"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bParallelogicCenter", "[", 
     RowBox[{
     "pa_", ",", "pb_", ",", "pc_", ",", "xa_", ",", "xb_", ",", "xc_"}], 
     "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pa", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pb", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bParallelogicCenter", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xa_", ",", "xb_", ",", "xc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bLineIntersection", "[", 
     RowBox[{
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pa", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}]}], "]"}], ",", 
      RowBox[{"bParallelLine", "[", 
       RowBox[{"pb", ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xc"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bVertexTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qa_", ",", "qb_", ",", "qc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pb", ",", "qb"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pc", ",", "qc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pc", ",", "qc"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pa", ",", "qa"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pa", ",", "qa"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pb", ",", "qb"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bMidTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qa_", ",", "qb_", ",", "qc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"bMidpoint", "[", 
       RowBox[{"pa", ",", "qa"}], "]"}], ",", 
      RowBox[{"bMidpoint", "[", 
       RowBox[{"pb", ",", "qb"}], "]"}], ",", 
      RowBox[{"bMidpoint", "[", 
       RowBox[{"pc", ",", "qc"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSideTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qa_", ",", "qb_", ",", "qc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pb", ",", "pc"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"qb", ",", "qc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pc", ",", "pa"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"qc", ",", "qa"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pa", ",", "pb"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"qa", ",", "qb"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Cross", "-", 
    RowBox[{
    "triangle", " ", "or", " ", "also", " ", "called", " ", "desmic", " ", 
     "product"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pa_", ",", "pb_", ",", "pc_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"qa_", ",", "qb_", ",", "qc_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pb", ",", "qc"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pc", ",", "qb"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pc", ",", "qa"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pa", ",", "qc"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{
        RowBox[{"bLine", "[", 
         RowBox[{"pa", ",", "qb"}], "]"}], ",", 
        RowBox[{"bLine", "[", 
         RowBox[{"pb", ",", "qa"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bIntersectionTriangle", "[", 
     RowBox[{"la_", ",", "lb_", ",", "lc_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"bLineIntersection", "[", 
       RowBox[{"lb", ",", "lc"}], "]"}], ",", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{"lc", ",", "la"}], "]"}], ",", 
      RowBox[{"bLineIntersection", "[", 
       RowBox[{"la", ",", "lb"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCevianTriangleGeneral", "[", 
     RowBox[{"xp_", ",", "xa_", ",", "xb_", ",", "xc_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"la", ",", "lb", ",", "lc"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"la", "=", 
        RowBox[{"bLine", "[", 
         RowBox[{"xb", ",", "xc"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lb", "=", 
        RowBox[{"bLine", "[", 
         RowBox[{"xc", ",", "xa"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lc", "=", 
        RowBox[{"bLine", "[", 
         RowBox[{"xa", ",", "xb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xp", ",", "xa"}], "]"}], ",", "la"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xp", ",", "xb"}], "]"}], ",", "lb"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"xp", ",", "xc"}], "]"}], ",", "lc"}], "]"}]}], 
        "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAntipedal", "[", 
     RowBox[{"pp_", ",", 
      RowBox[{"ref_", ":", 
       RowBox[{"{", 
        RowBox[{"xA", ",", "xB", ",", "xC"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lna", ",", "lnb", ",", "lnc", ",", "ha", ",", "hb", ",", "hc"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lna", "=", 
        RowBox[{
         RowBox[{"bPerpendicular", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{
             RowBox[{"ref", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"ref", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lnb", "=", 
        RowBox[{
         RowBox[{"bPerpendicular", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{
             RowBox[{"ref", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"ref", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lnc", "=", 
        RowBox[{
         RowBox[{"bPerpendicular", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{
             RowBox[{"ref", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", "pp"}], "]"}], ",", 
           RowBox[{"ref", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ha", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"lnb", ",", "lnc"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hb", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"lnc", ",", "lna"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"hc", "=", 
        RowBox[{
         RowBox[{"Cross", "[", 
          RowBox[{"lna", ",", "lnb"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"ha", ",", "hb", ",", "hc"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bBicevianChordal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"symmetrizeTriangleExprType2Bary", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", " ", "u", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{"q", " ", "r", " ", "v", " ", "w"}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "q"}], " ", "v", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["r", "2"], " ", "u", " ", "v"}], "+", 
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"q", " ", "u"}], "+", 
             RowBox[{"p", " ", "v"}]}], ")"}], " ", "w"}], "+", 
          RowBox[{"p", " ", "q", " ", 
           SuperscriptBox["w", "2"]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"-", "r"}], " ", "w", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"p", " ", "r", " ", 
           SuperscriptBox["v", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["q", "2"], " ", "u", " ", "w"}], "+", 
          RowBox[{"2", " ", "q", " ", "v", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"r", " ", "u"}], "+", 
             RowBox[{"p", " ", "w"}]}], ")"}]}]}], ")"}]}]}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bUnaryCofactorTrg", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1_", ",", "y1_", ",", "z1_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x2_", ",", "y2_", ",", "z2_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x3_", ",", "y3_", ",", "z3_"}], "}"}]}], "}"}], "]"}], ":=", 
    RowBox[{"symmetrizeTriangleExprType2Bary", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"y2", " ", "z3"}], "-", 
         RowBox[{"z2", " ", "y3"}]}], ",", 
        RowBox[{
         RowBox[{"z2", " ", "x3"}], " ", "-", " ", 
         RowBox[{"x2", " ", "z3"}]}], ",", 
        RowBox[{
         RowBox[{"x2", " ", "y3"}], "-", 
         RowBox[{"y2", " ", "x3"}]}]}], "}"}], "*", 
      RowBox[{"{", 
       RowBox[{
        SuperscriptBox["a", "2"], ",", 
        SuperscriptBox["b", "2"], ",", 
        SuperscriptBox["c", "2"]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bAntisymmetricTrg", "[", 
     RowBox[{"pt_", ",", 
      RowBox[{"trg_", ":", 
       RowBox[{"{", 
        RowBox[{"xA", ",", "xB", ",", "xC"}], "}"}]}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"bReflectionPP", "[", 
       RowBox[{
        RowBox[{"trg", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "pt"}], "]"}], ",", 
      RowBox[{"bReflectionPP", "[", 
       RowBox[{
        RowBox[{"trg", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", "pt"}], "]"}], ",", 
      RowBox[{"bReflectionPP", "[", 
       RowBox[{
        RowBox[{"trg", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "pt"}], "]"}]}], "}"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSideReflectionTriangle", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "y1_", ",", "y2_", ",", "y3_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l1", ",", "l2", ",", "l3", ",", "pa", ",", "pb", ",", "pc"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l1", "=", 
        RowBox[{
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y3"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l2", "=", 
        RowBox[{
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y3"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"l3", "=", 
        RowBox[{
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y2"}], "]"}]}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pa", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l2", ",", "l3"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pb", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l1", ",", "l3"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pc", "=", 
        RowBox[{
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l1", ",", "l2"}], "]"}], "//", 
         "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"pa", ",", "pb", ",", "pc"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bSideReflectionTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y1_", ",", "y2_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bSideReflectionTriangle", "[", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "y1", ",", "y2", ",", "y3"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossSideReflectionTriangle", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "y1_", ",", "y2_", ",", "y3_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "l12", ",", "l13", ",", "l21", ",", "l23", ",", "l31", ",", "l32", ",",
         "pa", ",", "pb", ",", "pc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l12", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y2"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l13", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y3"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l21", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y1"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l23", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y3"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l31", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y3", ",", "y1"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l32", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x2"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y3", ",", "y2"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pa", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l12", ",", "l13"}], "]"}], "]"}]}], ";", 
       RowBox[{"pb", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l21", ",", "l23"}], "]"}], "]"}]}], ";", 
       RowBox[{"pc", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l31", ",", "l32"}], "]"}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"pa", ",", "pb", ",", "pc"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossSideReflectionTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y1_", ",", "y2_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bCrossSideReflectionTriangle", "[", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "y1", ",", "y2", ",", "y3"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossReflectionTriangle", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "y1_", ",", "y2_", ",", "y3_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "l12", ",", "l13", ",", "l21", ",", "l23", ",", "l31", ",", "l32", ",",
         "pa", ",", "pb", ",", "pc"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"l23", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y3"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l32", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x3"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"l13", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y3"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l31", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"y1", ",", "y3"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"x1", ",", "x3"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l12", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y1"}], "]"}]}], "]"}], "]"}]}], ";", 
       RowBox[{"l21", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bReflectionLL", "[", 
          RowBox[{
           RowBox[{"bLine", "[", 
            RowBox[{"y2", ",", "y1"}], "]"}], ",", 
           RowBox[{"bLine", "[", 
            RowBox[{"x2", ",", "x1"}], "]"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pa", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l23", ",", "l32"}], "]"}], "]"}]}], ";", 
       RowBox[{"pb", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l13", ",", "l31"}], "]"}], "]"}]}], ";", 
       RowBox[{"pc", "=", 
        RowBox[{"simplifyRationalBarycentrics", "[", 
         RowBox[{"bLineIntersection", "[", 
          RowBox[{"l12", ",", "l21"}], "]"}], "]"}]}], ";", 
       RowBox[{"{", 
        RowBox[{"pa", ",", "pb", ",", "pc"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bCrossReflectionTriangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y1_", ",", "y2_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"bCrossReflectionTriangle", "[", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "y1", ",", "y2", ",", "y3"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Perspectors", " ", "related", " ", "to", " ", "PTC", " ", 
    RowBox[{"triangles", ":", 
     RowBox[{
      RowBox[{"X", 
       RowBox[{"(", "62770", ")"}]}], "-", 
      RowBox[{"X", 
       RowBox[{"(", "63195", ")"}]}]}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bPTCTriangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u_", ",", "v_", ",", "w_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p_", ",", "q_", ",", "r_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l_", ",", "m_", ",", "n_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "l"}], " ", 
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}], " ", "v"}], "+", 
             RowBox[{"m", " ", "p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q"}], "+", "r"}], ")"}], " ", "v"}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", " ", "v"}], "+", 
              RowBox[{"2", " ", "r", " ", "v"}], "-", 
              RowBox[{"p", " ", "w"}], "-", 
              RowBox[{"2", " ", "q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["b", "2"], "-", 
             SuperscriptBox["c", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "l"}], " ", 
              RowBox[{"(", 
               RowBox[{"q", "+", "r"}], ")"}], " ", "w"}], "+", 
             RowBox[{"n", " ", "p", " ", 
              RowBox[{"(", 
               RowBox[{"v", "+", "w"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "q"}], "+", "r"}], ")"}], " ", "w"}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", " ", "v"}], "+", 
              RowBox[{"2", " ", "r", " ", "v"}], "-", 
              RowBox[{"p", " ", "w"}], "-", 
              RowBox[{"2", " ", "q", " ", "w"}]}], ")"}]}]}], ")"}]}]}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "r"}], ")"}], " ", "u"}], "-", 
           RowBox[{"l", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "m"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "r"}], ")"}], " ", "u"}], "+", 
           RowBox[{"l", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "p"}], "+", "r"}], ")"}], " ", "u"}], "+", 
           RowBox[{"l", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"q", " ", "u"}], "+", 
              RowBox[{"2", " ", "r", " ", "u"}], "-", 
              RowBox[{"2", " ", "p", " ", "w"}], "-", 
              RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "r"}], ")"}], " ", "w"}], "-", 
           RowBox[{"n", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "m"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "r"}], ")"}], " ", "w"}], "+", 
           RowBox[{"n", " ", "q", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "w"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{"p", "-", "r"}], ")"}], " ", "w"}], "+", 
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "q"}], " ", "u"}], "-", 
              RowBox[{"2", " ", "r", " ", "u"}], "+", 
              RowBox[{"2", " ", "p", " ", "w"}], "+", 
              RowBox[{"q", " ", "w"}]}], ")"}]}]}], ")"}]}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], " ", "u"}], "-", 
           RowBox[{"l", " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["b", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "n"}], " ", 
            RowBox[{"(", 
             RowBox[{"p", "+", "q"}], ")"}], " ", "u"}], "+", 
           RowBox[{"l", " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "p"}], "+", "q"}], ")"}], " ", "u"}], "+", 
           RowBox[{"l", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q", " ", "u"}], "+", 
              RowBox[{"r", " ", "u"}], "-", 
              RowBox[{"2", " ", "p", " ", "v"}], "-", 
              RowBox[{"r", " ", "v"}]}], ")"}]}]}], ")"}]}]}], ",", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["a", "2"], "-", 
             SuperscriptBox["b", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "n"}], " ", 
              RowBox[{"(", 
               RowBox[{"p", "+", "q"}], ")"}], " ", "v"}], "+", 
             RowBox[{"m", " ", "r", " ", 
              RowBox[{"(", 
               RowBox[{"u", "+", "v"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "p"}], "+", "q"}], ")"}], " ", "v"}], "+", 
           RowBox[{"m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "q", " ", "u"}], "+", 
              RowBox[{"r", " ", "u"}], "-", 
              RowBox[{"2", " ", "p", " ", "v"}], "-", 
              RowBox[{"r", " ", "v"}]}], ")"}]}]}], ")"}]}]}], ",", "0"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[751]:=",ExpressionUUID->"9d0490c3-9066-42d3-b57f-2a0b5cb8f081"],

Cell[TextData[{
 StyleBox["preamble X(45695)\n",
  FontWeight->"Bold"],
 "(1) Let T1=A1B1C1 and T2=A2B2C2 be two non-orthologic triangles. Denote as \
T\[CloseCurlyQuote] = A\[CloseCurlyQuote]B\[CloseCurlyQuote]C\
\[CloseCurlyQuote] the triangle bounded by the lines through A1, B1, C1 \
perpendicular to B2C2, C2A2, A2B2, respectively, and denote as T\
\[CloseCurlyDoubleQuote] = \
A\[CloseCurlyDoubleQuote]B\[CloseCurlyDoubleQuote]C\[CloseCurlyDoubleQuote] \
the triangle bounded by the lines through A2, B2, C2 perpendicular to B1C1, \
C1A1, A1B1, respectively. Then for, some pairs of triangles T1 and T2, T1 and \
T\[CloseCurlyQuote] are perspective if, and only if, T2 and T\
\[CloseCurlyDoubleQuote] are perspective.\n\n",
 StyleBox["We call A\[CloseCurlyQuote]B\[CloseCurlyQuote]C orthoidal triangle \
of T1 and T2.",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"6e66dcea-2aab-4466-b7fd-b2bf50085aa5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bOrthoidalTriangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"la", ",", "lb", ",", "lc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "=", 
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"b2", ",", "c2"}], "]"}], ",", "a1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lb", "=", 
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"a2", ",", "c2"}], "]"}], ",", "b1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lc", "=", 
       RowBox[{
        RowBox[{"bPerpendicular", "[", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"a2", ",", "b2"}], "]"}], ",", "c1"}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"simplifyRationalBarycentrics", "/@", 
       RowBox[{"bIntersectionTriangle", "[", 
        RowBox[{"la", ",", "lb", ",", "lc"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[777]:=",ExpressionUUID->"5e3a0070-45b2-4da6-89ca-8971b91f8326"],

Cell[TextData[{
 "(2) Let T1=A1B1C1 and T2=A2B2C2 be two non-parallelogic triangles. Denote \
as T\[CloseCurlyQuote] = A\[CloseCurlyQuote]B\[CloseCurlyQuote]C\
\[CloseCurlyQuote] the triangle bounded by the lines through A1, B1, C1 \
parallel to B2C2, C2A2, A2B2, respectively, and denote as T\
\[CloseCurlyDoubleQuote] = \
A\[CloseCurlyDoubleQuote]B\[CloseCurlyDoubleQuote]C\[CloseCurlyDoubleQuote] \
the triangle bounded by the lines through A2, B2, C2 parallel to B1C1, C1A1, \
A1B1, respectively. Then for, some pairs of triangles T1 and T2, T1 and T\
\[CloseCurlyQuote] are perspective if, and only if, T2 and T\
\[CloseCurlyDoubleQuote] are perspective.\n\n",
 StyleBox["We call A\[CloseCurlyQuote]B\[CloseCurlyQuote]C paraidal triangle \
of T1 and T2.",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"999e3e63-81f2-4654-ae8f-54a6dd1911ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bParaidalTriangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a1_", ",", "b1_", ",", "c1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a2_", ",", "b2_", ",", "c2_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"la", ",", "lb", ",", "lc"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"la", "=", 
       RowBox[{
        RowBox[{"bParallelLine", "[", 
         RowBox[{"a1", ",", 
          RowBox[{"bLine", "[", 
           RowBox[{"b2", ",", "c2"}], "]"}]}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lb", "=", 
       RowBox[{
        RowBox[{"bParallelLine", "[", 
         RowBox[{"b1", ",", 
          RowBox[{"bLine", "[", 
           RowBox[{"a2", ",", "c2"}], "]"}]}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lc", "=", 
       RowBox[{
        RowBox[{"bParallelLine", "[", 
         RowBox[{"c1", ",", 
          RowBox[{"bLine", "[", 
           RowBox[{"a2", ",", "b2"}], "]"}]}], "]"}], "//", 
        "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"simplifyRationalBarycentrics", "/@", 
       RowBox[{"bIntersectionTriangle", "[", 
        RowBox[{"la", ",", "lb", ",", "lc"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[778]:=",ExpressionUUID->"21b370b3-fd0e-41ea-bcf0-9db8f3ff2192"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   GraphicsBox[
    TagBox[RasterBox[CompressedData["
1:eJztnTuPI0lygImTjDP1F/QbGgTonilPWOFktcE9cG8hZwXsCTicOQ6doSdL
GLeda3p0Dv0Dxminze5/MPbYa4n1zoiMfFSxqvj6iG8X03xUZWZERkZkRmb9
65/++4c//26xWPzl98f//fDjX//w668//u0//uX4xx9/+ct//fzLT5t/++V/
fvr5p19Xf/qn45v/fvzvx39eLIp///b9GwAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAy/v2YbF4
2L2dvyR5PG0Wi8Xy0/v5S5LLYb2ItnBRo9X261U3V1nHx8O5m/oCKfvXYrMf
9vOvu+XZGvaw/jy02FfDsY6LxefF8mUme/L2aTVcGe5FKONyWgccSinoxfrp
Uq4DPvvHMyjGzFyj/igjeY1VcCnVrHrduLINoBKu+5rDt//YLctxv+ZLJPwp
Pdu4A39p3FSIVA3fi+sOkSo3fhpP/u1ls/1Q76wWrnonXdzXjfPNVXm1w/p5
nqCj6V/DbGMpu4kaNsX79stKtbygh5FJCFTe1LlmKaPo90+WzufF+rWqywyD
12nKMLZQZD8qi/SxW2eEilNK5ALbfAitU3SiXzfWdcCjHXlv3Gu9tvjC6LDX
VgXBsQvX3lf2bOf+Wfg2xQh17lrM0Eon+Tlfd9tc9agmRd1htHonZgeK4l1R
iDRh6/Vm/2mEdistwLAQ6X376UIWbqZZRSqiG1N1S61uPcAqCPKjnjo4cq9Q
O+GzrRp87z9XKZXqhIY9QfOPVjpsmYcYmZRALbkY4huR8o61zjSx0iQ3kg17
wsT1WEKpg6MvUs0yh+OgBC8JqflzLRZIa1zOb4zg1411HfA4eUn37By21zRX
nMt0Hfbt025WcRdhUQ/XrrbMjidTvTOnu3IWToyCjz/P+m3IUaymFsPT5rcd
IuW23hAO61HabXCi3bEDXkpu2wQhUj0lbpnK8iPHblQOtphg962N89voVPzY
9DT4SqmGN+xgzT+64kGbPNTIRAXqu/ddSRLXHExZkSYiKAowzzA02CsbSyjV
FKVxqZzYJ9IlLwml+TOFSMoaEyJdPFcfIj1triqdJpfJ5PK+fZhV3H1mvw0f
pqK02LN6LPNzUoiUaSGrwcvOrEjM8d5yiDTh+DLeHq6BIdJFbf8ZvTBFTtHy
i63SZfjjGg1tXoLxUf3l+bNuMu/oK9XQhh2q+cemC7riJxiZsECD8VHB62aa
yKVSmLa0lx4ijSWUYHxUfTmRLRnrkheEp/mzhEhePyVEuniuO0QqE7cIkfKZ
f+tZfohUWWZzEf8eFpLyQqQ2ObaTo9rKFO4OwQi0JDNE6gqgi9ruiYh3yXZP
SvGKKEa7NyfrjioM0Y3ZjiDt3Zvv57aeea/2zfodtWmozZgV8nL25TnDpZmD
6tx0/ahDJLfkttqIpq4L2baMm9jp655dSLc7h7bAqJuK7xiefLoWYcqcolKr
DX/Me1/PlscV/n37nHIFu55Yqk1XcS1oUS+3fZymaC1zameBqVRtw9q7KoSS
99V8n9dNeNXmNCMTEGjC/r9uJsl/UwpT/pm4UdC4tQIK7it0xLFaP/Yf/ccS
SiyY+i25QS/aJceTi7h4uzctt8VMzU92wIClSkvW0o2mG7YDU445jcyBJK8j
7IYxjliDY3DkFQ3olUqMHd4dnU+dYnSefGhfmOH5WB+1RfUKb7SMZ8OD2iIU
Q34zeJHy+8c61l9YPv5n9z3PCLctHB4QAy0QaTrXaWkqrkvVKb/SW0dh4nO8
ERUNe2jRT9uzU+oyWI2jjaSqQspRMaUm3nSuFtK9LP2J9T7PWYpdJJQGUNU3
FSKZPkArheN96y/4zu3FhNgZIdKxndvmrdq8kVfZ1AkPM9rCyeyIMkTarB/q
AlTmom26ovCNBlYVsVtVzGmEDyjobHV7x1obZWcR1XdjxuVD15idFTpGGdXt
1NRKqvUi9/Kn9FVXVatvuqGqfx+v+bBSIZKYW6hvKi7blr+SRaD8ZfGay3ZG
/mFVRUlV13Cb67ucSHHVsvl5aZ2qa6rZS3HsQ6WipqPYtxa2PpcGoXTwAulD
nUNbKb/jWUWXkNKokstaBPeQCkWqTJAQzWb96DZ1/pJu1bCbtY6YPEVS53Lk
2A2v2WPe7ylGJijQ6BLSdJR16Qad4s9oGULGrTuoZNMYcNNoKMemT4g0nlCi
S0jpYsS65EjsX1R8VAsltogWEJa/ihTqgLalypCsRFjjVtbFwBQyp8pjCUVJ
8euIyoqRtIsH28GxNhE7USPli6pSdfUVX65HXhmSyGIIJ3b5uFlaFizm+ZR/
KtF09s1qB9fkmjZcURntVjFkpYS4naG/i5eXD3U80gWwUojOrY3Buil8oAWy
ms4PAUSpigI8yIUMN2WlarSASkdGtKjXFPm0jSaOhayiJNfntI2kqkLKUQlJ
zStYVPcy9SfS+5w7JleR4tNcCbsd8gFa37jwP6soqZ0zz/Hn5yUZIhWurFNO
UfK0q1NPtQVnQePDqDHP4KrZYa2VKjDEy3JG/UDHhDq/7WIKVV9lfKK2UZuR
eOsl7qXHRKXwypuVXcndumsUyRO3Y7VckxUzYvagrBVeNpcosyqJ5WNnBghG
HXNr4dHNJNvpT/pEO63Yqe6QwB3rf3P3w2qVdhtWK5JoDRUhxs2mHSIFwnZp
8/tovtnsiTS5oUYmIlAvvM3HPNjQwLq4OjIovU4RM26WnymH++FJX2MK5YRo
NNUlRxGKPk/vdSeOnsiPy+wQKdABY5YqKllfFpY1Dpj945e9ATdkExLXUW65
NBfab9fDt+dfGYtQrh/iDC5yFvRpE667mi/VFizk+XiWULaS7lmu9QvacK2u
dopF1T6ybeXtTI/OU4/Od9LOuXO1mO8XbToVQoZKJYcb9ZNw1B8Z0eJeU8p/
M1a1UkZSj5gxRyUpNXHZQMtn6k+q92WGSIlBMBFAJX0Ar4R5/vy8pEIktQjY
vEIqp0mlFaU8Rn8vUqfGaj23fsWFnjxn1e+Y3WBkKZU0FKpBdPtIvY22Xupe
/UKk8GSgKJJxU2ds8k+JD7dkYN5SVTbQAt0kgwiR9MKQDJG0mQoFBX1q4Suz
yAvy/DGV6uOr96kLE6GplViIFN1NZv2wZ4ik0vYiiQ0DQ6Tk03YGG5mYQE9c
7xuKpUK5ZfCNm+6G7pjlO9V90uxHFcrwkxaSXXIc5Fni79sXObKfGiLZHTBq
qWKSNVo7YY0dc2pmLId6a+o6ylIJQ61/a9bImsl3WtL1Q3Qmm5iu917dLKuX
pebl+4lXm1dsZW67yXXxASg5Pe4LNBz7CAHZrq8Uh+uBh7d7R32/WNMZn9ql
8paNsgaF8CAV95qS/puvZmkjqQoTdVRSUlNTW3bLZ+lPsvflhUjJVPPcWcSA
DyBKOMSfn4OcEClvLc8inmGe0cJ+/5XZntmjqrOomp5wC4RIVuqsnM0bL0RK
3atniNT93KpdYhbFGbJzj4AYGCJ1GQvGKlLE8ngrI2FPvk8tpES86X3tdftO
mvb9Rsndajxha0uR39rphaHJQiQnOWTwKlLqaTvfhhuZuEDPGSL12oj0LWLc
Io608dDS7BBpbKEMDZHSXXIk9s9O2T4Oe7fueQ9sciXVI0TKzp0bNUTKdksi
17HSBqJxRCREMh+wK5xbPz9crKsGt1MlQqRI3r65/8WtezCNoX3Hv4huK1ll
P2vL2QiWzASQ+XjBjH2lNmFXfOwQKfvoj8iIFveakv6b5xlmGMl+IVJcakIo
WZuMohmwsd6XFyJFDmrITImJ+wBeiHT+NaNQFUzNfHs6vNk9qMnUOmkVKctd
DKwidQmx3lkKO0PoUmGGhEjyzIHg90deRYrca0CI5FxEbQnMD5GM7d7mYf4D
QiQj2MwOkeI7NMN7ZBK1cL4gdxx4x9aF3lT6f2KinVepkG3Xq0i+tdyFfzhO
iCR1aViIVDRXRlsNMTJpgZ4n0a6ocluw4jrJAsSM2xQh0hRCGTJ1kNMlRxKK
CJHeXoStENFTkt6rSCFLNe0qknbPQk8xS65GGUstg1eRrPn/wBkIyfTR5vlu
qVUk2/OxtjN7JjcaIjnvB6QWWEVyTmSSO7PSrm8rEZl5aAcORTWjvt80q0he
4Jl259x+Efeakv7bxCFSUmrxuNV/0GRia0ms9528ipQzhZj0AXwXLsufn5dg
iPR1t+5OHdEbWwLbHHxCyYq5vmLMK2tSAkRIYsUF/h7YPiGSZ/ZDn/oNckKI
lLpXz71I3hM/RWAi82M9vRWDmjYI9jxG/xDJOssiN0QKyN3QmX61aPCO7bL8
MetALd/NjjneyYwdaSSd+d7kXiTR+E59JwuRjN27fUOk6NNIvZbvZWTyBRo8
7HQz0TEOzjOGsh4aGzVuMUfat/w5IdJEQokNuOYyTZYER8MJx8SZk8f3+013
9AmRopZqshCpmaCWa/SBK8euY2xi8o9cyAyRjERxb6koPtkY2OgR8/Mjno9/
yI9/gEBwL1LAhlvF9tx1dSChdbvUIosWit8+qpq27zd6iOQrXmhYj4xoca8p
5b8F0uqiRjI/REpLTZlxs+Uz9SfV+3rtRQo9+D4xfZf2AYSrme3Pz4w+jMWp
jtsXxMuoph/hNvhJFPU7WcOZKp6dydO9ItZGeYzH8rzvn/zoWB39Ye6KDZZH
hxg64jA2LkVaL34vP697IYeMZq2tCMNFsoFvl/TRQMGzery87nSk6U7vmMc1
mHMs3X2fDsbskJwkMZL2/awG3XQ5tSgvbszkW+6fOoisywLSet68L01x4eBl
TOA76+9Bd7cxNRlS0+odT7tVSmVvAbAWKbrV9q+H/dcsu9HvoLA+RiZXoN1F
1DTatA8qKopXDkmZj6aNGjdT87VPYqTuhMs2kVDa0EmJpmgEbyDuIcHRaBIg
j1V4PrTvGAe2dIkl1nW05ic6YLjnxiXrFd6yxiFz6m8KyE11MK8jYiI1ie3F
EcEaWeOyPurBffknTjgvOQQHLJh1WbXZPJpgL4LZ7qZBGx5XJPFN6/rHu5dp
P0b45mCtf0WqmWyBeNOVn1bTs2aprNSvkBAFkRE8w2sKfWqeTJIwkmYVbE2I
Sq0LWOoV21DL5+pPvPd9T+iJ8zXvzLragUmPTVEfwNodn68A8xDYDWponTAy
slLmvISm8TQa+g1kbncw8jM7ex4pg1P+h92+rng4+i4O/e6+rwdot930gnX3
vvja8SJi3HHzo2IlD92rxOlE9e1Wywc5YdL8SpoUHVhJccuMhccyinlYyV6p
fmLRXHz56R9ihDJ30VZVc8qzfuqybRMNq5rCeRXdX+w+1gN0qhZV/o+IaKwz
69yvCRKP1Mz5ZkiNdcmFhlfKVpxHakSRtgOwfhIXjyXhL5psDbckfjs77yw/
HdQ+uITme+1jIQWXZWQyBSrtj97wMnW+dBMs5G6DChi3vyuJKHH7OlA98qOw
Ifa4OZVQHKrJydjeoiESHAupCXZdkibd+UJWBzR6ru5rpmQlnTV+zzCn4hbR
CZMe1zEmyZvfSmOia2RO9Zj7LPTLnBZTJ4e3ZbNHiqDno/qOlw+5cj6qApNV
eT52xIZrIqO/uP5TOyf2f267mXF6YLktUk3ro4yma0vYDeXiIoHhJsudC/SL
jHYLfipPKZHaFTKSugrJHhGQmli99eerZS166E+o93lHsmTtSBpiYAM+wP8K
d9TYcJdTqltDP3fvYonsXoRL5WljmP2nzSUcqg/zcTVG5p64LaFk5hnuH+9s
fD8z79tHa1vfw9SzGdfGZWQuwdWRnV8Ng4g8YbDXcUBzQIh0bRQzFdZQaMZN
cKtck5G5G25NKId1TgrE0SLF9zbCqOztB2iacdNdE2gogAix83n6HVYDFioL
QjT1JU4wmsm6cMH4m5qrFW28lLvh2ozMXXCDQkk8LbcgfJQoTESTeqT3n7KQ
J9sHxwZ6IzcReBtFWVo6EbG918szH3ag7oTIbaqsQVwPei8Sc2X3w5UZmfvg
JoWSdQY7nANvLxKT2x3+8WgAGbjPB292yMY2igIAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAxWH9ebEoWb+e
vTAAAAAAAABn5H37ZbMv//32slp8Xm0/zl4kAAAAAACAM/Fx2Hcx0TFcWixf
3s9fKgAAAAAAgPNThEjk2gEAAAAAABR87JZfdm9nLwYAAAAAAMDkFCtE8TMZ
9s9sRAIAAAAAuBU+dsvmWLZFtRTysdvOnzN2IcUI8bpZfK4PZ/A/GiHF7kKq
fyHFAAAAAAA4F4Xn7yyO1B7y6Wsi79vnPolnUxVjLMqFpOeD8dGxqOb7SAEA
AAAA4PqwPP9xttUc1j0uMl0xRqIMFoylIlnI/XNgmQkpAAAAAABcB6VXrH3g
w/r0ZZEBzvkkxRiH8rFHXvhTrrm4DD30GykAAAAAAFwKpfMfSCE7iV7O+WjF
qK4z+uHb++eybG1M1LOcyVLdmBQAAAAAAK6Z5ri2kfOp+jnnYxWjiGWGr+aE
63K85pdVFTuUcUS/7TkZpbopKQAAAAAAXDuVDx88sW0IfZ3ziYoxBuXiURfg
hPYlIQUAAAAAgBuiTrIazTEe4pxPUIwRKEIGty6ThUhIAQAAAADgjLy9bFS2
WOUYD8lScx+mE8PITxuzGCma9ZEY3n3LLDvnzQGJdkgBAAAAAODy2T97rnLl
Y3u79Z3IolhWyDvaOnf9Ir8Y56HIsnNLGH5A0sRScNt2mxu5jCqFOgRjaQkA
AAAAbpLC1ddrBGrTzTffTy6WVPL28mc653nFOB86y64o24gxwoDqWz+ZQwpH
0RcVf3tZTZRkCAAAAABwVspgR+yp8cKfMj4yPOesNZRM5zyjGH0Y+9BvETsM
TrELl6p39XtWcDQpHEPFqh2OBfACtOocvNGSDwEAAAAAzsDrpvKHxfYcEfuY
DxIt4qZtln+e55yni+EuW9RHUkfWUMY/9Nvd4DM0cAuWKqP66vvLl926RzAy
lhTqJaTvTqykVYUQCQAAAABum1PPbRt4lpp/nW23iFMdKfC+fb7Pp/Yc1kXY
chg/RErSPjNXLzYBAAAAANwN+piCvowUyLzumjJ0sVLeeRE3xvv2S1nrInTN
r/44UuiS64q7s1oEAAAAAPfIuEdbn1CMXR0OvB7auGD/ehmH3c0tDnGu4Jx3
3z/XK0dFMcZZHAQAAAAAuDbK3CovpSr/uOlxaBeMurCo2ThzRxRbkJwjI2YP
UpoQqdhzdHeNDwAAAADQUG7edxaS+qV4jUR90zo0KwKEC3le0mzIIwQLocze
AvWJGceSsIQEAAAAAPeNyO86l3vsnBVwIQ9Lmov6LO4ms679c/ZcOx4aCwAA
AABwUdxhch0AAAAAAECA/fP5D44AAAAAAAC4DLrnlgIAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAEA2/w9hLYo9
      "], {{0, 48.}, {672.6, 0}}, {0, 255},
      ColorFunction->RGBColor,
      ImageResolution->{120., 120.},
      SmoothingQuality->"High"],
     BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSize->{694.4999999999909, Automatic},
    ImageSizeRaw->{672.6, 48.},
    PlotRange->{{0, 672.6}, {0, 48.}}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bPointByAngles", "[", 
      RowBox[{"ang1_", ",", "ang2_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["a", "2"]}], ",", 
         RowBox[{"SC", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang1", "]"}]}]}], ",", 
         RowBox[{"SB", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang2", "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SC", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang2", "]"}]}]}], ",", 
         RowBox[{"-", 
          SuperscriptBox["b", "2"]}], ",", 
         RowBox[{"SA", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang1", "]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SB", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang1", "]"}]}]}], ",", 
         RowBox[{"SA", "+", 
          RowBox[{"S", " ", 
           RowBox[{"Cot", "[", "ang2", "]"}]}]}], ",", 
         RowBox[{"-", 
          SuperscriptBox["c", "2"]}]}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Gives", " ", "the", " ", "directed", " ", "angle", " ", "between", " ", 
     "P1P2", " ", "and", " ", "P2P3"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bAngle", "[", 
      RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"l1", ",", "l2", ",", "k"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l1", "=", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"p1", ",", "p2"}], "]"}], "//", 
          "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"l2", "=", 
         RowBox[{
          RowBox[{"bLine", "[", 
           RowBox[{"p2", ",", "p3"}], "]"}], "//", 
          "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k", "=", 
         RowBox[{
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "l1", ",", 
             "l2"}], "}"}], "]"}], "//", "Simplify"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         FractionBox[
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cot", "[", "A", "]"}], ",", 
             RowBox[{"Cot", "[", "B", "]"}], ",", 
             RowBox[{"Cot", "[", "C", "]"}]}], "}"}], ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bInfinityPoint", "[", "l1", "]"}], "*", 
             RowBox[{"bInfinityPoint", "[", "l2", "]"}]}], ")"}]}], "k"], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[779]:=",ExpressionUUID->"c9d217b9-be95-4c44-91cb-857eb2c0de9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Transforms", " ", "the", " ", "curve", " ", "with", " ", "barycentric", 
      " ", "eq", " ", "crv", " ", "wrt", " ", "to", " ", "VaVbVc", " ", "to", 
      " ", "the", " ", "barycentric", " ", "coordinates", " ", "of", " ", 
      "ABC"}], ";", "\[IndentingNewLine]", 
     RowBox[{
     "crv", " ", "should", " ", "be", " ", "a", " ", "function", " ", "of", 
      " ", "only", " ", "a"}]}], ",", "b", ",", "c", ",", "x", ",", "y", ",", 
    RowBox[{"z", " ", "of", " ", "the", " ", 
     StyleBox["reference",
      FontWeight->"Bold",
      FontSlant->"Italic"], " ", 
     RowBox[{"triangle", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bCurveForTriangle", "[", 
      RowBox[{"crv_", ",", "va_", ",", "vb_", ",", "vc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xa", ",", "ya", ",", "za", ",", "xb", ",", "yb", ",", "zb", ",", 
         "xc", ",", "yc", ",", "zc", ",", "rls", ",", "a1", ",", "b1", ",", 
         "c1", ",", "repl"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", "b1", ",", "c1"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xa", ",", "ya", ",", "za"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xb", ",", "yb", ",", "zb"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xc", ",", "yc", ",", "zc"}], "}"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"repl", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xa", "+", "ya", "+", "za"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xc"}], " ", "yb", " ", "z"}], "+", 
                RowBox[{"xb", " ", "yc", " ", "z"}], "+", 
                RowBox[{"xc", " ", "y", " ", "zb"}], "-", 
                RowBox[{"x", " ", "yc", " ", "zb"}], "-", 
                RowBox[{"xb", " ", "y", " ", "zc"}], "+", 
                RowBox[{"x", " ", "yb", " ", "zc"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "xc"}], " ", "yb", " ", "za"}], "+", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "+", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "-", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "-", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "+", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xb", "+", "yb", "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xc"}], " ", "ya", " ", "z"}], "+", 
                RowBox[{"xa", " ", "yc", " ", "z"}], "+", 
                RowBox[{"xc", " ", "y", " ", "za"}], "-", 
                RowBox[{"x", " ", "yc", " ", "za"}], "-", 
                RowBox[{"xa", " ", "y", " ", "zc"}], "+", 
                RowBox[{"x", " ", "ya", " ", "zc"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xc", " ", "yb", " ", "za"}], "-", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "-", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "+", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "+", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "-", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xb"}], " ", "ya", " ", "z"}], "+", 
                RowBox[{"xa", " ", "yb", " ", "z"}], "+", 
                RowBox[{"xb", " ", "y", " ", "za"}], "-", 
                RowBox[{"x", " ", "yb", " ", "za"}], "-", 
                RowBox[{"xa", " ", "y", " ", "zb"}], "+", 
                RowBox[{"x", " ", "ya", " ", "zb"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"xc", "+", "yc", "+", "zc"}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "xc"}], " ", "yb", " ", "za"}], "+", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "+", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "-", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "-", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "+", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"rls", "=", 
         RowBox[{"Thread", " ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "xa", ",", "ya", ",", "za", ",", "xb", ",", "yb", ",", "zb", ",", 
             "xc", ",", "yc", ",", "zc"}], "}"}], "->", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"va", ",", "vb", ",", "vc"}], "}"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"crv", "/.", 
           RowBox[{"setupBaseTriangleBary", "[", 
            RowBox[{"a1", ",", "b1", ",", "c1"}], "]"}]}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "repl"}], 
           "]"}]}], "/.", "rls"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "use", " ", "this", " ", "when", " ", "crv", " ", "is", " ", "already", 
     " ", "expressed", " ", "in", " ", "the", " ", "terms", " ", "of", " ", 
     "the", " ", "target", " ", "triangle"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bCurveForTriangleNoReplace", "[", 
      RowBox[{"crv_", ",", "va_", ",", "vb_", ",", "vc_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xa", ",", "ya", ",", "za", ",", "xb", ",", "yb", ",", "zb", ",", 
         "xc", ",", "yc", ",", "zc", ",", "rls", ",", "repl"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"repl", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xa", "+", "ya", "+", "za"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xc"}], " ", "yb", " ", "z"}], "+", 
                RowBox[{"xb", " ", "yc", " ", "z"}], "+", 
                RowBox[{"xc", " ", "y", " ", "zb"}], "-", 
                RowBox[{"x", " ", "yc", " ", "zb"}], "-", 
                RowBox[{"xb", " ", "y", " ", "zc"}], "+", 
                RowBox[{"x", " ", "yb", " ", "zc"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "xc"}], " ", "yb", " ", "za"}], "+", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "+", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "-", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "-", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "+", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"xb", "+", "yb", "+", "zb"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xc"}], " ", "ya", " ", "z"}], "+", 
                RowBox[{"xa", " ", "yc", " ", "z"}], "+", 
                RowBox[{"xc", " ", "y", " ", "za"}], "-", 
                RowBox[{"x", " ", "yc", " ", "za"}], "-", 
                RowBox[{"xa", " ", "y", " ", "zc"}], "+", 
                RowBox[{"x", " ", "ya", " ", "zc"}]}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xc", " ", "yb", " ", "za"}], "-", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "-", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "+", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "+", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "-", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "xb"}], " ", "ya", " ", "z"}], "+", 
                RowBox[{"xa", " ", "yb", " ", "z"}], "+", 
                RowBox[{"xb", " ", "y", " ", "za"}], "-", 
                RowBox[{"x", " ", "yb", " ", "za"}], "-", 
                RowBox[{"xa", " ", "y", " ", "zb"}], "+", 
                RowBox[{"x", " ", "ya", " ", "zb"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{"xc", "+", "yc", "+", "zc"}], ")"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "xc"}], " ", "yb", " ", "za"}], "+", 
              RowBox[{"xb", " ", "yc", " ", "za"}], "+", 
              RowBox[{"xc", " ", "ya", " ", "zb"}], "-", 
              RowBox[{"xa", " ", "yc", " ", "zb"}], "-", 
              RowBox[{"xb", " ", "ya", " ", "zc"}], "+", 
              RowBox[{"xa", " ", "yb", " ", "zc"}]}], ")"}]}]}], "}"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"rls", "=", 
         RowBox[{"Thread", " ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "xa", ",", "ya", ",", "za", ",", "xb", ",", "yb", ",", "zb", ",", 
             "xc", ",", "yc", ",", "zc"}], "}"}], "->", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"va", ",", "vb", ",", "vc"}], "}"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"crv", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "repl"}], 
           "]"}]}], "/.", "rls"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[781]:=",ExpressionUUID->"759b48cb-720c-4422-8492-7ed91074661d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"prmCircumcircle", " ", "=", " ", 
   RowBox[{"symmetrizeInternal2", "[", 
    RowBox[{
     SuperscriptBox["a", "2"], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"b", "-", "c"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", 
         RowBox[{"t", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b", "+", "c"}], ")"}]}]}], ")"}]}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[783]:=",ExpressionUUID->"9225f018-c9d8-468b-845e-c4d1342582f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bAntiparallels", " ", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"v1_", ":", "xA"}], ",", 
     RowBox[{"v2_", ":", "xB"}], ",", 
     RowBox[{"v3_", ":", "xC"}]}], "]"}], "=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "crc", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"crc", "=", 
       RowBox[{"bCircleEq", "[", 
        RowBox[{"v1", ",", "v2", ",", "v3"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bParallelLine", "[", 
         RowBox[{"pt", ",", 
          RowBox[{"bPolar", "[", 
           RowBox[{"crc", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2", ",", "v3"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[784]:=",ExpressionUUID->"9299d69f-5036-47e3-97c3-4d69a4088665"],

Cell[BoxData[
 RowBox[{
  RowBox[{"drawTriangles", "[", 
   RowBox[{"trgset_", ",", 
    RowBox[{"pa_", ":", "PA"}], ",", 
    RowBox[{"pb_", ":", "PB"}], ",", 
    RowBox[{"pc_", ":", "PC"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"drset", ",", "trgsete"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"drset", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"trgsete", "=", 
      RowBox[{"evaluate", "[", "trgset", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"drset", ",", 
       RowBox[{"{", 
        RowBox[{"Triangle", "[", 
         RowBox[{"{", 
          RowBox[{"pa", ",", "pb", ",", "pc"}], "}"}], "]"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"drset", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"RGBColor", "[", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0.8"}], "]"}], ",", 
         RowBox[{"Triangle", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"bToCartesian", "[", 
                RowBox[{"#", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "/.", 
               RowBox[{"setupBaseTriangle", "[", 
                RowBox[{"pa", ",", "pb", ",", "pc"}], "]"}]}], ",", "30"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"trgsete", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "trgset", "]"}], ">=", "2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"drset", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "0.5", ",", "1", ",", "0.8"}], "]"}], ",", 
            RowBox[{"Triangle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bToCartesian", "[", 
                   RowBox[{"#", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "/.", 
                  RowBox[{"setupBaseTriangle", "[", 
                   RowBox[{"pa", ",", "pb", ",", "pc"}], "]"}]}], ",", "30"}],
                 "]"}], "&"}], "/@", 
              RowBox[{"trgsete", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "trgset", "]"}], ">=", "3"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"drset", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0", ",", "1", ",", "0.5", ",", "0.8"}], "]"}], ",", 
            RowBox[{"Triangle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bToCartesian", "[", 
                   RowBox[{"#", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "/.", 
                  RowBox[{"setupBaseTriangle", "[", 
                   RowBox[{"pa", ",", "pb", ",", "pc"}], "]"}]}], ",", "30"}],
                 "]"}], "&"}], "/@", 
              RowBox[{"trgsete", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "trgset", "]"}], ">=", "4"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"drset", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"1", ",", "0.1", ",", "0.5", ",", "0.8"}], "]"}], ",", 
            RowBox[{"Triangle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bToCartesian", "[", 
                   RowBox[{"#", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "/.", 
                  RowBox[{"setupBaseTriangle", "[", 
                   RowBox[{"pa", ",", "pb", ",", "pc"}], "]"}]}], ",", "30"}],
                 "]"}], "&"}], "/@", 
              RowBox[{"trgsete", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "trgset", "]"}], ">=", "5"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"drset", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.5", ",", "0", ",", "1", ",", "0.5"}], "]"}], ",", 
            RowBox[{"Triangle", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"bToCartesian", "[", 
                   RowBox[{"#", ",", "pa", ",", "pb", ",", "pc"}], "]"}], "/.", 
                  RowBox[{"setupBaseTriangle", "[", 
                   RowBox[{"pa", ",", "pb", ",", "pc"}], "]"}]}], ",", "30"}],
                 "]"}], "&"}], "/@", 
              RowBox[{"trgsete", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", "drset", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[785]:=",ExpressionUUID->"eb2b4d3b-1ccf-4cc1-a20d-5e114c86abaf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<TriangleTools.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<TriangleTools.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "bVertexTriangle", ",", "bMidTriangle", ",", "bSideTriangle", ",", 
      "bIsogonalConjugate", ",", "bIsotomicConjugate", ",", " ", 
      "bPIsogonalConjugate", ",", " ", "bDistanceF", ",", " ", 
      "bCoordChangeK", ",", "setupBaseTriangle", ",", "setupBaseTriangleBary",
       ",", "setupParamTriangle", ",", " ", "bDistance", ",", " ", "bLine", 
      ",", " ", "bLineL", ",", "bLineIntersection", ",", " ", "bIntersection",
       ",", " ", "bCoordChange", ",", " ", "bReverseCoordChange", ",", " ", 
      "bToTril", ",", " ", "bFromTrilinear", ",", " ", "bToCartesian", ",", 
      " ", "bPerpendicular", ",", " ", "cToBary", ",", " ", 
      "bCollinearityMatrix", ",", "bConcurrencyMatrix", ",", " ", 
      "cCollinearityMatrix", ",", " ", "cConcurrencyMatrix", ",", " ", 
      "multiCollect", ",", " ", "bAubertLine", ",", " ", "bAubertCenter", ",",
       " ", "bAubertCenter2", ",", " ", "bAubertCenter3", ",", " ", 
      "bIsParallel", ",", " ", "bMidpoint", ",", " ", "bParallelLine", ",", 
      "bDistancePointLine", ",", "bCircle4Check", ",", " ", "bCevianQuotient",
       ",", " ", "bCevianProduct", ",", "bCrosspoint", ",", " ", "bTripole", 
      ",", " ", "bCrossConjugate", ",", " ", "bComplement", ",", " ", 
      "bAntiComplement", ",", "bAlephConjugate", ",", " ", "bCrossDiff", ",", 
      " ", "bCrossSum", ",", " ", "bHirstInverse", ",", " ", 
      "bAnticomplementaryConjugate", ",", "bLineConjugate", ",", " ", 
      "bBethConjugate", ",", " ", "bComplementaryConjugate", ",", " ", 
      "bFivePointConicEq", ",", "checkPointOnConic", ",", "bConicCenter", ",",
       " ", "bSaragossa1", ",", " ", "bSaragossa2", ",", " ", "bSaragossa3", 
      ",", " ", "bDistanceMod", ",", "bCircleEq", ",", "bCircleCenter", ",", 
      "bCircumcevianTriangle", ",", "bInconicEq", ",", "bCircumconicEq", ",", 
      "bTripolarEq", ",", " ", "bCircumconicPEq", ",", " ", 
      "bReciprocalConjugate", ",", "bToSearchNumbers", ",", "bPerspector", 
      ",", "conicEqtoMtx", ",", " ", "bVertexConjugate", ",", 
      "bTrilinearProduct", ",", " ", "bCirclecevianPerspector", ",", 
      "bTCCPerspector", ",", "bEigentransform", ",", "bAntitomicConjugate", 
      ",", "bReflectionPL", ",", "bTripolarEqGeneral", ",", "bInversePoint", 
      ",", "ExpressionToTrad", ",", " ", "bZosmaTransform", ",", " ", 
      "GetKey", ",", " ", "bCoordChangeParam", ",", "bKirikamiCenter", ",", 
      "bOrthopole", ",", " ", "bSyngonal", ",", "  ", "bCircleEqRad", ",", 
      " ", "circleBaryCoords", ",", " ", "radicalCenter", ",", 
      "bCevianTriangle", ",", "cLineFromBary", ",", "bReflectionPP", ",", 
      "bHomotethy", ",", " ", "bMixtilinearIncircleA", ",", " ", 
      "bMixtilinearIncircleB", ",", " ", "bMixtilinearIncircleC", ",", 
      "bPolar", ",", "bCyclocevianConjugate", ",", "bExsimilicenter", ",", 
      "bExsimilicenter2", ",", " ", "bInsimilicenter", ",", 
      "bInsimilicenter2", ",", "bInsimilicenter3", ",", " ", "bPedalTriangle",
       ",", "bBicevianConic", ",", "symmetrizeTriangle", ",", 
      "bCircumcircleInverse", ",", "bOrthoassociate", ",", "bTripoleL", ",", 
      "symmetrizeTriangleType2", ",", "bDaoConjugate", ",", "cundyParryPhi", 
      ",", "cundyParryPsi", ",", "bHarmonicConjugate", ",", 
      "bHarmonicConjugateFull", ",", "NormalizeBary", ",", 
      "bAnticevianTriangle", ",", "bDualConic", ",", "bDrozFarnyPole", ",", 
      "bOrthocorrespondent", ",", "bVuPole", ",", "bPole", ",", 
      "centralCircle", ",", "bImplicitTangent", ",", " ", "bLineFromEq", ",", 
      " ", "bCollingsTransform", ",", " ", "symmetrizeInternal2", ",", 
      "symmetrizeTriangleExprType2Bary", ",", "bToCartesianN", ",", 
      "symmetrizeTriangleExprType1Bary", ",", "bKP1", ",", "bKP2", ",", 
      "bKP3", ",", "bKP4", ",", "bPerspectorGeneric", ",", 
      "b4thConicIntersection", ",", "bLineIntersectionETC", ",", 
      "bFootPerpendicular", ",", "bPerspectivityAxis", ",", "bPerspeconic", 
      ",", "bEllipse", ",", "bIsOrthologic", ",", "bHatzipolakisMoses", ",", 
      "bFregierTriangle", ",", "bFuhrmannTriangle", ",", "bZayinConjugate", 
      ",", "bWawConjugate", ",", "symmetrizeInternal3", ",", "radicalAxis", 
      ",", "bPointByAngles", ",", "bLozadaPerspector", ",", 
      "bLozadaPerspector2nd", ",", "multiCollectFactors", ",", 
      "bOrthologyCenter", ",", "bIsPerspective", ",", "bCurveForTriangle", 
      ",", "bSteinerImage", ",", "bHodpiece", ",", "bXAntipodeInCircumconic", 
      ",", "bCircleInvervse", ",", "bAubertCenterSimplify", ",", 
      "bVuCirclesPoint", ",", "bVuCirclesPoint2", ",", 
      "bAnticevianIntersectionConicCenter", ",", 
      "bAnticevianIntersectionConicPerspector", ",", "bParallelsConicCenter", 
      ",", "bParallelsConicPerspector", ",", "bInverseInConic", ",", "bDC", 
      ",", "bCD", ",", "bPolluxPoint", ",", "bAreLinePerpendicular", ",", 
      "bCircleOnDiameter", ",", "laHireRadicalCenter", ",", 
      "bSecondCircumconcevianTangentialPerspector", ",", 
      "bVuCevianTangentialPerspector", ",", "bCircumconcevianTriangle", ",", 
      "bMiquelAssociate", ",", "bHaimovTriangle", ",", "bTripolarCentroid", 
      ",", "bCurveForTriangleNoReplace", ",", "bTrianglePerspector", ",", 
      "bTangentialTriangle", ",", "bobillierTransversal", ",", 
      "multiCollectFactorsABC", ",", "multiCollectABC", ",", 
      "bPCevianTriangle", ",", "bIsParallelogic", ",", "bParallelogicCenter", 
      ",", "bTangentialTriangle2", ",", "bPedalGeneral", ",", "bReflectionLL",
       ",", "bSideReflectionTriangle", ",", "polarCurve", ",", "bPAntipedal", 
      ",", "mixedPolarLine", ",", "bCrossCevianTriangle", ",", 
      "bExsimilicenter3", ",", "bCevianTriangleGeneral", ",", "sym", ",", 
      "sym2", ",", "sym3", ",", "bCubicPolar", ",", "bTripoleEqGeneral", ",", 
      "bInfinityPoint", ",", "bAngle", ",", "bPsiInvolution", ",", 
      "prmCircumcircle", ",", "bBicevianPerspector", ",", "bHT", ",", "bKT", 
      ",", "bNinePointConic", ",", "bOrionTransform", ",", "bAntipedal", ",", 
      "bBicevianChordal", ",", "bKirikamiEuler", ",", "bAnticevianConic", ",",
       "bAntiparallels", ",", "bIntersectionTriangle", ",", 
      "bIsOrthologicSimplify", ",", "bOrthopoleGen", ",", 
      "bOrthopoleGenSimplify", ",", "bCrosspointGeneral", ",", 
      "bAnticevianGeneral", ",", "sCollect", ",", "bIsogonalConjugateGeneral",
       ",", "bUnaryCofactorTrg", ",", "bAntisymmetricTrg", ",", "triangle", 
      ",", "com", ",", "bCentroid", ",", "bAubertLineNew", ",", 
      "bCrossTriangle", ",", "bCrossPedalTriangle", ",", 
      "bCrossSideReflectionTriangle", ",", "bCrossReflectionTriangle", ",", 
      "bOrthoidalTriangle", ",", "bParaidalTriangle", ",", "lambda", ",", 
      "psi", ",", "bPTCTriangle", ",", "drawTriangles", ",", 
      "bIsHomothetic"}], "}"}]}], "]"}], ";"}]], "Input",
 CellLabel->
  "In[786]:=",ExpressionUUID->"b5089856-9927-46b1-8f0f-a5898cfb660f"]
},
WindowSize->{1105.2, 604.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f4e5fd37-ecfc-4dc9-8098-0c86c94e0828"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 266, 6, 26, "Input",ExpressionUUID->"e6b836b5-3811-402b-b866-4f010ca099ea"],
Cell[827, 28, 9752, 276, 495, "Input",ExpressionUUID->"efcfc13b-a8c9-4f94-87b7-425bc402d1da"],
Cell[10582, 306, 4842, 133, 301, "Input",ExpressionUUID->"41f7ea9b-4f97-4b3e-8acc-653e780288c2"],
Cell[15427, 441, 11716, 350, 824, "Input",ExpressionUUID->"c9896926-9e62-48e1-be02-b966460bf823"],
Cell[27146, 793, 22725, 658, 1136, "Input",ExpressionUUID->"45dd24a4-88e8-4d54-9e84-f9aa0bf4232c"],
Cell[49874, 1453, 25758, 644, 1450, "Input",ExpressionUUID->"12911951-98bf-4dbb-87c5-3b1bbfdddeaf"],
Cell[75635, 2099, 34561, 1017, 1608, "Input",ExpressionUUID->"a42a917b-d9c5-4a4a-9de2-720df6996073"],
Cell[110199, 3118, 101591, 2974, 4155, "Input",ExpressionUUID->"c8e3f601-a511-415e-a197-a6b942ea57db"],
Cell[211793, 6094, 18099, 488, 1823, "Input",ExpressionUUID->"7db9c1d5-51bd-4160-b9f5-e08877f6539e"],
Cell[229895, 6584, 10467, 283, 643, "Input",ExpressionUUID->"7b75e626-99ae-4d70-9a85-249c52780e5a"],
Cell[240365, 6869, 2957, 85, 129, "Input",ExpressionUUID->"99de6d6b-676e-475c-a9af-2ce02421e251"],
Cell[243325, 6956, 41656, 1142, 2967, "Input",ExpressionUUID->"e86d7a40-128f-4f2b-87f8-bf1d22559338"],
Cell[284984, 8100, 14408, 384, 335, "Input",ExpressionUUID->"3540bb30-f8f0-46db-b504-7b6bf8570298"],
Cell[299395, 8486, 36858, 940, 1443, "Input",ExpressionUUID->"ab7891ab-2c51-4a5c-ac53-2f1fcf968492"],
Cell[336256, 9428, 5657, 157, 286, "Input",ExpressionUUID->"854ee259-2162-45a0-a7f4-91d6c40b8ef6"],
Cell[341916, 9587, 61069, 1659, 1832, "Input",ExpressionUUID->"e747c5f3-bec1-4d52-bcdb-370e27b77f8e"],
Cell[402988, 11248, 1894, 52, 178, "Input",ExpressionUUID->"52833883-5115-433b-b514-862dceb9bd4b"],
Cell[404885, 11302, 5624, 161, 315, "Input",ExpressionUUID->"eeb36738-51f6-4da0-901e-74933ce00d21"],
Cell[410512, 11465, 22312, 516, 620, "Input",ExpressionUUID->"15b3e8a6-e87b-4c02-9f2a-fdd61d710068"],
Cell[432827, 11983, 38149, 1050, 2606, "Input",ExpressionUUID->"9d0490c3-9066-42d3-b57f-2a0b5cb8f081"],
Cell[470979, 13035, 914, 16, 135, "Text",ExpressionUUID->"6e66dcea-2aab-4466-b7fd-b2bf50085aa5"],
Cell[471896, 13053, 1577, 41, 126, "Input",ExpressionUUID->"5e3a0070-45b2-4da6-89ca-8971b91f8326"],
Cell[473476, 13096, 849, 14, 114, "Text",ExpressionUUID->"999e3e63-81f2-4654-ae8f-54a6dd1911ea"],
Cell[474328, 13112, 1573, 41, 126, "Input",ExpressionUUID->"21b370b3-fd0e-41ea-bcf0-9db8f3ff2192"],
Cell[475904, 13155, 11375, 229, 267, "Input",ExpressionUUID->"c9d217b9-be95-4c44-91cb-857eb2c0de9b"],
Cell[487282, 13386, 10686, 249, 384, "Input",ExpressionUUID->"759b48cb-720c-4422-8492-7ed91074661d"],
Cell[497971, 13637, 584, 18, 44, "Input",ExpressionUUID->"9225f018-c9d8-468b-845e-c4d1342582f6"],
Cell[498558, 13657, 956, 27, 92, "Input",ExpressionUUID->"9299d69f-5036-47e3-97c3-4d69a4088665"],
Cell[499517, 13686, 6028, 152, 367, "Input",ExpressionUUID->"eb2b4d3b-1ccf-4cc1-a20d-5e114c86abaf"],
Cell[505548, 13840, 7122, 104, 559, "Input",ExpressionUUID->"b5089856-9927-46b1-8f0f-a5898cfb660f"]
}
]
*)

