(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16956,        411]
NotebookOptionsPosition[     16312,        394]
NotebookOutlinePosition[     16716,        410]
CellTagsIndexPosition[     16673,        407]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.858229176389264*^9, 3.858229446693867*^9, 3.8602953602247972`*^9, 
   3.860302009654538*^9, {3.860485791732256*^9, 3.860485794873648*^9}, {
   3.860485932054061*^9, 3.860485933925563*^9}, {3.875666590817411*^9, 
   3.8756665934403267`*^9}, {3.8756666396111803`*^9, 3.875666670228642*^9}, {
   3.87568396954793*^9, 3.875683973023356*^9}, {3.8813860258068233`*^9, 
   3.881386036758132*^9}},
 CellLabel->
  "In[536]:=",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"evaluate", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "qsp", ",", " ", "qsa", ",", " ", "qsb", ",", " ", "qsc", ",", " ", 
       "qS", ",", "qr", ",", " ", "qSA", ",", " ", "qSB", ",", " ", "qSC", 
       ",", " ", "qSW", ",", " ", "qR", ",", " ", "qjJ", ",", "qangleA", ",", 
       " ", "qangleB", ",", " ", "qangleC", ",", "qangleW"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "sp", ",", " ", "sa", ",", " ", "sb", ",", " ", "sc", ",", " ", "S", 
        ",", "r", ",", " ", "SA", ",", " ", "SB", ",", " ", "SC", ",", " ", 
        "SW", ",", " ", "R", ",", " ", "jJ", ",", "angleA", ",", " ", 
        "angleB", ",", " ", "angleC", ",", "angleW", ",", "\[Omega]", ",", 
        "e", ",", "\[Tau]", ",", "jJ", ",", "J", ",", "dD", ",", 
        "\[CapitalDelta]"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"qsp", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qsa", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"b", "+", "c", "-", "a"}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qsb", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "-", "b", "+", "c"}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"qsc", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b", "-", "c"}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qS", "=", 
       RowBox[{"2", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"qsp", " ", "qsa", " ", "qsb", " ", "qsc"}], "]"}]}]}], ";", 
      RowBox[{"qr", "=", 
       RowBox[{"S", "/", 
        RowBox[{"(", 
         RowBox[{"2", "qsp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qSA", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"], "-", 
          SuperscriptBox["a", "2"]}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qSB", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "-", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", 
      RowBox[{"qSC", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "-", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", " ", 
      RowBox[{"qSW", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["a", "2"], "+", 
          SuperscriptBox["b", "2"], "+", 
          SuperscriptBox["c", "2"]}], ")"}], "/", "2"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"qR", " ", "=", " ", 
       RowBox[{"a", " ", "b", " ", 
        RowBox[{"c", "/", 
         RowBox[{"(", 
          RowBox[{"2", "qS"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qangleA", "=", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSA", 
         RowBox[{"b", " ", "c"}]], "]"}]}], ";", 
      RowBox[{"qangleB", " ", "=", " ", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSB", 
         RowBox[{"a", " ", "c"}]], "]"}]}], ";", 
      RowBox[{"qangleC", " ", "=", 
       RowBox[{"ArcCos", "[", 
        FractionBox["qSC", 
         RowBox[{"a", " ", "b"}]], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"qangleW", " ", "=", 
       RowBox[{"ArcCot", "[", 
        RowBox[{
         RowBox[{"Cot", "[", "qangleA", "]"}], "+", 
         RowBox[{"Cot", "[", "qangleB", "]"}], "+", 
         RowBox[{"Cot", "[", "qangleC", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"e", " ", "=", " ", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "-", 
           RowBox[{"4", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"2", "\[Omega]"}], "]"}]}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"qjJ", "=", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"a", " ", "b", " ", "c"}]], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a", "6"], "+", 
          SuperscriptBox["b", "6"], "+", 
          SuperscriptBox["c", "6"], "-", 
          RowBox[{
           SuperscriptBox["a", "4"], 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox["b", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "4"], 
           SuperscriptBox["c", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["a", "2"], 
           SuperscriptBox["c", "4"]}], "-", 
          RowBox[{
           SuperscriptBox["c", "4"], 
           SuperscriptBox["b", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["c", "2"], 
           SuperscriptBox["b", "4"]}], "+", 
          RowBox[{"3", 
           SuperscriptBox["a", "2"], 
           SuperscriptBox["b", "2"], 
           SuperscriptBox["c", "2"]}]}]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"expr", "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sp", "->", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", "2"}]}], ",", " ", 
          RowBox[{"sa", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"b", "+", "c", "-", "a"}], ")"}], "/", "2"}]}], ",", " ", 
          RowBox[{"sb", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "-", "b", "+", "c"}], ")"}], "/", "2"}]}], ",", 
          RowBox[{"sc", " ", "->", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "-", "c"}], ")"}], "/", "2"}]}], ",", 
          RowBox[{"s", "->", "qsp"}], ",", "\[IndentingNewLine]", 
          RowBox[{"S", "->", "qS"}], ",", 
          RowBox[{"r", "->", 
           RowBox[{"qS", "/", 
            RowBox[{"(", 
             RowBox[{"2", "qsp"}], ")"}]}]}], ",", 
          RowBox[{"\[CapitalDelta]", "->", 
           RowBox[{"qS", "/", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"SA", " ", "->", " ", "qSA"}], ",", " ", 
          RowBox[{"SB", " ", "->", " ", "qSB"}], ",", 
          RowBox[{"SC", " ", "->", " ", "qSC"}], ",", " ", 
          RowBox[{"SW", "->", "qSW"}], ",", "\[IndentingNewLine]", 
          RowBox[{"R", " ", "->", " ", "qR"}], ",", "\[IndentingNewLine]", 
          RowBox[{"angleA", "->", " ", "qangleA"}], ",", 
          RowBox[{"angleB", " ", "->", " ", "qangleB"}], ",", 
          RowBox[{"angleC", " ", "->", " ", "qangleC"}], ",", 
          RowBox[{"angleW", " ", "->", "qangleW"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "->", " ", "qangleA"}], ",", 
          RowBox[{"B", " ", "->", " ", "qangleB"}], ",", 
          RowBox[{"C", " ", "->", " ", "qangleC"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Omega]", " ", "->", " ", "qangleW"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"e", "->", 
           SqrtBox[
            FractionBox[
             RowBox[{" ", 
              RowBox[{
               SuperscriptBox["a", "4"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["b", "2"]}], "+", 
               SuperscriptBox["b", "4"], "-", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["c", "2"]}], "-", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["c", "2"]}], "+", 
               SuperscriptBox["c", "4"]}]}], 
             RowBox[{" ", 
              RowBox[{
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["b", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["a", "2"], " ", 
                SuperscriptBox["c", "2"]}], "+", 
               RowBox[{
                SuperscriptBox["b", "2"], " ", 
                SuperscriptBox["c", "2"]}]}]}]]]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Tau]", "->", 
           SqrtBox[
            RowBox[{
             FractionBox["1", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               SqrtBox["5"]}], ")"}]}]]}], ",", "\[IndentingNewLine]", 
          RowBox[{"jJ", "->", "qjJ"}], ",", 
          RowBox[{"J", "->", "qjJ"}], ",", "\[IndentingNewLine]", 
          RowBox[{"dD", "->", 
           RowBox[{"4", "*", "qS", "*", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"qR", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", "*", "qR"}], "+", "qr"}], ")"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8761073786459975`*^9, 3.8761074172277985`*^9}, {
   3.876118740193068*^9, 3.876118740837036*^9}, {3.8761198487799597`*^9, 
   3.8761198518376884`*^9}, 3.87611990736444*^9, {3.8761406051457977`*^9, 
   3.8761406068927803`*^9}, {3.8761408841974416`*^9, 3.876140885490556*^9}, {
   3.881385816139479*^9, 3.8813858493921165`*^9}, {3.8813859415933285`*^9, 
   3.8813861796626883`*^9}, {3.8813862114949636`*^9, 
   3.8813865827267523`*^9}, {3.881386615690344*^9, 3.881386616007358*^9}, {
   3.881386658030673*^9, 3.8813867248161345`*^9}, {3.88181250458523*^9, 
   3.88181251630267*^9}},ExpressionUUID->"6e78eba6-01f6-40c6-b3e8-\
5afba25a3220"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"symmetrizeEq", "[", "eq_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"partB", ",", " ", "partC"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Cyclic", " ", "sum", " ", "for", " ", "bernard"}], "-", 
       RowBox[{"gibert", ".", "pagesperso"}], "-", 
       RowBox[{"orange", ".", "fr"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"partB", " ", "=", " ", 
       RowBox[{"eq", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", " ", 
          RowBox[{"b", "->", "c"}], ",", " ", 
          RowBox[{"c", "->", "a"}], ",", " ", 
          RowBox[{"x", "->", "y"}], ",", " ", 
          RowBox[{"y", "->", "z"}], ",", " ", 
          RowBox[{"z", "->", "x"}], ",", " ", 
          RowBox[{"pp", "->", "qq"}], ",", " ", 
          RowBox[{"qq", "->", "rr"}], ",", " ", 
          RowBox[{"rr", "->", "pp"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"p", "->", "q"}], ",", 
          RowBox[{"q", "->", "r"}], ",", 
          RowBox[{"r", "->", "p"}], ",", 
          RowBox[{"u", "->", "v"}], ",", 
          RowBox[{"v", "->", "w"}], ",", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"partC", " ", "=", " ", 
       RowBox[{"partB", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "->", "b"}], ",", " ", 
          RowBox[{"b", "->", "c"}], ",", " ", 
          RowBox[{"c", "->", "a"}], ",", " ", 
          RowBox[{"x", "->", "y"}], ",", " ", 
          RowBox[{"y", "->", "z"}], ",", " ", 
          RowBox[{"z", "->", "x"}], ",", " ", 
          RowBox[{"pp", "->", "qq"}], ",", " ", 
          RowBox[{"qq", "->", "rr"}], ",", " ", 
          RowBox[{"rr", "->", "pp"}], ",", 
          RowBox[{"A", "->", "B"}], ",", 
          RowBox[{"B", "->", "C"}], ",", 
          RowBox[{"C", "->", "A"}], ",", 
          RowBox[{"SA", "->", "SB"}], ",", 
          RowBox[{"SB", "->", "SC"}], ",", 
          RowBox[{"SC", "->", "SA"}], ",", 
          RowBox[{"p", "->", "q"}], ",", 
          RowBox[{"q", "->", "r"}], ",", 
          RowBox[{"r", "->", "p"}], ",", 
          RowBox[{"u", "->", "v"}], ",", 
          RowBox[{"v", "->", "w"}], ",", 
          RowBox[{"w", "->", "u"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{"eq", "+", "partB", "+", "partC"}], ")"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"conwaySimplify", "[", "poly_", "]"}], ":=", 
   RowBox[{"PolynomialReduce", "[", 
    RowBox[{"poly", ",", 
     RowBox[{"evaluate", "[", 
      RowBox[{"{", 
       RowBox[{
       "SW", ",", "SA", ",", "SB", ",", "SC", ",", "sp", ",", "sa", ",", "sb",
         ",", "sc"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84205539309252*^9, 3.8420554216421833`*^9}, {
   3.842055530366268*^9, 3.8420555972276335`*^9}, {3.842055649256649*^9, 
   3.8420557017017207`*^9}, {3.8420559798411775`*^9, 
   3.8420559882557697`*^9}, {3.8420560267317495`*^9, 3.8420561054123874`*^9}, 
   3.842844687719762*^9, {3.8659280435815973`*^9, 3.865928066957941*^9}, {
   3.875666619834482*^9, 3.8756666291084013`*^9}, {3.8813860260657673`*^9, 
   3.8813860370251884`*^9}, {3.881668299633577*^9, 3.8816683062494116`*^9}, {
   3.8818123912682056`*^9, 3.8818124050842915`*^9}, {3.8818126909488945`*^9, 
   3.881812704307745*^9}, {3.881813685191516*^9, 3.881813695529873*^9}, {
   3.8818173249237695`*^9, 
   3.881817334302041*^9}},ExpressionUUID->"4c3e296e-741c-4616-a2af-\
bb5ca6c06ef1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<TriangleExpressions.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<TriangleExpressions.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "sp", ",", " ", "sa", ",", " ", "sb", ",", " ", "sc", ",", " ", "S", ",",
       "s", ",", " ", "e", ",", " ", "\[Omega]", ",", " ", "\[Tau]", ",", " ",
       "r", ",", " ", "\[CapitalDelta]", ",", " ", "SA", ",", " ", "SB", ",", 
      " ", "SC", ",", " ", "SW", ",", " ", "R", ",", " ", "J", ",", "jJ", ",",
       "dD", ",", "angleA", ",", " ", "angleB", ",", " ", "angleC", ",", 
      "angleW", ",", "symmetrizeEq", ",", " ", "conwaySimplify", ",", 
      "evaluate"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.858229161298311*^9, 3.8582291632430873`*^9}, {
   3.8609892584103584`*^9, 3.860989258842313*^9}, {3.8756666012304845`*^9, 
   3.87566662322633*^9}, {3.8761074194386287`*^9, 3.87610742564142*^9}, {
   3.876118745189362*^9, 3.876118745306044*^9}, {3.8761198581936073`*^9, 
   3.8761198583997173`*^9}, 3.8761199096105285`*^9, {3.8761408907389917`*^9, 
   3.876140891806229*^9}, {3.8761409935685005`*^9, 3.8761409953146715`*^9}, {
   3.8813860260776787`*^9, 3.881386037028248*^9}, {3.8813867538350677`*^9, 
   3.881386753959855*^9}},
 CellLabel->
  "In[540]:=",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
},
WindowSize->{1093.8, 604.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"aca5b677-55b6-4267-a176-e3559e484e60"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 680, 13, 28, "Input",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],
Cell[1241, 35, 9725, 240, 605, "Input",ExpressionUUID->"6e78eba6-01f6-40c6-b3e8-5afba25a3220"],
Cell[10969, 277, 3988, 90, 181, "Input",ExpressionUUID->"4c3e296e-741c-4616-a2af-bb5ca6c06ef1"],
Cell[14960, 369, 1348, 23, 67, "Input",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
}
]
*)

