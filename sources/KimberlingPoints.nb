(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84032,       2046]
NotebookOptionsPosition[     82846,       2020]
NotebookOutlinePosition[     83379,       2040]
CellTagsIndexPosition[     83336,       2037]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8399130150855227`*^9, 3.8399130150855227`*^9}, 
   3.839919710866042*^9, 3.8399199407660537`*^9, {3.8399201289222293`*^9, 
   3.839920152741045*^9}, {3.8399205883358803`*^9, 3.839920595085084*^9}, {
   3.83992070302919*^9, 3.8399207092031746`*^9}, {3.8416249776934814`*^9, 
   3.8416249791378546`*^9}, 3.841627116456952*^9, {3.8418034050176563`*^9, 
   3.841803420274452*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"defined", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<ValueQ[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Head", "@", 
       RowBox[{"ToExpression", "[", "s", "]"}]}], "=!=", "Symbol"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<Attributes[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<DownValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<SubValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getvalue", "[", 
     RowBox[{"ass_", ",", "key_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"ass", ",", "key"}], "]"}], ",", 
      RowBox[{"ass", "[", "key", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "Indeterminate", ",", " ", "Indeterminate", ",", " ", 
        "Indeterminate"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenter", "[", 
     RowBox[{"k_", ",", "XPA_", ",", "XPB_", ",", "XPC_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bary", ",", "rpl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rpl", "=", "\[VeryThinSpace]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "\[Rule]", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPB", ",", "XPC"}], "]"}]}], ",", 
          RowBox[{"b", "\[Rule]", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPC"}], "]"}]}], ",", 
          RowBox[{"c", "\[Rule]", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"XPA", ",", "XPB"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bary", "=", 
        RowBox[{
         RowBox[{"KimberlingCenterCN", "[", "k", "]"}], "/.", "rpl"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox["bary", 
         RowBox[{"Total", "[", "bary", "]"}]], ".", 
        RowBox[{"{", 
         RowBox[{"XPA", ",", "XPB", ",", "XPC"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KimberlingCenterC", "[", "k_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ptname", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NumericQ", "[", "k", "]"}], ",", 
         RowBox[{"ptname", "=", 
          RowBox[{"\"\<X\>\"", "<>", 
           RowBox[{"ToString", "[", "k", "]"}]}]}], ",", 
         RowBox[{"ptname", "=", "k"}]}], "]"}], ";", "\n", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"symmetrizeInternal", "[", 
          RowBox[{"ETCFull", "[", "ptname", "]"}], "]"}], "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"A", "->", "angleA"}], ",", 
            RowBox[{"B", "->", "angleB"}], ",", 
            RowBox[{"C", "->", "angleC"}]}], "}"}], "]"}]}], "]"}], ";"}]}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"X", "[", "k_", "]"}], ":=", 
    RowBox[{"evaluate", "[", 
     RowBox[{
      RowBox[{"symmetrizeInternal", "[", 
       RowBox[{"ETCFull", "[", 
        RowBox[{"\"\<X\>\"", "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "]"}], "/.", 
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"A", "->", "angleA"}], ",", 
         RowBox[{"B", "->", "angleB"}], ",", 
         RowBox[{"C", "->", "angleC"}]}], "}"}], "]"}]}], "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTriangleCurve", "[", 
     RowBox[{"name_", ",", 
      RowBox[{"in_", ":", "TriangleCurves"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "tmp", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Keys", "[", "in", "]"}], ",", 
          RowBox[{
           RowBox[{"StringContainsQ", "[", 
            RowBox[{
             RowBox[{"ToLowerCase", "[", "#", "]"}], ",", 
             RowBox[{"ToLowerCase", "[", "name", "]"}]}], "]"}], "&"}]}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", "tmp", "]"}], ";", "\n", "\t", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{"in", "[", 
          RowBox[{"tmp", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "evaluate"}], "]"}], 
       ";"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenterCN", "=", "X"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"XNy", "[", "k_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "k2", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "k", "]"}], ",", 
       RowBox[{"k2", "=", 
        RowBox[{"\"\<X\>\"", "<>", 
         RowBox[{"ToString", "[", "k", "]"}]}]}], ",", 
       RowBox[{"k2", "=", "k"}]}], "]"}], ";", "\n", 
     FractionBox[
      RowBox[{"KimberlingCenterCNy", "[", "k2", "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{"KimberlingCenterCNy", "[", "k2", "]"}], "]"}]]}]}], "\n", 
   "]"}]}]}], "Code",
 InitializationCell->False,
 CellLabel->"In[44]:=",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ruleAbsSquare", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "[", "x___", "]"}], "^", "2"}], " ", ":>", " ", 
      RowBox[{"x", "^", "2"}]}], "}"}]}], ";"}], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Can", " ", "also", " ", "be", " ", "just", " ", "Abs"}], "->", 
    "RealAbs"}], " ", "*)"}]}]], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rule69", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9", ",", "13"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8659359365025496`*^9, 3.8659359467166414`*^9}, {
  3.877578389921321*^9, 3.877578397215644*^9}, {3.8779284662523875`*^9, 
  3.877928467254416*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rulesSimplify", "=", " ", 
   RowBox[{
    RowBox[{"a", ">", "0"}], "&&", 
    RowBox[{"b", ">", "0"}], "&&", 
    RowBox[{"c", ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"a", "+", "b"}], ">", "c"}], "&&", 
    RowBox[{
     RowBox[{"a", "+", "c"}], ">", "b"}], "&&", 
    RowBox[{
     RowBox[{"b", "+", "c"}], ">", "a"}], "&&", 
    RowBox[{"S", ">", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinReplace", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "A", "]"}], "\[Rule]", 
      FractionBox["S", 
       RowBox[{"b", " ", "c"}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "B", "]"}], "\[Rule]", 
      FractionBox["S", 
       RowBox[{"a", " ", "c"}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "C", "]"}], "\[Rule]", 
      FractionBox["S", 
       RowBox[{"a", " ", "b"}]]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "A", "]"}], "->", 
      RowBox[{"evaluate", "[", 
       RowBox[{"Cos", "[", "A", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "B", "]"}], "->", 
      RowBox[{"evaluate", "[", 
       RowBox[{"Cos", "[", "B", "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "C", "]"}], "->", 
      RowBox[{"evaluate", "[", 
       RowBox[{"Cos", "[", "C", "]"}], "]"}]}]}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[54]:=",ExpressionUUID->"8adc4980-6855-491e-857a-2e383c343b5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkCurvesSymb", "[", "pt_", "]"}], ":=", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"curve", "=", 
       RowBox[{"getTriangleCurve", "[", "name", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"curve", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], "]"}]}],
           "]"}], "==", "0"}], ",", 
        RowBox[{"Print", "[", "name", "]"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"name", ",", 
       RowBox[{"Keys", "[", "TriangleCurves", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkPointsOnCurve", "[", "crv_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"curve", ",", " ", "curve2", ",", " ", "out", ",", "normcoef"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curve", "=", 
       RowBox[{
        RowBox[{"evaluate", "[", "crv", "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"curve2", "=", 
       RowBox[{"curve", "/.", "rule69"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"normcoef", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"CoefficientList", "[", 
           RowBox[{"curve2", ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "//", "Abs"}],
          "//", "Flatten"}], "//", "Max"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"normalize", " ", "big", " ", "numbers"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
             FractionBox["curve2", "normcoef"], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], 
              "]"}]}], "]"}], "&"}], "/@", "ETCBaryNorm"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "12"}]]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "one", " ", "more", " ", 
        RowBox[{"rule", ".", " ", "The"}], " ", "strange", " ", 
        RowBox[{"Simplify", "[", "]"}], " ", "is", " ", "needed", " ", "to", 
        " ", "avoid", " ", "precision", " ", "errors", " ", "in", " ", "edge",
         " ", 
        RowBox[{"cases", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ni", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"curve", "/.", 
                  RowBox[{"Thread", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
                    RowBox[{"(", 
                    RowBox[{"KimberlingCenterCNy", "[", "ni", "]"}], ")"}]}], 
                   "]"}]}], "/.", 
                 RowBox[{"intCheckList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}], ",", 
               "20"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ni", ",", 
             RowBox[{"Keys", "[", "test", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"out", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "<>", 
          "\"\<(\>\"", "<>", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}], 
         "&"}], ",", "out"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkPointsOnCurveNamed", "[", "crvname_", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "srch", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"srch", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"TriangleCurves", "//", "Keys"}], ",", 
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "crvname"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "srch", "]"}], ">", "1"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Which curve?\>\"", "]"}], ";", 
         RowBox[{"Print", "[", "srch", "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "srch", "]"}], "==", "0"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<No such curve\>\"", "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "srch", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"checkPointsOnCurve", "[", 
        RowBox[{"TriangleCurves", "[", 
         RowBox[{"First", "[", "srch", "]"}], "]"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPointOnCurveNum", "[", 
     RowBox[{"crv_", ",", "pt_", ",", 
      RowBox[{"rules_", ":", "intCheckList"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"curve2", ",", "normcoef", ",", "test"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"curve2", "=", 
           RowBox[{"crv", "/.", "\[VeryThinSpace]", "r"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"normcoef", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"CoefficientList", "[", 
               RowBox[{"curve2", ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], 
             "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"test", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{
             FractionBox["curve2", "normcoef"], "/.", "\[VeryThinSpace]", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
               RowBox[{"N", "[", 
                RowBox[{
                 RowBox[{"pt", "/.", "r"}], ",", "35"}], "]"}]}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"test", ">", 
             FractionBox["1", 
              SuperscriptBox["10", "15"]]}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "rules"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkTrianglesOnCurve", "[", 
     RowBox[{"crv_", ",", 
      RowBox[{"trsets_", ":", 
       RowBox[{"{", 
        RowBox[{"\"\<CPTR\>\"", ",", "\"\<ENCTR\>\"", ",", "\"\<UNI\>\""}], 
        "}"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ecrv", ",", "out", ",", "trgsets"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"trgsets", "=", 
        RowBox[{"{", "KimberlingTrianglesBary", "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"trsets", ",", "\"\<CPTR\>\""}], "]"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trgsets", ",", 
           RowBox[{"AssociationMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"CPTR", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Keys", "[", "CPTR", "]"}]}], "]"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"trsets", ",", "\"\<ENCTR\>\""}], "]"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trgsets", ",", 
           RowBox[{"AssociationMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ENCTR", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Keys", "[", "ENCTR", "]"}]}], "]"}]}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"trsets", ",", "\"\<UNI\>\""}], "]"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"trgsets", ",", 
           RowBox[{"AssociationMap", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"UNCFTRG", "[", "#", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", 
             RowBox[{"Keys", "[", "UNCFTRG", "]"}]}], "]"}]}], "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"ecrv", "=", 
        RowBox[{
         RowBox[{"evaluate", "[", "crv", "]"}], "/.", "\[VeryThinSpace]", 
         "rule69"}]}], ";", 
       RowBox[{"out", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ecrv", "/.", "\[VeryThinSpace]", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"set", "[", "name", "]"}], "/.", 
                    "\[VeryThinSpace]", "rule69"}], ")"}]}], "]"}]}], ")"}], 
               "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"out", ",", "name"}], "]"}], ";"}]}], "]"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"name", ",", 
              RowBox[{"Keys", "[", "set", "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"set", ",", "trgsets"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intCurvesForTriangle", "[", 
     RowBox[{"tr_", ",", "checktr_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ecrv", ",", " ", "out"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ecrv", "=", 
           RowBox[{
            RowBox[{"evaluate", "[", 
             RowBox[{"TriangleCurves", "[", "name", "]"}], "]"}], "/.", 
            "checktr"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ecrv", "/.", "\[VeryThinSpace]", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"evaluate", "[", 
                    RowBox[{"tr", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", 
                   "\[VeryThinSpace]", "checktr"}], ")"}]}], "]"}]}], ")"}], 
             "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"out", ",", "name"}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "TriangleCurves", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkCurvesForTriangle", "[", "tr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ecrv", ",", " ", "out"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", "=", 
        RowBox[{"intCurvesForTriangle", "[", 
         RowBox[{"tr", ",", "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{"out", ",", " ", 
             RowBox[{"intCurvesForTriangle", "[", 
              RowBox[{"tr", ",", 
               RowBox[{"intCheckList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", " ", 
             RowBox[{"intCurvesForTriangle", "[", 
              RowBox[{"tr", ",", 
               RowBox[{"intCheckList", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkTriangleExists", "[", "tr_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"treval", ",", "result"}], "}"}], ",", 
      RowBox[{
       RowBox[{"treval", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"evaluate", "[", 
           RowBox[{"tr", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", " ", "rule69"}], "//",
          "intnumericnorm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"result", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"allPrecomputedTrJoined", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"Abs", "[", 
              RowBox[{"Cross", "[", 
               RowBox[{"treval", ",", "#"}], "]"}], "]"}], "]"}], "<", 
            RowBox[{"10", "^", 
             RowBox[{"-", "24"}]}]}], "&"}], ",", "1"}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "Stop", " ", "after", " ", "finding", " ", "the", " ", "first", " ",
            "match"}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AssociationQ", "[", "result", "]"}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", "result", "]"}], ">", "0"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"True", ",", 
           RowBox[{"First", "@", 
            RowBox[{"Keys", "[", "result", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", "False", "}"}]}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trgCheckPerspectivity", "[", 
     RowBox[{"trchk_", ",", 
      RowBox[{"trgname_", ":", "\"\<TR\>\""}], ",", 
      RowBox[{"set_", ":", "KimberlingTrianglesBary"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cnt", ",", "trchke", ",", "trsyme", ",", "hmt", ",", "out", ",", 
        "trsym", ",", "ntest", ",", "ptcoord", ",", "perschk", ",", "homval", 
        ",", "outname", ",", "ishomo", ",", "homval2", ",", "simtest", ",", 
        " ", "homtest"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cnt", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "trgname", "]"}], "!=", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Invalid TRG Name\>\"", "]"}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"trchke", "=", 
        RowBox[{
         RowBox[{"evaluate", "[", "trchk", "]"}], "/.", "rule69"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ishomo", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"trsym", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", 
              RowBox[{
               RowBox[{"set", "[", "trname", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"set", "[", "trname", "]"}], ",", 
             RowBox[{"triangle", "[", "trname", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"trsyme", "=", 
           RowBox[{
            RowBox[{"evaluate", "[", "trsym", "]"}], "/.", "rule69"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ntest", "=", 
           RowBox[{"bIsPerspective", "@@", 
            RowBox[{"Join", "[", 
             RowBox[{"trsyme", ",", "trchke"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"simtest", " ", "=", " ", 
           RowBox[{"bIsSimilarNumeric", "[", 
            RowBox[{"trchke", ",", "trsyme"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"homtest", "=", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"bIsHomothetic", "[", 
               RowBox[{"trchke", ",", "trsyme"}], "]"}], "/.", " ", 
              "rule69"}], "]"}], "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "20"}]]}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "ntest", "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "20"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"cnt", "=", 
              RowBox[{"cnt", "+", "1"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"ptcoord", "=", 
              RowBox[{"bTrianglePerspector", "[", 
               RowBox[{
                RowBox[{"trchk", "//", "evaluate"}], ",", 
                RowBox[{"trsym", "//", "evaluate"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"perschk", "=", 
              RowBox[{"ptcoord", "//", "checkPointinETC2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"outname", " ", "=", " ", 
              RowBox[{
              "\"\<Perspector of \>\"", "<>", "trgname", "<>", 
               "\"\< and \>\"", "<>", "trname"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"hmt", "=", "\"\<\>\""}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"simtest", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{"homtest", ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trname", "==", "\"\<ABC\>\""}], ",", 
                    RowBox[{"ishomo", "=", "True"}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"hmt", "=", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< - possibly homothetic\>\"", ",", "Red"}], 
                    "]"}]}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"hmt", "=", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< - possibly similar\>\"", ",", "Green"}], 
                    "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], "&&", 
                   RowBox[{"Or", "[", 
                    RowBox[{
                    RowBox[{"trname", "==", "\"\<ABC\>\""}], ",", 
                    RowBox[{"Not", "[", "ishomo", "]"}]}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"outname", "<>", "\"\<: \>\"", "<>", 
                    RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "hmt"}], "}"}], 
                    "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"out", ",", 
                  RowBox[{"outname", "->", 
                   RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"outname", ",", "hmt"}], "}"}], "]"}], "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Similarity", " ", "is", " ", "reported", " ", "for", " ", "ALL",
               " ", "triangles"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"simtest", "&&", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"KimberlingTrianglesBaryOrthKeys", ",", "trname"}], 
                 "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "trgname", "<>", "\"\< and \>\"", "<>", "trname"}], ",", 
                    RowBox[{"Style", "[", 
                    RowBox[{"\"\< - possibly similar\>\"", ",", "Green"}], 
                    "]"}]}], "}"}], "]"}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"trname", ",", 
           RowBox[{
            RowBox[{"Keys", "[", "set", "]"}], "/.", 
            RowBox[{"\"\<infinite-altitude\>\"", "->", "Nothing"}]}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"intaddbrackets", "[", "#1", "]"}], "->", "#2"}], "]"}], 
          "&"}], ",", 
         RowBox[{"GroupBy", "[", 
          RowBox[{"out", ",", "Identity", ",", "Keys"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "cnt", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trgCheckOrthologic", "[", 
     RowBox[{"trchk_", ",", 
      RowBox[{"trgname_", ":", "\"\<TR\>\""}], ",", 
      RowBox[{"set_", ":", "KimberlingTrianglesBary"}], ",", " ", 
      RowBox[{"exclset_", ":", 
       RowBox[{"{", "}"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "out", ",", "out2", ",", "out3", ",", "trexcl", ",", "htest", ",", 
        "trsym", ",", "trsyme", ",", "trchke", ",", "ntest", ",", "ptcoord", 
        ",", "perschk", ",", "outname", ",", "collinear", ",", "keysset"}], 
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "trgname", "]"}], "!=", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Invalid TRG Name\>\"", "]"}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"collinear", "=", "False"}], ";", "\[IndentingNewLine]", 
       RowBox[{"trchke", "=", 
        RowBox[{
         RowBox[{"evaluate", "[", "trchk", "]"}], "/.", "rule69"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"0", "==", 
           RowBox[{"bCollinearityMatrix", "@@", "trchke"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"collinear", "=", "True"}], ";", 
          RowBox[{"Print", "[", "\"\<COLLINEAR POINTS\>\"", "]"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"out2", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"out3", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", "set", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<ABC\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"keysset", "=", "KimberlingTrianglesBaryOrthKeys"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"keysset", "=", 
           RowBox[{"Keys", "[", "set", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"trsym", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "[", 
                RowBox[{
                 RowBox[{"set", "[", "trname", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"set", "[", "trname", "]"}], ",", 
               RowBox[{"triangle", "[", "trname", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"trsyme", "=", 
             RowBox[{
              RowBox[{"evaluate", "[", "trsym", "]"}], "/.", "rule69"}]}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Or", "[", 
               RowBox[{
                RowBox[{"trname", "==", "\"\<8th Brocard\>\""}], ",", 
                RowBox[{"trname", "==", "\"\<Ehrmann-cross\>\""}], ",", 
                RowBox[{"trname", "==", "\"\<pedal of X(30)\>\""}]}], "]"}], 
              ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "exclset", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Do", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"KeyExistsQ", "[", 
                    RowBox[{"set", ",", "excl"}], "]"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"trexcl", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "[", 
                    RowBox[{
                    RowBox[{"set", "[", "excl", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"set", "[", "excl", "]"}], ",", 
                    RowBox[{"triangle", "[", "excl", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"htest", "=", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"bIsHomothetic", "[", 
                    RowBox[{"trsyme", ",", 
                    RowBox[{
                    RowBox[{"evaluate", "[", "trexcl", "]"}], "/.", 
                    "rule69"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"htest", "<", 
                    SuperscriptBox["10", 
                    RowBox[{"-", "24"}]]}], ",", 
                    RowBox[{"Goto", "[", "end", "]"}]}], "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
                ",", 
                RowBox[{"{", 
                 RowBox[{"excl", ",", "exclset"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"collinear", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "This", " ", "avoids", " ", "pedal", " ", "triangles", " ", 
                "in", " ", "CPTR", " ", "which", " ", "are", " ", 
                "degenerate"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"TrueQ", "[", 
                  RowBox[{"0", "==", 
                   RowBox[{"Simplify", "[", 
                    RowBox[{"bCollinearityMatrix", "@@", "trsyme"}], "]"}]}], 
                  "]"}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"ntest", "=", 
                RowBox[{
                 RowBox[{"bIsOrthologic", "[", 
                  RowBox[{"trchke", ",", " ", "trsyme"}], "]"}], "/.", 
                 "rule69"}]}], ";"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ntest", "=", 
                RowBox[{
                 RowBox[{"bIsOrthologic", "[", 
                  RowBox[{"trsyme", ",", " ", "trchke"}], "]"}], "/.", 
                 "rule69"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "ntest", "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "24"}]]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ptcoord", "=", 
                RowBox[{"bOrthologyCenter", "[", 
                 RowBox[{
                  RowBox[{"trchk", "//", "evaluate"}], ",", 
                  RowBox[{"trsym", "//", "evaluate"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"perschk", "=", 
                RowBox[{"ptcoord", "//", "checkPointinETC2"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"outname", " ", "=", " ", 
                RowBox[{
                "\"\<Orthology center of \>\"", "<>", "trgname", "<>", 
                 "\"\< and \>\"", "<>", "trname"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"PrintTemporary", "[", "outname", "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AssociateTo", "[", 
                   RowBox[{"out", ",", 
                    RowBox[{"outname", "->", 
                    RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"out2", ",", "trname"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Not", "[", "collinear", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ptcoord", "=", 
                   RowBox[{"bOrthologyCenter", "[", 
                    RowBox[{"trsym", ",", "trchk"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"perschk", "=", 
                   RowBox[{"ptcoord", "//", "checkPointinETC2"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"outname", " ", "=", " ", 
                   RowBox[{
                   "\"\<Orthology center of \>\"", "<>", "trname", "<>", 
                    "\"\< and \>\"", "<>", "trgname"}]}], ";", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{"outname", "->", 
                    RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out3", ",", "trname"}], "]"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Label", "[", "end", "]"}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"trname", ",", 
             RowBox[{"keysset", "/.", 
              RowBox[{"\"\<infinite-altitude\>\"", "->", "Nothing"}]}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]",
          "trname"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "out2", "]"}], ">", "0"}], ",", 
         RowBox[{"Print", "[", " ", 
          RowBox[{
          "\"\<Orthology center of \>\"", "<>", "trgname", "<>", 
           "\"\< and \>\"", "<>", 
           RowBox[{"ToString", "[", "out2", "]"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "out3", "]"}], ">", "0"}], ",", 
         RowBox[{"Print", "[", " ", 
          RowBox[{"\"\<Orthology center of \>\"", "<>", 
           RowBox[{"ToString", "[", "out3", "]"}], "<>", "\"\< and \>\"", "<>",
            "trgname"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"intaddbrackets", "[", "#1", "]"}], "->", "#2"}], "]"}], 
          "&"}], ",", 
         RowBox[{"GroupBy", "[", 
          RowBox[{"out", ",", "Identity", ",", "Keys"}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trgCheckParallelogic", "[", 
     RowBox[{"trchk_", ",", 
      RowBox[{"trgname_", ":", "\"\<TR\>\""}], ",", 
      RowBox[{"set_", ":", "KimberlingTrianglesBary"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "keysset", ",", " ", "out", ",", "trsym", ",", "ntest", ",", "ptcoord",
         ",", "perschk", ",", "outname"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "trgname", "]"}], "!=", "0"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Invalid TRG Name\>\"", "]"}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", 
          RowBox[{"0", "==", 
           RowBox[{"Simplify", "[", 
            RowBox[{
             RowBox[{"bCollinearityMatrix", "@@", 
              RowBox[{"(", 
               RowBox[{"evaluate", "/@", "trchk"}], ")"}]}], "/.", "rule69"}],
             "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<COLLINEAR POINTS\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", "Block"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Keys", "[", "set", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "\"\<ABC\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"keysset", "=", "KimberlingTrianglesBaryOrthKeys"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"keysset", "=", 
           RowBox[{"Keys", "[", "set", "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"trsym", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"ListQ", "[", 
              RowBox[{
               RowBox[{"set", "[", "trname", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"set", "[", "trname", "]"}], ",", 
             RowBox[{"triangle", "[", "trname", "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ntest", "=", 
           RowBox[{
            RowBox[{"bIsParallelogic", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"evaluate", "[", 
                RowBox[{"Join", "[", 
                 RowBox[{"trsym", ",", "trchk"}], "]"}], "]"}], "/.", 
               "rule69"}], ")"}]}], "/.", "rule69"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "ntest", "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "24"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ptcoord", "=", 
              RowBox[{"bParallelogicCenter", "[", 
               RowBox[{"trchk", ",", "trsym"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"perschk", "=", 
              RowBox[{"ptcoord", "//", "checkPointinETC2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"outname", " ", "=", " ", 
              RowBox[{
              "\"\<Parallelogic center of \>\"", "<>", "trgname", "<>", 
               "\"\< and \>\"", "<>", "trname"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"out", ",", 
                  RowBox[{"outname", "->", 
                   RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "outname", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"ptcoord", "=", 
              RowBox[{"bParallelogicCenter", "[", 
               RowBox[{
                RowBox[{"trsym", "//", "evaluate"}], ",", 
                RowBox[{"trchk", "//", "evaluate"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"perschk", "=", 
              RowBox[{"ptcoord", "//", "checkPointinETC2"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"outname", " ", "=", " ", 
              RowBox[{
              "\"\<Parallelogic center of \>\"", "<>", "trname", "<>", 
               "\"\< and \>\"", "<>", "trgname"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "perschk", "]"}], ">", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AssociateTo", "[", 
                 RowBox[{"out", ",", 
                  RowBox[{"outname", "->", 
                   RowBox[{"perschk", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Print", "[", "outname", "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"trname", ",", 
           RowBox[{"keysset", "/.", 
            RowBox[{"\"\<infinite-altitude\>\"", "->", "Nothing"}]}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{"intaddbrackets", "[", "#1", "]"}], "->", "#2"}], "]"}], 
          "&"}], ",", 
         RowBox[{"GroupBy", "[", 
          RowBox[{"out", ",", "Identity", ",", "Keys"}], "]"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"trgCheckBasepoints", "[", 
     RowBox[{"trchk_", ",", "trgname_", ",", 
      RowBox[{"set_", ":", "KimberlingTrianglesBary"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "bps", ",", "trchke", ",", "trsyme", ",", "hmt", ",", "out", ",", 
        "trsym", ",", "ntest", ",", "ptcoord", ",", "perschk", ",", "homval", 
        ",", "check"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "trgname", "]"}], "!=", "0"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", "\"\<Invalid TRG Name\>\"", "]"}], ";", 
            RowBox[{"Return", "[", 
             RowBox[{"False", ",", "Block"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"trchke", "=", 
          RowBox[{
           RowBox[{"evaluate", "[", "trchk", "]"}], "/.", "rule69"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"trsym", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"ListQ", "[", 
                RowBox[{
                 RowBox[{"set", "[", "trname", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"set", "[", "trname", "]"}], ",", 
               RowBox[{"triangle", "[", "trname", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"trsyme", "=", 
             RowBox[{
              RowBox[{"evaluate", "[", "trsym", "]"}], "/.", "rule69"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"ntest", "=", 
             RowBox[{"bIsPerspective", "@@", 
              RowBox[{"Join", "[", 
               RowBox[{"trsyme", ",", "trchke"}], "]"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", "ntest", "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "24"}]]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"homval", "=", 
                RowBox[{"Abs", "[", 
                 RowBox[{"bIsHomothetic", "[", 
                  RowBox[{"trchke", ",", "trsyme"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"homval", "<", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "20"}]]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"bps", "=", 
                RowBox[{"TimeConstrained", "[", 
                 RowBox[{
                  RowBox[{"basepoints", "[", 
                   RowBox[{
                    RowBox[{"trsym", "//", "smpl"}], ",", "trchk", ",", 
                    RowBox[{
                    RowBox[{"bTrianglePerspector", "[", 
                    RowBox[{"trsym", ",", "trchk"}], "]"}], "//", "smpl"}]}], 
                   "]"}], ",", "5", ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"bps", "==", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"bps", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"check", "=", 
                   RowBox[{"checkPointinETC2", "[", 
                    RowBox[{"bps", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1st basepoint of \>\"", "<>", "trname", "<>", 
                    "\"\< and \>\"", "<>", "trgname"}], "}"}], "->", 
                    RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<1st basepoint of \>\"", "<>", "trname", "<>", 
                    "\"\< and \>\"", "<>", "trgname"}], "}"}], "->", 
                    "\"\<NP\>\""}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<No basepoint for \>\"", "<>", "trname"}], 
                   "]"}], ";", 
                  RowBox[{"Continue", "[", "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"bps", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"check", "=", 
                   RowBox[{"checkPointinETC2", "[", 
                    RowBox[{"bps", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "check", "]"}], ">", "0"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<2nd basepoint of \>\"", "<>", "trname", "<>", 
                    "\"\< and \>\"", "<>", "trgname"}], "}"}], "->", 
                    RowBox[{"check", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"out", ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "\"\<2nd basepoint of \>\"", "<>", "trname", "<>", 
                    "\"\< and \>\"", "<>", "trgname"}], "}"}], "->", 
                    "\"\<NP\>\""}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
                  ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"trname", ",", 
             RowBox[{
              RowBox[{"Keys", "[", "set", "]"}], "/.", 
              RowBox[{"\"\<infinite-altitude\>\"", "->", "Nothing"}]}]}], 
            "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AssociationMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Print", "[", "#", "]"}], "&"}], ",", "out"}], "]"}], 
         ";"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"KeyValueMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"#1", "->", "#2"}], "]"}], "&"}], ",", 
            RowBox[{"GroupBy", "[", 
             RowBox[{"out", ",", "Identity", ",", "Keys"}], "]"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", ",", "trname"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"trgFullCheck", "[", 
    RowBox[{"trgchk_", ",", 
     RowBox[{"scope_", ":", 
      RowBox[{"{", 
       RowBox[{
       "\"\<pKIM\>\"", ",", "\"\<oKIM\>\"", ",", "\"\<plKIM\>\"", ",", 
        "\"\<pCPTR\>\"", ",", "\"\<pENCTR\>\"", ",", "\"\<oCPTR\>\"", ",", 
        "\"\<oENCTR\>\"", ",", "\"\<pUNCFTRG\>\""}], "}"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "ex", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mon", "=", "\"\<check\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"ex", "=", 
         RowBox[{"checkTriangleExists", "[", "trgchk", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"TrueQ", "[", 
           RowBox[{
            RowBox[{"ex", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "!=", "False"}], "]"}], ",", 
          RowBox[{"Print", "[", "ex", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mon", "=", "\"\<curves\>\""}], ";", "\[IndentingNewLine]", 
        RowBox[{"ex", "=", 
         RowBox[{"checkCurvesForTriangle", "[", "trgchk", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "ex", "]"}], ">", "0"}], ",", 
          RowBox[{"Print", "[", "ex", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<pKIM\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fKIM\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<pKIM\>\""}], ";", " ", 
           RowBox[{
            RowBox[{"trgCheckPerspectivity", "[", "trgchk", "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<pCPTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fCPTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<pCPTR\>\""}], ";", " ", 
           RowBox[{
            RowBox[{"trgCheckPerspectivity", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "CPTR"}], "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<pENCTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fENCTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<pENCTR\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckPerspectivity", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "ENCTR"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<pUNCFTRG\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fUNCFTRG\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<pUNCFTRG\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckPerspectivity", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "UNCFTRG"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<oKIM\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fKIM\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<oKIM\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckOrthologic", "[", "trgchk", "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<oCPTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fCPTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<oCPTR\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckOrthologic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "CPTR"}], "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<oENCTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fENCTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<oENCTR\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckOrthologic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "ENCTR"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<oUNCFTRG\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fUNCFTRG\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<oUNCFTRG\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckOrthologic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "UNCFTRG"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<plKIM\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fKIM\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<plKIM\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckParallelogic", "[", "trgchk", "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<plCPTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fCPTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<plCPTR\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckParallelogic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "CPTR"}], "]"}], "//", 
            "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<plENCTR\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fENCTR\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<plENCTR\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckParallelogic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "ENCTR"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<plUNCFTRG\>\""}], "]"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"scope", ",", "\"\<fUNCFTRG\>\""}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mon", "=", "\"\<plUNCFTRG\>\""}], ";", 
           RowBox[{
            RowBox[{"trgCheckParallelogic", "[", 
             RowBox[{"trgchk", ",", "\"\<TR\>\"", ",", "UNCFTRG"}], "]"}], "//",
             "Quiet"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"drawTriangles", "[", 
         RowBox[{"{", "trgchk", "}"}], "]"}]}], ",", "mon"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9721259353785534`*^9, 3.9721259589108047`*^9}, {
  3.9721287219914303`*^9, 3.9721287322536592`*^9}},
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[226]:=",ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPointinETC2", "[", "pt_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ptnum", ",", "set", ",", "out", ",", " ", "cmplx"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ptnum", "=", 
        RowBox[{"intnumericnorm", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pt", "//", "evaluate"}], ")"}], "/.", "rule69"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AllTrue", "[", 
          RowBox[{"ptnum", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", "#", "]"}], "==", "0"}], "&"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"set", "=", 
          RowBox[{"Keys", "[", 
           RowBox[{"Select", "[", 
            RowBox[{"ETCBaryNorm", ",", 
             RowBox[{
              RowBox[{"#", "==", "ptnum"}], "&"}]}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cmplx", "=", 
           RowBox[{"Keys", "[", 
            RowBox[{"Select", "[", 
             RowBox[{"ETCBaryNorm", ",", 
              RowBox[{
               RowBox[{"AnyTrue", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Im", "[", "#", "]"}], "!=", "0"}], "&"}]}], "]"}],
                "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"set", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"cmplx", ",", 
             RowBox[{
              RowBox[{"coincide", "[", 
               RowBox[{
                RowBox[{"ETCBaryNorm", "[", "#", "]"}], ",", "ptnum"}], "]"}],
               "&"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "set", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coincideNorm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "k", "]"}], "/.", 
                    "#"}], ",", 
                    RowBox[{"pt", "/.", "#"}]}], "]"}], "&"}], ",", 
                   "intCheckList"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"#", "||", 
                   RowBox[{"Not", "[", 
                    RowBox[{"BooleanQ", "[", "#", "]"}], "]"}]}], "&"}]}], 
                "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"out", ",", "k"}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "set"}], "}"}]}], "\[IndentingNewLine]", "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkNumberedPoint", "[", 
   RowBox[{"ptc_", ",", "trgname_", ",", "idx_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"trgn", ",", "newkey"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newkey", "==", "\"\<ABC-X3-reflections\>\""}], ",", 
       RowBox[{"newkey", "=", "\"\<ABC-X3 reflections\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newkey", "==", "\"\<anti-X3-ABC-reflections\>\""}], ",", 
       RowBox[{"newkey", "=", "\"\<anti-X3-ABC reflections\>\""}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newkey", "==", "\"\<X3-ABC-reflections\>\""}], ",", 
       RowBox[{"newkey", "=", "\"\<X3-ABC reflections\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"newkey", "==", "\"\<2nd-circumperp-tangential\>\""}], ",", 
       RowBox[{"newkey", "=", "\"\<2nd circumperp tangential\>\""}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newkey", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"trgname", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<1st-\>\"", "->", "\"\<1st \>\""}], ",", 
          RowBox[{"\"\<2nd-\>\"", "->", "\"\<2nd \>\""}], ",", 
          RowBox[{"\"\<3rd-\>\"", "->", "\"\<3rd \>\""}], ",", 
          RowBox[{"\"\<4th-\>\"", "->", "\"\<4th \>\""}], ",", 
          RowBox[{"\"\<Gemini-\>\"", "->", "\"\<Gemini \>\""}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"KimberlingTrianglesBary", ",", "newkey"}], "]"}], "]"}], 
       ",", 
       RowBox[{"Return", "[", 
        RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trgn", "=", 
      RowBox[{"intnumericnorm", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"evaluate", "[", 
          RowBox[{"triangle", "[", "newkey", "]"}], "]"}], "/.", "rule69"}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"bToCartesianN", "[", 
            RowBox[{
             RowBox[{"bCoordChangeK", "[", 
              RowBox[{"idx", ",", "trgn"}], "]"}], "/.", "rule69"}], "]"}], 
           "-", 
           RowBox[{"bToCartesianN", "[", 
            RowBox[{"ptc", "/.", "rule69"}], "]"}]}], "]"}], "]"}], ">", 
        SuperscriptBox["10", 
         RowBox[{"-", "20"}]]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trgn", "=", 
      RowBox[{"intnumericnorm", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"evaluate", "[", 
          RowBox[{"triangle", "[", "newkey", "]"}], "]"}], "/.", 
         RowBox[{"intCheckList", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"bToCartesianN", "[", 
            RowBox[{
             RowBox[{"bCoordChangeK", "[", 
              RowBox[{"idx", ",", "trgn"}], "]"}], "/.", 
             RowBox[{"intCheckList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"bToCartesianN", "[", 
            RowBox[{"ptc", "/.", 
             RowBox[{"intCheckList", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ">", 
        SuperscriptBox["10", 
         RowBox[{"-", "20"}]]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"trgn", "=", 
      RowBox[{"intnumericnorm", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"evaluate", "[", 
          RowBox[{"triangle", "[", "newkey", "]"}], "]"}], "/.", 
         RowBox[{"intCheckList", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"bToCartesianN", "[", 
            RowBox[{
             RowBox[{"bCoordChangeK", "[", 
              RowBox[{"idx", ",", "trgn"}], "]"}], "/.", 
             RowBox[{"intCheckList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"bToCartesianN", "[", 
            RowBox[{"ptc", "/.", 
             RowBox[{"intCheckList", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], ">", 
        SuperscriptBox["10", 
         RowBox[{"-", "20"}]]}], ",", 
       RowBox[{"Return", "[", 
        RowBox[{"False", ",", "Module"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 Background->RGBColor[0.9, 1, 1],
 CellLabel->"In[69]:=",ExpressionUUID->"2facbe59-1771-421e-af04-203366bb1353"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<KimberlingPoints.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<KimberlingPoints.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "defined", ",", "KimberlingCenter", ",", " ", "KimberlingCenterC", ",", 
      " ", "KimberlingCenterCN", ",", " ", "getTriangleCurve", ",", 
      "getvalue", ",", "ruleAbsSquare", ",", " ", "rule69", ",", " ", 
      "checkCurvesSymb", ",", "checkPointinETC2", ",", "rulesSimplify", ",", 
      "checkPointsOnCurve", ",", "X", ",", "checkPointOnCurveNum", ",", 
      "checkPointsOnCurveNamed", ",", "XNy", ",", "checkTrianglesOnCurve", 
      ",", "checkCurvesForTriangle", ",", "sinReplace", ",", 
      "checkTriangleExists", ",", "trgCheckPerspectivity", ",", 
      "trgCheckParallelogic", ",", "trgCheckOrthologic", ",", 
      "checkNumberedPoint", ",", "trgCheckBasepoints", ",", "trgFullCheck"}], 
     "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
},
WindowSize->{1102.8, 615.6},
WindowMargins->{{-5.3999999999999995`, Automatic}, {-5.399999999999977, 
   Automatic}},
DockedCells->{},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d28a54b2-181c-47cf-a4e8-d4f2c6cc05a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 661, 11, 26, "Input",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],
Cell[1222, 33, 5866, 164, 612, "Code",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52",
 InitializationCell->False],
Cell[7091, 199, 468, 13, 26, "Input",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],
Cell[7562, 214, 508, 12, 25, "Input",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],
Cell[8073, 228, 1426, 42, 59, "Input",ExpressionUUID->"8adc4980-6855-491e-857a-2e383c343b5f"],
Cell[9502, 272, 63183, 1496, 5757, "Input",ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],
Cell[72688, 1770, 9127, 228, 775, "Input",ExpressionUUID->"2facbe59-1771-421e-af04-203366bb1353"],
Cell[81818, 2000, 1024, 18, 95, "Input",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
}
]
*)

