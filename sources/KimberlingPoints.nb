(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16813,        447]
NotebookOptionsPosition[     15638,        421]
NotebookOutlinePosition[     16168,        441]
CellTagsIndexPosition[     16125,        438]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8399130150855227`*^9, 3.8399130150855227`*^9}, 
   3.839919710866042*^9, 3.8399199407660537`*^9, {3.8399201289222293`*^9, 
   3.839920152741045*^9}, {3.8399205883358803`*^9, 3.839920595085084*^9}, {
   3.83992070302919*^9, 3.8399207092031746`*^9}, {3.8416249776934814`*^9, 
   3.8416249791378546`*^9}, 3.841627116456952*^9, {3.8418034050176563`*^9, 
   3.841803420274452*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"defined", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ToExpression", "[", 
      RowBox[{"\"\<ValueQ[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Head", "@", 
       RowBox[{"ToExpression", "[", "s", "]"}]}], "=!=", "Symbol"}], "||", 
     "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<Attributes[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<DownValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}], "||", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"ToExpression", "[", 
       RowBox[{"\"\<SubValues[\>\"", "<>", "s", "<>", "\"\<]\>\""}], "]"}], "=!=", 
      RowBox[{"{", "}"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getvalue", "[", 
     RowBox[{"ass_", ",", "key_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"KeyExistsQ", "[", 
       RowBox[{"ass", ",", "key"}], "]"}], ",", 
      RowBox[{"ass", "[", "key", "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "Indeterminate", ",", " ", "Indeterminate", ",", " ", 
        "Indeterminate"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenter", "[", 
    RowBox[{"k_", ",", " ", "XPA_", ",", " ", "XPB_", ",", " ", "XPC_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "bary", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"bary", " ", "=", " ", 
       RowBox[{"KimberlingCenterCN", "[", "k", "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"Dot", "[", 
        RowBox[{
         FractionBox["bary", 
          RowBox[{"Total", "[", "bary", "]"}]], ",", 
         RowBox[{"{", 
          RowBox[{"XPA", ",", "XPB", ",", "XPC"}], "}"}]}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"XPB", ",", "XPC"}], "]"}]}], ",", " ", 
         RowBox[{"b", "->", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"XPA", ",", "XPC"}], "]"}]}], ",", " ", 
         RowBox[{"c", "->", 
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"XPA", ",", "XPB"}], "]"}]}]}], "}"}]}]}]}], "\n", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenterC", "[", "k_", "]"}], ":=", 
   RowBox[{
    RowBox[{"symmetrizeInternal", "[", 
     RowBox[{"ETC", "[", 
      RowBox[{"\"\<X\>\"", "<>", 
       RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "]"}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "->", "angleA"}], ",", 
       RowBox[{"B", "->", "angleB"}], ",", 
       RowBox[{"C", "->", "angleC"}]}], "}"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenterCN", "[", "k_", "]"}], ":=", 
   RowBox[{"evaluate", "[", 
    RowBox[{
     RowBox[{"symmetrizeInternal", "[", 
      RowBox[{"ETC", "[", 
       RowBox[{"\"\<X\>\"", "<>", 
        RowBox[{"ToString", "[", "k", "]"}]}], "]"}], "]"}], "/.", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"A", "->", "angleA"}], ",", 
        RowBox[{"B", "->", "angleB"}], ",", 
        RowBox[{"C", "->", "angleC"}]}], "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"getTriangleCurve", "[", "name_", "]"}], ":=", 
   RowBox[{
    RowBox[{"TriangleCurves", "[", "name", "]"}], "//", "evaluate"}]}], 
  ";"}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{{3.854357504781231*^9, 3.8543575362929363`*^9}, {
   3.854357635899296*^9, 3.854357636234169*^9}, {3.8543577067642393`*^9, 
   3.8543580411107225`*^9}, 3.8543580813509665`*^9, {3.854358124557372*^9, 
   3.8543581902543573`*^9}, 3.854358273245316*^9, {3.855978280215998*^9, 
   3.855978280778244*^9}, {3.860296169452752*^9, 3.860296200350801*^9}, 
   3.860386921213872*^9, {3.8604121583280196`*^9, 3.860412164843548*^9}, {
   3.8659274328788424`*^9, 3.8659274352855854`*^9}, {3.8696349525916443`*^9, 
   3.869634969135768*^9}, {3.8756693997978477`*^9, 3.8756694336741095`*^9}, {
   3.8756722514895*^9, 3.875672252393491*^9}, {3.8756723050784245`*^9, 
   3.8756723200662594`*^9}, {3.875684691002965*^9, 3.875684695479085*^9}, 
   3.8756850554764657`*^9, {3.8761072962629213`*^9, 3.876107300073724*^9}, {
   3.876118292537616*^9, 3.87611829369162*^9}, 3.8761184836401944`*^9, 
   3.876727981357052*^9, 3.880096954784444*^9, {3.8803720035799265`*^9, 
   3.880372004902145*^9}, {3.881386927058708*^9, 3.881386946030436*^9}, {
   3.881386980471122*^9, 3.8813869883111744`*^9}, {3.881387306638982*^9, 
   3.88138730918622*^9}, {3.8818143594395895`*^9, 3.881814360259025*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ruleAbsSquare", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "x___", "]"}], "^", "2"}], " ", ":>", " ", 
     RowBox[{"x", "^", "2"}]}], "}"}]}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Can", " ", "also", " ", "be", " ", "just", " ", "Abs"}], "->", 
    "RealAbs"}], " ", "*)"}]}]], "Input",
 CellLabel->
  "In[121]:=",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rule69", "=", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{"6", ",", "9", ",", "13"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8659359365025496`*^9, 3.8659359467166414`*^9}, {
  3.877578389921321*^9, 3.877578397215644*^9}, {3.8779284662523875`*^9, 
  3.877928467254416*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rulesSimplify", "=", " ", 
   RowBox[{
    RowBox[{"a", ">", "0"}], "&&", 
    RowBox[{"b", ">", "0"}], "&&", 
    RowBox[{"c", ">", "0"}], "&&", 
    RowBox[{
     RowBox[{"a", "+", "b"}], ">", "c"}], "&&", 
    RowBox[{
     RowBox[{"a", "+", "c"}], ">", "b"}], "&&", 
    RowBox[{
     RowBox[{"b", "+", "c"}], ">", "a"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.883556220339327*^9, 3.883556251713106*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"8adc4980-6855-491e-857a-2e383c343b5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"checkCurvesSymb", "[", "pt_", "]"}], ":=", 
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"curve", "=", 
       RowBox[{"getTriangleCurve", "[", "name", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"curve", "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], "]"}]}],
           "]"}], "==", "0"}], ",", 
        RowBox[{"Print", "[", "name", "]"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"name", ",", 
       RowBox[{"Keys", "[", "TriangleCurves", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"checkPointsOnCurve", "[", "crv_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"curve", ",", " ", "curve2", ",", " ", "out"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"curve", "=", 
       RowBox[{
        RowBox[{"evaluate", "[", "crv", "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"u", ",", "v", ",", "w"}], "}"}], "->", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"curve2", "=", 
       RowBox[{"curve", "/.", "rule69"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"test", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"curve2", "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], 
              "]"}]}], "]"}], "&"}], "/@", "ETCBaryNorm"}], ",", 
         RowBox[{
          RowBox[{"#", "<", 
           SuperscriptBox["10", 
            RowBox[{"-", "12"}]]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "one", " ", "more", " ", "rule"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ni", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"curve", "/.", 
                 RowBox[{"Thread", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "ni", "]"}], "//", 
                    "simplifyRationalBarycentrics"}], ")"}]}], "]"}]}], "/.", 
                RowBox[{"intCheckList", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "20"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"ni", ",", 
             RowBox[{"Keys", "[", "test", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "<>", 
          "\"\<(\>\"", "<>", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}], 
         "&"}], ",", "out"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 Background->RGBColor[0.94, 0.88, 0.94],
 CellLabel->
  "In[189]:=",ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPointinETC2", "[", "pt_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ptnum", ",", "set", ",", "out"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ptnum", "=", 
        RowBox[{"intnumericnorm", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pt", "//", "evaluate"}], ")"}], "/.", "rule69"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"set", "=", 
        RowBox[{"Keys", "[", 
         RowBox[{"Select", "[", 
          RowBox[{"ETCBaryNorm", ",", 
           RowBox[{
            RowBox[{"#", "==", "ptnum"}], "&"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"out", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "set", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AllTrue", "[", 
                RowBox[{
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"coincideNorm", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "k", "]"}], "/.", 
                    "#"}], ",", 
                    RowBox[{"pt", "/.", "#"}]}], "]"}], "&"}], ",", 
                   "intCheckList"}], "]"}], ",", 
                 RowBox[{"#", "&"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"out", ",", "k"}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "set"}], "}"}]}], "\[IndentingNewLine]", "]"}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkPointinETC69", "[", "pt_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ptnum", ",", "set"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptnum", "=", 
      RowBox[{"intnumericnorm", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pt", "//", "evaluate"}], ")"}], "/.", "rule69"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Keys", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"ETCBaryNorm", ",", 
        RowBox[{
         RowBox[{"#", "==", "ptnum"}], "&"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"2facbe59-1771-421e-af04-203366bb1353"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<KimberlingPoints.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<KimberlingPoints.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "defined", ",", "KimberlingCenter", ",", " ", "KimberlingCenterC", ",", 
      " ", "KimberlingCenterCN", ",", " ", "getTriangleCurve", ",", 
      "getvalue", ",", "ruleAbsSquare", ",", " ", "rule69", ",", " ", 
      "checkCurvesSymb", ",", "checkPointinETC2", ",", "checkPointinETC69", 
      ",", "rulesSimplify", ",", "checkPointsOnCurve"}], "}"}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[193]:=",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
},
WindowSize->{1105.2, 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
DockedCells->{},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.9 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d28a54b2-181c-47cf-a4e8-d4f2c6cc05a1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 665, 12, 26, "Input",ExpressionUUID->"436b7e03-1782-4754-9ece-a6aea07591c6"],
Cell[1226, 34, 4956, 122, 291, "Code",ExpressionUUID->"ef28bf9e-8e85-46b6-83f1-55ec1009fe52",
 InitializationCell->False],
Cell[6185, 158, 453, 13, 26, "Input",ExpressionUUID->"e6ee65e5-4303-4b7d-bc1f-e4a938bc6dcb"],
Cell[6641, 173, 512, 13, 25, "Input",ExpressionUUID->"59eb944d-bbd3-4aef-a170-433086bc3bf3"],
Cell[7156, 188, 530, 15, 26, "Input",ExpressionUUID->"8adc4980-6855-491e-857a-2e383c343b5f"],
Cell[7689, 205, 4211, 117, 271, "Input",ExpressionUUID->"e4c48e3c-0e37-45b4-aa3b-950f31b20c4e"],
Cell[11903, 324, 3063, 79, 383, "Input",ExpressionUUID->"2facbe59-1771-421e-af04-203366bb1353"],
Cell[14969, 405, 665, 14, 60, "Input",ExpressionUUID->"58364175-8417-42fc-be84-aa24791f6f0c"]
}
]
*)

