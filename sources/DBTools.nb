(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    172201,       4180]
NotebookOptionsPosition[    169821,       4143]
NotebookOutlinePosition[    170475,       4164]
CellTagsIndexPosition[    170432,       4161]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.858229176389264*^9, 3.858229446693867*^9, 3.8602953602247972`*^9, 
   3.860302009654538*^9, {3.860485791732256*^9, 3.860485794873648*^9}, {
   3.860485932054061*^9, 3.860485933925563*^9}, {3.875666590817411*^9, 
   3.8756665934403267`*^9}, {3.8756666396111803`*^9, 3.875666670228642*^9}, {
   3.87568396954793*^9, 3.875683973023356*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xnum", "[", "str_", "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"StringTake", "[", 
     RowBox[{"str", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numsortexpr", "[", "str_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"str", ",", "1"}], "]"}], "<>", 
    RowBox[{"StringPadLeft", "[", 
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "10", ",", "\"\<0\>\""}],
      "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intnameformat", "[", "pname_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"pname", ",", "1"}], "]"}], "==", "\"\<X\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"StringTake", "[", 
      RowBox[{"pname", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", "1"}], "]"}], "<>", "\"\<(\>\"", "<>", 
        RowBox[{"StringTake", "[", 
         RowBox[{"pname", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "pname"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intaddbrackets", "[", "pname_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringTake", "[", 
     RowBox[{"pname", ",", "1"}], "]"}], "<>", "\"\<(\>\"", "<>", 
    RowBox[{"StringTake", "[", 
     RowBox[{"pname", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "<>", "\"\<)\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intmark", "[", 
    RowBox[{"number_", ",", 
     RowBox[{"spec", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ".."}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Characters", "@", 
         RowBox[{"ToString", "@", "number"}]}]}], "}"}], ",", 
      RowBox[{"Fold", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"MapAt", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", 
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ",", "x", ",", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}], ",", "n", ",", 
        "spec"}], "]"}]}], "]"}], "//", "Row"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"colorformat", "[", 
     RowBox[{"string_", ",", 
      RowBox[{"cases_", ":", 
       RowBox[{
       "RegularExpression", "[", "\"\<Y\\\\(\\\\d+\\\\)|Y\\\\d+\>\"", 
        "]"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pos", ",", "agg", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"TrueQ", "[", "colorPrintOn", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"string", ",", " ", "Module"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", "=", 
        RowBox[{"StringPosition", "[", 
         RowBox[{"string", ",", "cases"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"agg", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Switch", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1", ",", "Red", 
              ",", "2", ",", "Brown", ",", "_", ",", "Blue"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
         RowBox[{"GatherBy", "[", 
          RowBox[{
           RowBox[{"Tally", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Range", "@@@", "pos"}], "]"}]}], ",", "Last"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "agg", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"intmark", "[", 
           RowBox[{"string", ",", "agg"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "string", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intnumericnorm", "[", "val_", "]"}], ":=", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"NormalizeBary", "[", "val", "]"}], ",", "35"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coincide", "[", 
    RowBox[{"pt1_", ",", "pt2_", ",", 
     RowBox[{"prec_", ":", "20"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "-", 
       RowBox[{"pt2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "prec"}]]}], "&&", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"pt2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "prec"}]]}], "&&", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"pt1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "-", 
       RowBox[{"pt2", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "prec"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coincideNorm", "[", 
    RowBox[{"pt1_", ",", "pt2_", ",", 
     RowBox[{"prec_", ":", "20"}]}], "]"}], ":=", 
   RowBox[{"Return", "[", 
    RowBox[{"coincide", "[", 
     RowBox[{
      RowBox[{"intnumericnorm", "[", "pt1", "]"}], ",", 
      RowBox[{"intnumericnorm", "[", "pt2", "]"}], ",", "prec"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalSeenPoints", "=", 
   RowBox[{"List", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalProperties", " ", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intCheckList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", "5"}], ",", 
       RowBox[{"b", "->", "6"}], ",", 
       RowBox[{"c", "->", "7"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "->", "4"}], ",", 
       RowBox[{"b", "->", "11"}], ",", 
       RowBox[{"c", "->", "13"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"b80a96f9-c842-4ef8-9bf5-1d19f4841581"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pointProcessBary", "[", 
    RowBox[{"expr_", ",", " ", 
     RowBox[{"rule_", ":", "rule69"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pointsBary", ",", " ", "pti", ",", "pta", ",", " ", "str", ",", " ", 
       "coords"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pointsBary", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"pta", " ", "=", " ", 
          RowBox[{"ETCBaryNorm", "[", "k", "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AnyTrue", "[", 
            RowBox[{
             RowBox[{"Im", "[", "pta", "]"}], ",", 
             RowBox[{
              RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"AnyTrue", "[", 
             RowBox[{"pta", ",", 
              RowBox[{
               RowBox[{"#", "===", "ComplexInfinity"}], "&"}]}], "]"}], "||", 
            RowBox[{"AnyTrue", "[", 
             RowBox[{"pta", ",", 
              RowBox[{
               RowBox[{"#", "===", "Infinity"}], "&"}]}], "]"}]}], ",", " ", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Point", " ", "Process", " ", "Calculation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"pti", " ", "=", " ", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"evaluate", "[", 
             RowBox[{"ReleaseHold", "[", 
              RowBox[{"expr", "/.", 
               RowBox[{"#", "->", "pta"}]}], "]"}], "]"}], "/.", "rule"}], 
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"pti", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "=!=", "Indeterminate"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"pointsBary", ",", 
              RowBox[{"k", "->", "pti"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Keys", "[", "ETCBaryNorm", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pointsBary", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[56]:=",ExpressionUUID->"74111645-2b56-4fda-8b77-c132e8d1be4b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intVerifyPointProcess", "[", 
    RowBox[{"pt_", ",", "xnum_", ",", "processexpr_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptn", ",", "pta", ",", "pti"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ptn", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{"pt", "/.", "rc"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pta", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"KimberlingCenterCNy", "[", "xnum", "]"}], "/.", "rc"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pti", " ", "=", 
          RowBox[{"intnumericnorm", "[", 
           RowBox[{
            RowBox[{"ReleaseHold", "[", 
             RowBox[{"processexpr", "/.", 
              RowBox[{"#", "->", "pta"}]}], "]"}], "/.", "rc"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"If", " ", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"coincide", "[", 
             RowBox[{"ptn", ",", " ", "pti"}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Return", "[", 
             RowBox[{"False", ",", " ", "Module"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"rc", ",", "intCheckList"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"26d5a62e-503c-4018-a856-34e31e5b398f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intPointCheck", "[", 
    RowBox[{"pt_", ",", "process_", ",", 
     RowBox[{"rule_", ":", "rule69"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tmp", ",", "res", ",", "ptn", ",", "ptnum"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ptn", "=", 
       RowBox[{"intnumericnorm", "[", 
        RowBox[{"pt", "/.", "rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"pointProcessBary", "[", 
        RowBox[{"process", ",", "rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{"#", ",", " ", "ptn"}], "]"}], "&"}], "/@", "tmp"}], ",", 
         "TrueQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"intVerifyPointProcess", "[", 
            RowBox[{"pt", ",", 
             RowBox[{
              RowBox[{"Keys", "[", "res", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "process"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "res", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[58]:=",ExpressionUUID->"c39b8072-918d-4251-8a15-74a2adcadfbe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"pointCheckAllProcesses", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", " ", "prop"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"PrintTemporary", "[", "proc", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", 
          RowBox[{"intPointCheck", "[", 
           RowBox[{"pt", ",", 
            RowBox[{"singlePointProcesses", "[", "proc", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringQ", "[", "res", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prop", " ", "=", " ", 
             RowBox[{
             "\"\<= \>\"", "<>", " ", "proc", "<>", "\"\< of \>\"", "<>", 
              "res"}]}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"prop", "//", "colorformat"}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AssociateTo", "[", 
             RowBox[{
              RowBox[{"globalProperties", "[", "name", "]"}], ",", 
              RowBox[{"proc", "->", 
               RowBox[{"intaddbrackets", "[", "res", "]"}]}]}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"proc", ",", 
          RowBox[{"Keys", "[", "singlePointProcesses", "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellLabel->"In[59]:=",ExpressionUUID->"138afecd-e9f2-4f46-90cb-79229dc0c3d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"singlePointProcesses", "=", 
   RowBox[{"Association", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<complement\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterCN", "[", "2", "]"}], ",", "#"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bAntiComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterCN", "[", "2", "]"}], ",", "#"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<polar conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bPIsogonalConjugate", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterCN", "[", "48", "]"}], ",", "#"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<cyclocevian conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bCyclocevianConjugate", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<circumcircle inverse\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bCircumcircleInverse", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<zosma transform\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bZosmaTransform", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement of isogonal conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bAntiComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
         RowBox[{"bIsogonalConjugate", "[", "#", "]"}]}], "]"}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<anticomplement of isotomic conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bAntiComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
         RowBox[{"bIsotomicConjugate", "[", "#", "]"}]}], "]"}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<complement of isogonal conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
         RowBox[{"bIsogonalConjugate", "[", "#", "]"}]}], "]"}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<complement of isotomic conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bComplement", "[", 
        RowBox[{
         RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", 
         RowBox[{"bIsotomicConjugate", "[", "#", "]"}]}], "]"}], "]"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"\"\<circlecevian perspector\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bCirclecevianPerspector", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<tcc_perspector\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bTCCPerspector", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<eigentransform\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bEigentransform", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<ortoassociate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bOrthoassociate", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<antitomic conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bAntitomicConjugate", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<syngonal conjugate\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bSyngonal", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<1st saragossa point\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bSaragossa1", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<2nd saragossa point\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bSaragossa2", "[", "#", "]"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<3rd saragossa point\>\"", "->", 
      RowBox[{"Hold", "[", 
       RowBox[{"bSaragossa3", "[", "#", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[60]:=",ExpressionUUID->"6b44296a-dc56-44c3-981b-023a39cb076c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"intLinesProcessFullGroups", "[", 
     RowBox[{"pt_", ",", "prec_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tplist", ",", " ", "tp", ",", " ", "prev", ",", " ", "outgroups", ",",
         " ", "group", ",", " ", "fullgroups", ",", " ", "dump"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tplist", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"fullgroups", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tp", "=", 
           RowBox[{"1", "/", 
            RowBox[{"bLine", "[", 
             RowBox[{"pt", ",", 
              RowBox[{"ETCBaryNorm", "[", "name", "]"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Im", "[", 
               RowBox[{"tp", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "!=", "0"}], " ", "||",
              " ", 
             RowBox[{"AnyTrue", "[", 
              RowBox[{"Not", "[", 
               RowBox[{"NumberQ", "[", "tp", "]"}], "]"}], "]"}]}], ",", " ", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"tplist", ",", 
            RowBox[{"{", 
             RowBox[{"name", ",", 
              RowBox[{"NormalizeBary", "[", "tp", "]"}]}], "}"}]}], "]"}], 
          ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "ETCBaryNorm", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tplist", "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{"tplist", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"prev", "=", 
        RowBox[{"{", 
         RowBox[{"\"\<0\>\"", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";", 
       RowBox[{"outgroups", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"group", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"coincide", "[", 
             RowBox[{
              RowBox[{"el", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"prev", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"group", ",", "el"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "group", "]"}], "==", "1"}], ",", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"group", ",", "prev"}], "]"}], ";", 
                RowBox[{"dump", "=", "1"}]}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dump", "==", "1"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"fullgroups", ",", "group"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"outgroups", ",", 
                  RowBox[{"Take", "[", 
                   RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{"group", ",", 
                    RowBox[{
                    RowBox[{"numsortexpr", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
                    ",", "2"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"group", "=", 
                 RowBox[{"{", "}"}]}], ";", 
                RowBox[{"dump", "=", "0"}]}]}], "\[IndentingNewLine]", "]"}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"prev", "=", "el"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"el", ",", "tplist"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"outgroups", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"outgroups", ",", 
          RowBox[{
           RowBox[{"numsortexpr", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fullgroups", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "&"}], ",", "#"}], "]"}], 
           "&"}], ",", "fullgroups"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"keep", " ", "point", " ", "names", " ", "only"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"outgroups", ",", " ", "fullgroups"}], "}"}], "]"}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intHarmonicProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Harmonic", " ", "conjugates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"keep", " ", "only", " ", "2000", " ", "elements"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "2000"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<Found lines with \>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"Length", "[", "fgr1", "]"}], "]"}], "<>", 
                "\"\< points\>\""}], "]"}]}], "]"}], ";", 
            RowBox[{"fgr1", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"fgr1", ",", "2000"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"flatfg2", "=", 
          RowBox[{"Subsets", "[", 
           RowBox[{"fgr1", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"checks", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NormalizeBary", "[", 
              RowBox[{"bHarmonicConjugate", "[", 
               RowBox[{
                RowBox[{"ETCBaryNorm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                RowBox[{"ETCBaryNorm", "[", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "pt"}], "]"}], 
              "]"}], "&"}], ",", "flatfg2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ingroupnbary", "=", 
          RowBox[{"KeySelect", "[", 
           RowBox[{"ETCBaryNorm", ",", " ", 
            RowBox[{
             RowBox[{"MemberQ", "[", " ", 
              RowBox[{"fgr1", ",", "#"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"un", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"checks", ",", "ingroupnbary"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hgroup", "=", 
          RowBox[{"{", "}"}]}], ";", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"\"\<X0\>\"", "->", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "|>"}]}], ";", 
         RowBox[{"dump", "=", "0"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"coincide", "[", 
               RowBox[{
                RowBox[{"un", "[", "el", "]"}], ",", 
                RowBox[{"prev", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hgroup", ",", "el"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hgroup", "]"}], "==", "1"}], ",", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"hgroup", ",", 
                    RowBox[{
                    RowBox[{"Keys", "[", "prev", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";", 
                  RowBox[{"dump", "=", "1"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"dump", "==", "1"}], " ", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"AnyTrue", "[", 
                    RowBox[{
                    RowBox[{"Map", "[", 
                    RowBox[{"Length", ",", "hgroup"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "==", "0"}], "&"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"hgroups", ",", "hgroup"}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"hgroup", "=", 
                   RowBox[{"{", "}"}]}], ";", 
                  RowBox[{"dump", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
                "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"el", "->", 
               RowBox[{"un", "[", "el", "]"}]}], "|>"}]}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"el", ",", 
             RowBox[{"Keys", "[", "un", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Input",
 CellLabel->
  "In[182]:=",ExpressionUUID->"51aa5bfe-e1a6-46b3-93f3-4a939e2f11f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intReflectionProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Reflections", " ", "conjugates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"keep", " ", "only", " ", "1000", " ", "eleents"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "2000"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fgr1", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"fgr1", ",", "2000"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"checks", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NormalizeBary", "[", 
              RowBox[{"bMidpoint", "[", 
               RowBox[{
                RowBox[{"ETCBaryNorm", "[", "#", "]"}], ",", "pt"}], "]"}], 
              "]"}], "&"}], ",", "fgr1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"refl", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"fgr1", ",", " ", 
               RowBox[{
                RowBox[{"coincide", "[", 
                 RowBox[{
                  RowBox[{"ETCBaryNorm", "[", "#", "]"}], ",", 
                  RowBox[{"checks", "[", "el", "]"}]}], "]"}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "refl", "]"}], ">", "0"}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"hgroups", ",", 
                RowBox[{"{", 
                 RowBox[{"el", ",", 
                  RowBox[{"refl", "//", "First"}]}], "}"}]}], "]"}]}], 
             "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"el", ",", 
             RowBox[{"Keys", "[", "checks", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"bca15176-ab78-40f6-ad1d-3f9d33e84dcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"intMidpointProcess", "[", 
    RowBox[{"fullgroups_", ",", "pt_", ",", "prec_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fgr1", ",", "checks", ",", "flatfg2", ",", " ", "ingroupnbary", ",", 
       " ", "un", ",", "hgroups", ",", "hgroup", ",", " ", "prev", ",", " ", 
       "dump"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Midpoints", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hgroups", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fgr1", "=", " ", 
          RowBox[{"SortBy", "[", 
           RowBox[{"set", ",", 
            RowBox[{
             RowBox[{"numsortexpr", "[", "#", "]"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"keep", " ", "only", " ", "1000", " ", "eleents"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "fgr1", "]"}], ">", "2000"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fgr1", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"fgr1", ",", "2000"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"flatfg2", "=", 
          RowBox[{"Subsets", "[", 
           RowBox[{"fgr1", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ingroupnbary", "=", 
          RowBox[{"AssociationMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"NormalizeBary", "[", 
                RowBox[{"bMidpoint", "[", 
                 RowBox[{
                  RowBox[{"ETCBaryNorm", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                  RowBox[{"ETCBaryNorm", "[", 
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "]"}], 
               "-", "pt"}], "]"}], "&"}], ",", "flatfg2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"hgroup", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"ingroupnbary", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}], "&&", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "<", 
               SuperscriptBox["10", 
                RowBox[{"-", "prec"}]]}]}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hgroup", "]"}], ">", "0"}], ",", 
           RowBox[{"hgroups", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"hgroups", ",", 
              RowBox[{"Keys", "[", "hgroup", "]"}]}], "]"}]}]}], "]"}], ";"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"set", ",", "fullgroups"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "hgroups", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[64]:=",ExpressionUUID->"83275f8c-a3be-4d54-8212-7b9bf0d4d228"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KimberlingCenterCNy", "[", "key_", "]"}], ":=", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{"key", ",", "1"}], "]"}], "==", "\"\<X\>\""}], ",", 
     RowBox[{"KimberlingCenterCN", "[", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringTake", "[", 
        RowBox[{"key", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"evaluate", "[", 
      RowBox[{"symmetrizeInternal", "[", 
       RowBox[{
        RowBox[{"ETC", "[", "key", "]"}], "/.", "\[VeryThinSpace]", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"A", "\[Rule]", "angleA"}], ",", 
           RowBox[{"B", "\[Rule]", "angleB"}], ",", 
           RowBox[{"C", "\[Rule]", "angleC"}]}], "}"}], "]"}]}], "]"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"8be899e7-53f5-49b1-a9d2-301ac7f326c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"linesProcessAlg", "[", 
    RowBox[{
    "ptcoord_", ",", "printexpr_", ",", "prec_", ",", "debug_", ",", " ", 
     "abort_", ",", " ", "name_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", "gr", ",", "hg", ",", "out", ",", "head", ",", " ", "test", 
       ",", "test2", ",", "hgroups", ",", "ptc", ",", "unproven", ",", "rc", 
       ",", "rc2", ",", "eltest", ",", "sout", ",", "barys", ",", "outname"}],
       "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Lines", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"rc2", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"NormalizeBary", "[", 
          RowBox[{
           RowBox[{"evaluate", "[", "ptcoord", "]"}], "/.", "rule69"}], "]"}],
          ",", "35"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"intLinesProcessFullGroups", "[", 
        RowBox[{"ptc", ",", "prec"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gr", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "&"}], ",", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"out", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"unproven", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"debug", ",", 
           RowBox[{"PrintTemporary", "[", "el", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test", " ", "=", 
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"bCollinearityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
              RowBox[{"ptcoord", "/.", "rc"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "10", ",", "\[IndentingNewLine]", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"test2", " ", "=", 
          RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"bCollinearityMatrix", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
              RowBox[{
               RowBox[{"KimberlingCenterCNy", "[", 
                RowBox[{"el", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
              RowBox[{"ptcoord", "/.", "rc2"}]}], "]"}], ",", 
            "\[IndentingNewLine]", "10", ",", "\[IndentingNewLine]", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], "]"}]}], 
           ",", " ", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"out", ",", "el"}], "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"unproven", ",", "el"}], "]"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"el", ",", "gr"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "out", "]"}], ">=", "2"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Sort", " ", "to", " ", "get", " ", "a", " ", "proposed", " ", 
          "point", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sout", "=", 
          RowBox[{"SortBy", "[", 
           RowBox[{"out", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"numsortexpr", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
              RowBox[{"numsortexpr", "[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"outname", "=", 
          RowBox[{
           RowBox[{"intaddbrackets", "[", 
            RowBox[{
             RowBox[{"sout", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
           RowBox[{"intaddbrackets", "[", 
            RowBox[{
             RowBox[{"sout", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", "\"\<\:2229\>\"", "<>", 
           RowBox[{"intaddbrackets", "[", 
            RowBox[{
             RowBox[{"sout", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", 
           RowBox[{"intaddbrackets", "[", 
            RowBox[{
             RowBox[{"sout", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AssociateTo", "[", 
          RowBox[{
           RowBox[{"globalProperties", "[", "name", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<name\>\"", "\[Rule]", "outname"}], "}"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
           RowBox[{"Print", "[", 
            RowBox[{"outname", "//", "colorformat"}], "]"}]}], "]"}], ";"}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"barys", " ", "=", " ", 
       RowBox[{"ExpressionToTrad", "[", 
        RowBox[{"printexpr", "//", "Simplify"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<barycentrics\>\"", "\[Rule]", "barys"}], "}"}]}], "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Barycentrics    \>\"", "<>", "barys"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"out", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "out"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<lines\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{"colorformat", "[", 
          RowBox[{"\"\<Lies on these lines: \>\"", "<>", " ", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Unproven Lines\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"ToString", "[", "unproven", "]"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "stop", " ", "if", " ", "too", " ", "few", " ", "lines", " ", 
        "found"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"abort", " ", "&&", " ", 
         RowBox[{
          RowBox[{"Length", "[", "out", "]"}], "<", "3"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"out", ",", " ", "Module"}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Format", " ", "harmonic", " ", "groups", " ", "List"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"bogus", " ", "groups", " ", "due", " ", "to", " ", "6"}], 
         "-", "9", "-", 
         RowBox[{"13", " ", "metric", " ", "relations"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "igroup", "]"}], "!=", "2"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"igroup", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
               RowBox[{"Length", "[", 
                RowBox[{"igroup", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "]"}], "!=", 
            RowBox[{"{", 
             RowBox[{"0", ",", "2"}], "}"}]}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"head", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"igroup", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], "==", "0"}], "&"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"el", "==", 
               RowBox[{"head", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"eltest", " ", "=", " ", 
             RowBox[{"Flatten", "[", 
              RowBox[{"{", 
               RowBox[{"el", ",", 
                RowBox[{"head", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test", " ", "=", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                RowBox[{"bHarmonicConjugate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
                 "]"}], ",", 
                RowBox[{"ptcoord", "/.", "rc"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test2", " ", "=", 
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
                RowBox[{"bHarmonicConjugate", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", 
                    RowBox[{"eltest", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
                 "]"}], ",", 
                RowBox[{"ptcoord", "/.", "rc2"}]}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
               RowBox[{"TrueQ", "[", 
                RowBox[{
                 RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], 
                "]"}]}], ",", " ", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"el", ",", "igroup"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"igroup", ",", 
          RowBox[{"intHarmonicProcess", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
           "]"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"hg", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"hg", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<harmonic\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= {X(i),X(j)}-harmonic conjugate of X(k) for these (i,j,k): \
\>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Format", " ", "midpoints", " ", "groups", " ", "List"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"eltest", " ", "=", " ", "igroup"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test", " ", "=", " ", 
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"bMidpoint", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
              "]"}], ",", 
             RowBox[{"ptcoord", "/.", "rc"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test2", " ", "=", " ", 
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"bMidpoint", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
              "]"}], ",", 
             RowBox[{"ptcoord", "/.", "rc2"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], "]"}]}], 
           ",", " ", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"igroup", ",", 
          RowBox[{"intMidpointProcess", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hg", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"hg", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<midpoints\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"\"\<= midpoint of X(i) in X(j) for these {i,j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Format", " ", "reflection", " ", "groups", " ", "List"}], " ",
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"eltest", " ", "=", " ", "igroup"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test", " ", "=", " ", 
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"bReflectionPP", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc"}], ",", 
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc"}]}], 
              "]"}], ",", 
             RowBox[{"ptcoord", "/.", "rc"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"test2", " ", "=", " ", 
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", " ", 
             RowBox[{"bReflectionPP", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", "rc2"}], ",", 
               RowBox[{
                RowBox[{"KimberlingCenterCNy", "[", 
                 RowBox[{"eltest", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "]"}], "/.", "rc2"}]}], 
              "]"}], ",", 
             RowBox[{"ptcoord", "/.", "rc2"}]}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test", "]"}], "==", "0"}], "]"}], "&&", 
            RowBox[{"TrueQ", "[", 
             RowBox[{
              RowBox[{"Simplify", "[", "test2", "]"}], "==", "0"}], "]"}]}], 
           ",", " ", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"hg", ",", "eltest"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"igroup", ",", 
          RowBox[{"intReflectionProcess", "[", 
           RowBox[{
            RowBox[{"res", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "ptc", ",", "prec"}], 
           "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"hg", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{"hg", ",", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hg", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "hg"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<reflections\>\"", "\[Rule]", "hg"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= reflection of X(i) in X(j) for these {i,j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "out", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[219]:=",ExpressionUUID->"88798590-dcbe-4e1a-a851-954fbc2ef3de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkCircumconics", "[", 
    RowBox[{"pt_", ",", " ", 
     RowBox[{"start_", ":", "1"}], ",", 
     RowBox[{"time_", ":", "60"}], ",", " ", 
     RowBox[{"excl_", ":", "0"}], ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ptc", ",", "p1", ",", "p2", ",", "crv", ",", "dset", ",", "test", ",", 
       "out", ",", "conicname", ",", "check"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ptc", " ", "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"NormalizeBary", "[", " ", 
             RowBox[{"pt", "/.", "rule69"}], "]"}], ",", "35"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ClearSystemCache", "[", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"funcind", "=", "nx"}], ";", 
            RowBox[{"(*", 
             RowBox[{"global", " ", "variable"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Only", " ", "check", " ", "simple", " ", "barycentrics", " ", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"Not", "[", 
                  RowBox[{"PolynomialQ", "[", 
                   RowBox[{
                    RowBox[{"evaluate", "[", 
                    RowBox[{"ETC", "[", 
                    RowBox[{"\"\<X\>\"", "<>", 
                    RowBox[{"ToString", "[", "nx", "]"}]}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}], "]"}], 
                 ",", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}]}], ";"}], 
             "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"crv", "=", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bCircumconicEq", "[", 
                 RowBox[{"ptc", ",", 
                  RowBox[{"ETCBaryNorm", "[", "nx", "]"}]}], "]"}], "/.", 
                "rule69"}], ",", "35"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"dset", "=", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Abs", "[", "crv", "]"}], "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], 
                 "]"}]}], "&"}], "/@", "ETCBaryNorm"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"test", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"dset", ",", 
               RowBox[{
                RowBox[{"#", "<", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "10"}]]}], "&"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "test", "]"}], ">", "1"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"p1", "=", 
                RowBox[{
                 RowBox[{"Keys", "[", "test", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"p2", "=", 
                RowBox[{
                 RowBox[{"Keys", "[", "test", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", " ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"p1", "==", "excl"}], "||", 
                  RowBox[{"p2", "==", "excl"}]}], ",", " ", 
                 RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"check", " ", "=", " ", 
                RowBox[{"TimeConstrained", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Simplify", "[", 
                   RowBox[{
                    RowBox[{"bCircumconicEq", "[", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "p1", "]"}], ",", 
                    RowBox[{"KimberlingCenterCNy", "[", "p2", "]"}]}], "]"}], 
                    "/.", 
                    RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "pt"}], 
                    "]"}]}], "]"}], "\[IndentingNewLine]", ",", "10", ",", 
                  RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"check", "==", "0"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"conicname", "=", 
                   RowBox[{"\"\<{A,B,C,\>\"", "<>", 
                    RowBox[{"intaddbrackets", "[", "p1", "]"}], "<>", 
                    "\"\<,\>\"", "<>", 
                    RowBox[{"intaddbrackets", "[", "p2", "]"}], "<>", 
                    "\"\<}\>\""}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"Not", "[", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"out", ",", "conicname"}], "]"}], "]"}], ",", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"out", ",", "conicname"}], "]"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"nx", ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"Keys", "[", "ETC", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"start", ",", 
                 RowBox[{"start", "+", 
                  RowBox[{
                   RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"time", "/", "60"}], "]"}]}], "]"}], "*", 
                   "200"}]}]}], "}"}]}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        "time", ",", "funcind"}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<circumconics\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"\"\<Lies on circumconics: \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "funcind", "]"}], ";"}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"6bad2bad-e68f-4afc-acfc-2dc7d09d78df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkIsogonalConjugates", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", ",", "idx2", 
       ",", "ptc", ",", "rc", ",", "ffisoconjugate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ffisoconjugate", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"bPIsogonalConjugate", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt1", "/.", "rule69"}], "]"}], ",", 
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt2", "/.", "rule69"}], "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{"pt", "/.", "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ffisoconjugate", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&"}]}], 
          "]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "15"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{"pt", "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"bPIsogonalConjugate", "[", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], ",", 
                   RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}], "]"}],
                  "/.", "rc"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"LexicographicOrder", "[", 
                  RowBox[{
                   RowBox[{"numsortexpr", "[", "idx1", "]"}], ",", 
                   RowBox[{"numsortexpr", "[", "idx2", "]"}]}], "]"}], "==", 
                 "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{
                RowBox[{"Print", "[", "idx1", "]"}], ";", 
                RowBox[{"Print", "[", "idx2", "]"}], ";"}]}], "*)"}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<isoconjugate\>\"", "\[Rule]", "res"}], "}"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= X(i)-isoconjugate-of-X(j) for these {i, j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"a1d0dbe4-0639-4429-aad8-7d21f511e586"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkConjugates", "[", 
    RowBox[{"pt_", ",", "func_", ",", "str_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", ",", "idx2", 
       ",", "i1", ",", "i2", ",", "ptc", ",", "rc", ",", "ff", ",", 
       "fncname"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"func", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt1", "/.", "rule69"}], "]"}], ",", 
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt2", "/.", "rule69"}], "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{"pt", "/.", "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ff", "[", 
           RowBox[{"#", ",", "ptc"}], "]"}], "&"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&"}]}], 
          "]"}], ",", "  ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"idx1", ",", "idx2"}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i1", ",", "i2"}], "}"}], "=", 
               RowBox[{"{", 
                RowBox[{"idx2", ",", "idx1"}], "}"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{"pt", "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"func", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "i1", "]"}], "/.", 
                    "rc"}], ",", 
                   RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "i2", "]"}], "/.", 
                    "rc"}]}], "]"}], "/.", "rc"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"res", ",", 
                 RowBox[{"{", 
                  RowBox[{"i1", ",", "i2"}], "}"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"fncname", ",", "HoldFirst"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fncname", "[", "x_", "]"}], ":=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"SymbolName", "[", 
          RowBox[{"Unevaluated", "@", "x"}], "]"}], ",", "x"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ToString", "[", 
           RowBox[{"First", "[", 
            RowBox[{"fncname", "[", "func", "]"}], "]"}], "]"}], "\[Rule]", 
          "res"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"str", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[69]:=",ExpressionUUID->"5c4ca766-15c5-438e-94e3-b091a977f515"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkVertexConjugates", "[", 
    RowBox[{"pt_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", ",", "idx2", 
       ",", "ptc", ",", "rc", ",", "ffvertexconjugate"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ffvertexconjugate", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"local", "=", 
           RowBox[{
            RowBox[{"bVertexConjugate", "[", 
             RowBox[{
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt1", "/.", "rule69"}], "]"}], ",", 
              RowBox[{"intnumericnorm", "[", 
               RowBox[{"pt2", "/.", "rule69"}], "]"}]}], "]"}], "/.", 
            "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"intnumericnorm", "[", "local", "]"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc", "=", 
       RowBox[{"intCheckList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{"pt", "/.", "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ffvertexconjugate", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&"}]}], 
          "]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "15"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"coincideNorm", "[", 
               RowBox[{
                RowBox[{"pt", "/.", "rc"}], ",", " ", 
                RowBox[{
                 RowBox[{"bVertexConjugate", "[", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], ",", 
                   RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}], "]"}],
                  "/.", "rc"}]}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"LexicographicOrder", "[", 
                  RowBox[{
                   RowBox[{"numsortexpr", "[", "idx1", "]"}], ",", 
                   RowBox[{"numsortexpr", "[", "idx2", "]"}]}], "]"}], "==", 
                 "1"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"res", ",", 
                  RowBox[{"{", 
                   RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], 
             RowBox[{"(*", 
              RowBox[{",", " ", 
               RowBox[{
                RowBox[{"Print", "[", "idx1", "]"}], ";", 
                RowBox[{"Print", "[", "idx2", "]"}], ";"}]}], "*)"}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<vertex conjugate\>\"", "\[Rule]", "res"}], "}"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= X(i)-vertex conjugate of X(j) for these {i, j}: \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[70]:=",ExpressionUUID->"a1358929-d20d-4668-b495-1e4bb285828e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkBarycentric", "[", 
    RowBox[{"pt_", ",", "type_", ",", 
     RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
      "ff", ",", "cx", ",", " ", "prev", ",", " ", "res", ",", " ", "idx1", 
       ",", "idx2", ",", "ptc", ",", "val", ",", "sgn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"ff", "[", 
        RowBox[{"pt1_", ",", " ", "pt2_"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "local", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"type", "==", "\"\<quotient\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"local", "=", 
             RowBox[{"intnumericnorm", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pt1", "/.", "rule69"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"pt2", "/.", "rule69"}], ")"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"local", "=", 
             RowBox[{"intnumericnorm", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"pt1", "/.", "rule69"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"pt2", "/.", "rule69"}], ")"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", "local", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"type", "==", "\"\<quotient\>\""}], ",", 
        RowBox[{"sgn", "=", "\"\</\>\""}], ",", 
        RowBox[{"sgn", "=", "\"\<*\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ptc", "=", 
       RowBox[{"intnumericnorm", "[", " ", 
        RowBox[{"pt", "/.", "rule69"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ff", "[", 
           RowBox[{"ptc", ",", "#"}], "]"}], "&"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"AssociationThread", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\"\<C\>\"", "<>", "#"}], "&"}], ",", 
             RowBox[{"Keys", "[", "cx", "]"}]}], "]"}], ",", 
           RowBox[{"Values", "[", "cx", "]"}]}], "]"}], ",", "ETCBaryNorm"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cx", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{"cx", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Im", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "==", "0"}], "&"}]}], 
          "]"}], ",", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"prev", "=", 
       RowBox[{"<|", 
        RowBox[{"\"\<X0\>\"", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}]}], ")"}], 
            " ", "||", "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "!=", 
               "\"\<C\>\""}], "&&", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", "1"}], "]"}], "!=", "\"\<C\>\""}]}], 
             ")"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"prev", "=", 
             RowBox[{"<|", 
              RowBox[{"n", "->", 
               RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";", " ", 
            RowBox[{"Continue", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coincide", "[", 
            RowBox[{
             RowBox[{"cx", "[", "n", "]"}], ",", 
             RowBox[{"prev", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "15"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"idx1", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Keys", "[", "prev", "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "==", 
                "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Keys", "[", "prev", "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"Keys", "[", "prev", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"idx2", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringTake", "[", 
                 RowBox[{"n", ",", "1"}], "]"}], "==", "\"\<C\>\""}], ",", 
               RowBox[{"StringTake", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "n"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"type", "==", "\"\<quotient\>\""}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Simplify", "[", 
                 RowBox[{"Det", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "pt", ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], "/", 
                    RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}]}], 
                   "}"}], "]"}], "]"}], "==", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"type", "==", "\"\<quotient\>\""}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Simplify", "[", 
                 RowBox[{"Det", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "pt", ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}], "/", 
                    RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}]}]}], 
                   "}"}], "]"}], "]"}], "==", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"res", ",", 
                RowBox[{"{", 
                 RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"type", "==", "\"\<product\>\""}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Simplify", "[", 
                 RowBox[{"Det", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "pt", ",", 
                    RowBox[{
                    RowBox[{"KimberlingCenterCNy", "[", "idx1", "]"}], "*", 
                    RowBox[{"KimberlingCenterCNy", "[", "idx2", "]"}]}]}], 
                   "}"}], "]"}], "]"}], "==", "0"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LexicographicOrder", "[", 
                   RowBox[{"idx1", ",", "idx2"}], "]"}], "==", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"res", ",", 
                   RowBox[{"{", 
                    RowBox[{"idx1", ",", "idx2"}], "}"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"res", ",", 
                   RowBox[{"{", 
                    RowBox[{"idx2", ",", "idx1"}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"prev", "=", 
          RowBox[{"<|", 
           RowBox[{"n", "->", 
            RowBox[{"cx", "[", "n", "]"}]}], "|>"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", 
          RowBox[{"Keys", "[", "cx", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"DeleteDuplicates", "[", "res", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"numsortexpr", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"intnameformat", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], "&"}], ",", 
         "res"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{
        RowBox[{"globalProperties", "[", "name", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<barycentric \>\"", "<>", "type"}], "\[Rule]", "res"}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{
             "\"\<= barycentric \>\"", "<>", "type", "<>", "\"\< X(i)\>\"", "<>",
               "sgn", "<>", "\"\<X(j) for these (i, j): \>\"", "<>", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"res", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"4fafc852-071d-4fdc-8baa-8b0c276eb033"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkTrilinearPolar", "[", 
     RowBox[{"pt_", ",", 
      RowBox[{"name_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{"cx", ",", "ptc", ",", "p1", ",", "p2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ptc", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"Normalize", "[", " ", 
           RowBox[{"pt", "/.", "rule69"}], "]"}], ",", "35"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cx", "=", 
        RowBox[{
         RowBox[{"bTripolarEq", "[", "ptc", "]"}], ".", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dset", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", "cx", "]"}], "/.", 
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "#"}], "]"}]}], 
          "&"}], "/@", "ETCBaryNorm"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"test", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"dset", ",", 
          RowBox[{
           RowBox[{"#", "<", 
            SuperscriptBox["10", 
             RowBox[{"-", "10"}]]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "test", "]"}], ">", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"p1", "=", 
           RowBox[{
            RowBox[{"Keys", "[", "test", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"p2", "=", 
           RowBox[{
            RowBox[{"Keys", "[", "test", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", " ", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
              RowBox[{"Det", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", "pt", ",", 
                 RowBox[{"bTripole", "[", 
                  RowBox[{
                   RowBox[{"KimberlingCenterCNy", "[", "p1", "]"}], ",", 
                   RowBox[{"KimberlingCenterCNy", "[", "p2", "]"}]}], "]"}]}],
                 "}"}], "]"}], "\[IndentingNewLine]", "]"}], "==", "0"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AssociateTo", "[", 
              RowBox[{
               RowBox[{"globalProperties", "[", "name", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\"\<trilinear polar\>\"", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"p1", ",", "p2"}], "}"}]}], "}"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{"\"\<= trilinear pole of line {\>\"", "<>", 
                  RowBox[{"intnameformat", "[", "p1", "]"}], "<>", 
                  "\"\<,\>\"", "<>", 
                  RowBox[{"intnameformat", "[", "p2", "]"}], "<>", 
                  "\"\<}\>\""}], " ", "]"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkCurves", "[", 
     RowBox[{"pt_", ",", 
      RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"out", ",", "ptest", ",", "d", ",", "secondcheck"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ptest", "=", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{"NormalizeBary", "[", 
              RowBox[{"pt", "//", 
               RowBox[{"evaluate", "/.", "rule69"}]}], "]"}], ",", "35"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"getTriangleCurve", "[", "name", "]"}], "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptest"}], 
              "]"}]}], "/.", "rule69"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", "d", "]"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "12"}]]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"secondcheck", "=", "True"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"ptest", "=", 
                 RowBox[{"N", "[", 
                  RowBox[{
                   RowBox[{"NormalizeBary", "[", 
                    RowBox[{"pt", "/.", "rc"}], "]"}], ",", "35"}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"d", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"getTriangleCurve", "[", "name", "]"}], "/.", 
                   RowBox[{"Thread", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptest"}],
                     "]"}]}], "/.", "rc"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", "d", "]"}], ">", 
                   SuperscriptBox["10", 
                    RowBox[{"-", "12"}]]}], ",", 
                  RowBox[{"secondcheck", " ", "=", "False"}]}], "]"}], ";"}], 
               "\[IndentingNewLine]", ",", 
               RowBox[{"{", 
                RowBox[{"rc", ",", "intCheckList"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"secondcheck", ",", " ", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"out", ",", "name"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "TriangleCurves", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{
         RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<curves\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "out", "]"}], ">", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Lies on curves: \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkPerspector", "[", 
     RowBox[{"pt_", ",", 
      RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "out", ",", "ptest", ",", "ptcheck", ",", "crv", ",", "set1", ",", " ",
         "rc", ",", "ptnamenew"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"out", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ptest", "=", 
        RowBox[{"intnumericnorm", "[", 
         RowBox[{
          RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rule69"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"crv", "=", 
        RowBox[{"bCircumconicPEq", "[", "ptest", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"set1", " ", "=", " ", 
        RowBox[{"checkPointsOnCurve", "[", "crv", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"rc", "=", 
        RowBox[{"intCheckList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ptest", "=", 
           RowBox[{"intnumericnorm", "[", 
            RowBox[{
             RowBox[{"evaluate", "[", "pt", "]"}], "/.", "rc"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"crv", "=", 
           RowBox[{"bCircumconicPEq", "[", "ptest", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ptnamenew", "=", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{"ptoncrv", ",", "1"}], "]"}], "<>", 
            RowBox[{"StringTake", "[", 
             RowBox[{"ptoncrv", ",", 
              RowBox[{"{", 
               RowBox[{"3", ",", 
                RowBox[{"-", "2"}]}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ptcheck", " ", "=", " ", 
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"KimberlingCenterCNy", "[", "ptnamenew", "]"}], "/.", 
              "rc"}], ",", "35"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"crv", "/.", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y", ",", "z"}], "}"}], "->", "ptcheck"}],
                 "]"}]}], ")"}], "<", 
             SuperscriptBox["10", 
              RowBox[{"-", "15"}]]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"out", ",", "ptoncrv"}], "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"ptoncrv", ",", "set1"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{
         RowBox[{"globalProperties", "[", "inname", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\<perspector\>\"", "\[Rule]", "out"}], "}"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "out", "]"}], ">=", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{
              "\"\<= perspector of circumconic through: \>\"", "<>", " ", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{"out", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}]}], 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointChecker", "[", 
     RowBox[{"expr_", ",", 
      RowBox[{"num_", ":", "0"}], ",", 
      RowBox[{"full_", ":", "False"}], ",", " ", 
      RowBox[{"inname_", ":", "\"\<X\>\""}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ptcoord", ",", "pt", ",", "chk", ",", "lines", ",", "barys", ",", 
        "symcheck", ",", "name"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ptcoord", "=", 
        RowBox[{"expr", "//", "evaluate"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Check", " ", "symmetry"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pt", "=", 
        RowBox[{"N", "[", 
         RowBox[{
          RowBox[{"NormalizeBary", "[", 
           RowBox[{"ptcoord", "/.", " ", "rule69"}], "]"}], ",", "35"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"symcheck", "=", 
        RowBox[{"pt", " ", "-", " ", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"NormalizeBary", "[", 
            RowBox[{
             RowBox[{"symmetrizeInternal2", "[", 
              RowBox[{"ptcoord", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "/.", " ", "rule69"}], 
            "]"}], ",", "35"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AnyTrue", "[", 
          RowBox[{"symcheck", ",", 
           RowBox[{
            RowBox[{"#", "!=", "0"}], "&"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "ptcoord", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", "\"\<expression is not symmetric\>\"", "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", " ", "Module"}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "if", " ", "we", " ", "have", " ", "seen", " ", "the", 
         " ", "point", " ", "in", " ", "this", " ", 
         RowBox[{"session", ".", " ", "This"}], " ", "is", " ", "useful", " ",
          "when", " ", "we", " ", "have", " ", "large", " ", "point", " ", 
         RowBox[{"checks", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "globalSeenPoints", "]"}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"First", "@", 
            RowBox[{
             RowBox[{"MinimalBy", "[", "Value", "]"}], "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"Abs", "[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "pt"}], "]"}], "]"}],
                 "&"}], "/@", "globalSeenPoints"}], ")"}]}]}], "<=", 
           SuperscriptBox["10", 
            RowBox[{"-", "20"}]]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "inname", "]"}], ";", 
          RowBox[{"Print", "[", "\"\<Point seen\>\"", "]"}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"False", ",", " ", "Module"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"globalSeenPoints", ",", 
            RowBox[{"{", 
             RowBox[{"ptcoord", ",", "pt"}], "}"}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Check", " ", "ETC"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"num", "!=", "0"}], ",", 
         RowBox[{"chk", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"chk", "=", 
          RowBox[{"checkPointinETC", "[", "pt", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"chk", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<", 
          RowBox[{"10", "^", 
           RowBox[{"(", 
            RowBox[{"-", "12"}], ")"}]}]}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{"colorformat", "[", 
           RowBox[{"\"\<ETC: \>\"", "<>", 
            RowBox[{"Keys", "[", "chk", "]"}]}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"barys", " ", "=", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"FactorTermsList", "[", 
              RowBox[{"expr", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "//", "Factor"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "[", "inname", "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"name", "=", 
             RowBox[{"ToString", "[", 
              RowBox[{"ExpressionToTrad", "[", 
               RowBox[{"expr", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"name", " ", "=", " ", "inname"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"globalProperties", ",", 
            RowBox[{"name", "->", 
             RowBox[{"Association", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"full", ",", "\[IndentingNewLine]", 
            RowBox[{"lines", "=", 
             RowBox[{
              RowBox[{"linesProcessAlg", "[", 
               RowBox[{
               "ptcoord", ",", "barys", ",", "20", ",", "False", ",", "False",
                 ",", "name"}], "]"}], "//", "Quiet"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"lines", "=", 
              RowBox[{
               RowBox[{"linesProcessAlg", "[", 
                RowBox[{
                "ptcoord", ",", "barys", ",", " ", "20", ",", " ", "False", 
                 ",", "True", ",", " ", "name"}], "]"}], "//", "Quiet"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"full", " ", "||", " ", 
             RowBox[{
              RowBox[{"Length", "[", "lines", "]"}], ">", "3"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"checkCircumconics", "[", 
               RowBox[{
               "ptcoord", ",", "1", ",", "60", ",", "num", ",", "name"}], 
               "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkCurves", "[", 
               RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkTrilinearPolar", "[", 
               RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkIsogonalConjugates", "[", 
               RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bDaoConjugate", ",", 
                "\"\<= X(i)-Dao conjugate of X(j) for these {i, j}: \>\"", 
                ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bZayinConjugate", ",", 
                "\"\<= X(i)-Zayin conjugate of X(j) for these {i, j}: \>\"", 
                ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bCevianQuotient", ",", 
                "\"\<= X(i)-Ceva conjugate of X(j) for these {i, j}: \>\"", 
                ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bAnticomplementaryConjugate", ",", 
                "\"\<= X(i)-anticomplementary conjugate of X(j) for these {i, \
j}: \>\"", ",", "name"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bComplementaryConjugate", ",", 
                "\"\<= X(i)-complementary conjugate of X(j) for these {i, j}: \
\>\"", ",", "name"}], "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bCrossConjugate", ",", 
                "\"\<= X(i)-cross conjugate of X(j) for these {i, j}: \>\"", 
                ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkConjugates", "[", 
               RowBox[{
               "ptcoord", ",", "bWawConjugate", ",", 
                "\"\<= X(i)-Waw conjugate of X(j) for these {i, j}: \>\"", 
                ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkVertexConjugates", "[", 
               RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkBarycentric", "[", 
               RowBox[{"ptcoord", ",", "\"\<product\>\"", ",", " ", "name"}], 
               "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkBarycentric", "[", 
               RowBox[{"ptcoord", ",", "\"\<quotient\>\"", ",", " ", "name"}],
                "]"}], "//", "Quiet"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"checkPerspector", "[", 
               RowBox[{"ptcoord", ",", "name"}], "]"}], "//", "Quiet"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"TimeConstrained", "[", 
              RowBox[{
               RowBox[{"Quiet", "[", 
                RowBox[{"pointCheckAllProcesses", "[", 
                 RowBox[{"ptcoord", ",", "name"}], "]"}], "]"}], ",", "90"}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pointCheckerTransform", "[", 
     RowBox[{"expr_", ",", "inname_", ",", 
      RowBox[{"num_", ":", "0"}], ",", " ", 
      RowBox[{"full_", ":", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pointProcesses", ",", "texpr", ",", "procname"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Check", " ", "main", " ", "point"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
         RowBox[{"Print", "[", "inname", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pointChecker", "[", 
        RowBox[{"expr", ",", "num", ",", "full", ",", "inname"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TrueQ", "[", "globalSilence", "]"}], ",", 
         RowBox[{"printGlobalProperties", "[", 
          RowBox[{"globalProperties", ",", "inname"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Check", " ", "transformations", " ", "of", " ", "main", " ", 
         "point"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pointProcesses", "=", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<isotomic conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsotomicConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<isogonal conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bIsogonalConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<complement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<anticomplement\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bAntiComplement", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterC", "[", "2", "]"}], ",", "#"}], "]"}],
             "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<cyclocevian conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCyclocevianConjugate", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<circumcircle inverse\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bCircumcircleInverse", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<zosma transform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bZosmaTransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<polar conjugate\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bPIsogonalConjugate", "[", 
             RowBox[{
              RowBox[{"KimberlingCenterCN", "[", "48", "]"}], ",", "#"}], 
             "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<eigentransform\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"bEigentransform", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPsi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPsi", "[", "#", "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<cundyParryPhi\>\"", "->", 
           RowBox[{"Hold", "[", 
            RowBox[{"cundyParryPhi", "[", "#", "]"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"texpr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"ReleaseHold", "[", 
                RowBox[{
                 RowBox[{"pointProcesses", "[", "name", "]"}], "/.", 
                 RowBox[{"#", "->", "expr"}]}], "]"}], "//", "evaluate"}], "//",
               "Together"}], "//", "Factor"}], "//", 
            "simplifyRationalBarycentrics"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"heuristicsCheck", "[", 
             RowBox[{"texpr", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"procname", " ", "=", " ", 
              RowBox[{"name", "<>", "\"\< of \>\"", "<>", "inname"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Not", "[", 
                RowBox[{"TrueQ", "[", "globalSilence", "]"}], "]"}], ",", 
               RowBox[{"Print", "[", "procname", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"pointChecker", "[", 
              RowBox[{"texpr", ",", "0", ",", "False", ",", "procname"}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"TrueQ", "[", "globalSilence", "]"}], ",", 
               RowBox[{"printGlobalProperties", "[", 
                RowBox[{"globalProperties", ",", "procname"}], "]"}]}], "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"Keys", "[", "pointProcesses", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printGlobalProperties", "[", 
    RowBox[{"glob_", ",", 
     RowBox[{"name_", ":", "\"\<\>\""}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hg", ",", "cycle", ",", "localprops"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "name", "]"}], ">", "0"}], ",", 
        RowBox[{"cycle", "=", 
         RowBox[{"{", "name", "}"}]}], ",", 
        RowBox[{"cycle", "=", 
         RowBox[{"Keys", "[", "glob", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Keys", "[", 
               RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", "\"\<name\>\""}],
              "]"}], "]"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "]"}], ";", 
         RowBox[{"Print", "[", "]"}], ";", " ", 
         RowBox[{"Print", "[", "pt", "]"}], ";", " ", 
         RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<name\>\"", "]"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "]"}], ";", " ", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Barycentrics    \>\"", "<>", 
           RowBox[{
            RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<barycentrics\>\"", 
            "]"}]}], "]"}], ";", " ", 
         RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"Keys", "[", 
                RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
               "\"\<circumconics\>\""}], "]"}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", " ", 
            RowBox[{
             RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<circumconics\>\"", 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"colorformat", "[", 
             RowBox[{"\"\<lies on circumconics \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{"hg", ",", "\"\<, \>\""}], "]"}], " ", "<>", 
              "\"\< and on these lines: \>\"", "<>", " ", 
              RowBox[{"StringRiffle", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<lines\>\"", 
                 "]"}], ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"\"\<lies on these lines: \>\"", "<>", " ", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<lines\>\"", 
                  "]"}], ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
             "\"\<midpoints\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<midpoints\>\"", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "\"\<= midpoint of X(i) in X(j) for these {i,j}: \>\"", "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{"hg", ",", 
                    RowBox[{
                    RowBox[{"numsortexpr", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
                    ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
             "\"\<reflections\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<reflections\>\"", 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "\"\<= reflection of X(i) in X(j) for these {i,j}: \>\"", "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{"hg", ",", 
                    RowBox[{
                    RowBox[{"numsortexpr", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
                    ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", " ", "this", " ", "is", " ", "not", " ", "present"}],
            ",", " ", 
           RowBox[{
           "this", " ", "point", " ", "is", " ", "not", " ", "calculated", 
            " ", "due", " ", "to", " ", "too", " ", "few", " ", 
            RowBox[{"lines", ".", "\[IndentingNewLine]", "Print"}], " ", 
            "harmonic", " ", "conjugates"}], ",", " ", 
           RowBox[{
           "which", " ", "must", " ", "be", " ", "last", " ", "and", " ", 
            "exit", " ", 
            RowBox[{"loop", "."}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Not", "[", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Keys", "[", 
               RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
              "\"\<circumconics\>\""}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{"Keys", "[", 
                 RowBox[{"glob", "[", "pt", "]"}], "]"}], ",", 
                "\"\<harmonic\>\""}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"hg", " ", "=", " ", 
                RowBox[{
                 RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<harmonic\>\"", 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"colorformat", "[", 
                    RowBox[{
                    "\"\<= {X(i),X(j)}-harmonic conjugate of X(k) for these \
(i,j,k): \>\"", "<>", 
                    RowBox[{"StringRiffle", "[", 
                    RowBox[{
                    RowBox[{"SortBy", "[", 
                    RowBox[{"hg", ",", 
                    RowBox[{
                    RowBox[{"numsortexpr", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "&"}]}], "]"}], 
                    ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], ";"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Continue", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<curves\>\"", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"\"\<lies on curves: \>\"", "<>", 
               RowBox[{"StringRiffle", "[", 
                RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
            ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{"glob", "[", "pt", "]"}], ",", "proc"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                 "\"\<= \>\"", "<>", " ", "proc", "<>", "\"\< of \>\"", "<>", 
                  RowBox[{
                   RowBox[{"glob", "[", "pt", "]"}], "[", "proc", "]"}]}], 
                 "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"proc", ",", 
             RowBox[{"Keys", "[", "singlePointProcesses", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"KeyExistsQ", "[", 
            RowBox[{
             RowBox[{"glob", "[", "pt", "]"}], ",", 
             "\"\<trilinear polar\>\""}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", 
              "\"\<trilinear polar\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{"\"\<= trilinear pole of line {\>\"", "<>", 
                  RowBox[{"intnameformat", "[", 
                   RowBox[{"hg", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", 
                  "<>", 
                  RowBox[{"intnameformat", "[", 
                   RowBox[{"hg", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "<>", 
                  "\"\<}\>\""}], " ", "]"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"hg", " ", "=", " ", 
          RowBox[{
           RowBox[{"glob", "[", "pt", "]"}], "[", "\"\<perspector\>\"", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "hg", "]"}], ">=", "2"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"colorformat", "[", 
              RowBox[{"StringJoin", "[", 
               RowBox[{"\"\<= perspector of circumconic through: \>\"", ",", 
                RowBox[{"StringRiffle", "[", 
                 RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"localprops", "=", 
          RowBox[{"Association", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "\"\<isoconjugate\>\"", "->", 
             "\"\<= X(i)-isoconjugate-of-X(j) for these {i, j}: \>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
            "\"\<vertex conjugate\>\"", "->", 
             "\"\<= X(i)-vertex conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bDaoConjugate\>\"", "->", 
             "\"\<= X(i)-Dao conjugate of X(j) for these {i, j}: \>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bZayinConjugate\>\"", "->", 
             "\"\<= X(i)-Zayin conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bCevianQuotient\>\"", "->", 
             "\"\<= X(i)-Ceva conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bComplementaryConjugate\>\"", "->", 
             "\"\<= X(i)-complementary conjugate of X(j) for these {i, j}: \>\
\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bAnticomplementaryConjugate\>\"", "->", 
             "\"\<= X(i)-anticomplementary conjugate of X(j) for these {i, \
j}: \>\""}], ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bCrossConjugate\>\"", "->", 
             "\"\<= X(i)-cross conjugate of X(j) for these {i, j}: \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<bWawConjugate\>\"", "->", 
             "\"\<= X(i)-Waw conjugate of X(j) for these {i, j}: \>\""}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
            "\"\<barycentric product\>\"", "->", 
             "\"\<= barycentric product X(i)*X(j) for these (i, j): \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<barycentric quotient\>\"", "->", 
             "\"\<= barycentric quotient X(i)/X(j) for these (i, j): \>\""}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{
            "\"\<harmonic\>\"", "->", 
             "\"\<= {X(i),X(j)}-harmonic conjugate of X(k) for these (i,j,k): \
\>\""}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"hg", " ", "=", " ", 
             RowBox[{
              RowBox[{"glob", "[", "pt", "]"}], "[", "name2", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "hg", "]"}], ">", "0"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"colorformat", "[", 
                 RowBox[{
                  RowBox[{"localprops", "[", "name2", "]"}], "<>", 
                  RowBox[{"StringRiffle", "[", 
                   RowBox[{"hg", ",", "\"\<, \>\""}], "]"}]}], "]"}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"name2", ",", 
             RowBox[{"Keys", "[", "localprops", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"pt", ",", " ", "cycle"}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"d3bc0e6f-728d-432e-9704-a9cc59a0a8a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DeleteFile", "[", "\"\<DBTools.m\>\"", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<DBTools.m\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "pointProcessBary", ",", "singlePointProcesses", ",", 
      "intHarmonicProcess", ",", " ", "intPointCheck", ",", " ", 
      "pointCheckAllProcesses", ",", "checkCircumconics", ",", 
      "linesProcessAlg", ",", "checkIsogonalConjugates", ",", 
      "checkBarycentric", ",", " ", "xnum", ",", " ", "coincide", ",", " ", 
      "intReflectionProcess", ",", " ", "intMidpointProcess", ",", 
      "checkTrilinearPolar", ",", "checkVertexConjugates", ",", 
      "pointChecker", ",", "pointCheckerTransform", ",", "globalSeenPoints", 
      ",", "globalProperties", ",", "checkCurves", ",", 
      "printGlobalProperties", ",", "checkPerspector", ",", "intCheckList", 
      ",", "intVerifyPointProcess", ",", "coincideNorm", ",", " ", 
      "checkConjugates", ",", "KimberlingCenterCNy", ",", "intaddbrackets", 
      ",", "intnameformat", ",", "intnumericnorm", ",", "colorformat", ",", 
      "intmark"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
},
WindowSize->{1105.2, 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
   StyleDefinitions -> "PrivateStylesheetFormatting.nb"],
ExpressionUUID->"63c0da91-286a-436c-a7b8-b49fac5d8617"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 624, 11, 28, "Input",ExpressionUUID->"e02bd4d1-2377-49e9-b4fb-9bd77f1dd136"],
Cell[1185, 33, 7642, 226, 504, "Input",ExpressionUUID->"b80a96f9-c842-4ef8-9bf5-1d19f4841581"],
Cell[8830, 261, 2967, 72, 390, "Input",ExpressionUUID->"74111645-2b56-4fda-8b77-c132e8d1be4b"],
Cell[11800, 335, 1808, 44, 238, "Input",ExpressionUUID->"26d5a62e-503c-4018-a856-34e31e5b398f"],
Cell[13611, 381, 1817, 46, 219, "Input",ExpressionUUID->"c39b8072-918d-4251-8a15-74a2adcadfbe"],
Cell[15431, 429, 2142, 51, 238, "Input",ExpressionUUID->"138afecd-e9f2-4f46-90cb-79229dc0c3d6"],
Cell[17576, 482, 4339, 99, 409, "Input",ExpressionUUID->"6b44296a-dc56-44c3-981b-023a39cb076c"],
Cell[21918, 583, 12675, 307, 1342, "Input",ExpressionUUID->"51aa5bfe-e1a6-46b3-93f3-4a939e2f11f3"],
Cell[34596, 892, 3449, 83, 447, "Input",ExpressionUUID->"bca15176-ab78-40f6-ad1d-3f9d33e84dcf"],
Cell[38048, 977, 3935, 95, 403, "Input",ExpressionUUID->"83275f8c-a3be-4d54-8212-7b9bf0d4d228"],
Cell[41986, 1074, 1115, 28, 86, "Input",ExpressionUUID->"8be899e7-53f5-49b1-a9d2-301ac7f326c4"],
Cell[43104, 1104, 26806, 649, 2247, "Input",ExpressionUUID->"88798590-dcbe-4e1a-a851-954fbc2ef3de"],
Cell[69913, 1755, 7958, 181, 770, "Input",ExpressionUUID->"6bad2bad-e68f-4afc-acfc-2dc7d09d78df"],
Cell[77874, 1938, 10368, 257, 809, "Input",ExpressionUUID->"a1d0dbe4-0639-4429-aad8-7d21f511e586"],
Cell[88245, 2197, 10664, 271, 771, "Input",ExpressionUUID->"5c4ca766-15c5-438e-94e3-b091a977f515"],
Cell[98912, 2470, 10332, 257, 771, "Input",ExpressionUUID->"a1358929-d20d-4668-b495-1e4bb285828e"],
Cell[109247, 2729, 12874, 314, 1037, "Input",ExpressionUUID->"4fafc852-071d-4fdc-8baa-8b0c276eb033"],
Cell[122124, 3045, 46487, 1073, 4975, "Input",ExpressionUUID->"d3bc0e6f-728d-432e-9704-a9cc59a0a8a1"],
Cell[168614, 4120, 1203, 21, 154, "Input",ExpressionUUID->"b746881b-4178-4fc6-bde6-a3152c58c10a"]
}
]
*)

